{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///exsurge.min.js","webpack:///webpack/bootstrap a58e9ba5f0ed0846ac85","webpack:///./src/index.js","webpack:///./src/Exsurge.Core.js","webpack:///./src/Exsurge.Text.js","webpack:///./src/Exsurge.Glyphs.js","webpack:///./src/Exsurge.Drawing.js","webpack:///./assets/fonts/ExsurgeChar.otf","webpack:///./src/Exsurge.Chant.js","webpack:///./src/Exsurge.Chant.Signs.js","webpack:///./src/Exsurge.Gabc.js","webpack:///./src/Exsurge.Chant.Markings.js","webpack:///./src/Exsurge.Chant.Neumes.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","ChantVisualElement","undefined","_Exsurge","_loop","_key10","enumerable","get","_Exsurge2","_loop2","_key11","_Exsurge3","_loop3","_key12","_Exsurge4","_loop4","_key13","_Exsurge5","_loop5","_key14","_ExsurgeChant","_loop6","_key15","_ExsurgeChant2","_loop7","_key16","_ExsurgeChant3","_loop8","_key17","_Exsurge6","_loop9","_key18","ChantVisualElementPrototype","create","HTMLElement","prototype","createdCallback","ctxt","ChantContext","lyricTextFont","lyricTextSize","dropCapTextFont","annotationTextFont","useDropCap","useDropCapAttr","getAttribute","score","Gabc","loadChantScore","innerText","annotationAttr","annotation","Annotation","_element","width","doLayout","newWidth","parentElement","clientWidth","performLayout","layoutChantLines","innerHTML","createDrawable","window","addEventListener","attachEvent","attachedCallback","document","registerElement","_classCallCheck","instance","Constructor","TypeError","DeviceIndependent","n","Centimeters","Units","ToDeviceIndependent","Millimeters","Inches","ToCentimeters","FromDeviceIndependent","ToMillimeters","ToInches","generateRandomGuid","s4","Math","floor","random","toString","substring","_createClass","defineProperties","target","props","i","length","descriptor","configurable","writable","key","protoProps","staticProps","DeviceIndepenedent","DIU_PER_INCH","DIU_PER_CENTIMETER","inputUnits","outputUnits","StringToUnitsType","s","ToLower","UnitsTypeToString","units","Point","x","y","point","Step","Rect","height","Infinity","rect","other","right","max","bottom","min","Margins","left","top","margins","Size","size","Do","Du","Re","Me","Mi","Fa","Fu","So","La","Te","Ti","__StepToStaffPosition","__StaffOffsetToStep","Pitch","step","octave","pitch","toInt","offset","MarkingPositionHint","Default","Above","Below","_interopRequireWildcard","obj","__esModule","newObj","hasOwnProperty","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","constructor","setPrototypeOf","__proto__","Spanish","Latin","Language","name","text","parsedWords","words","split","end","push","syllabifyWord","_Language","_this","getPrototypeOf","diphthongs","wordExceptions","vowels","muteConsonantsAndF","liquidConsonants","word","lookahead","haveLookahead","syllables","haveCompleteSyllable","previousWasVowel","workingString","toLowerCase","startSyllable","makeSyllable","substr","wordLength","cIsVowel","isVowel","isDiphthong","isMuteConsonantOrF","isLiquidConsonant","startIndex","index","d","indexOf","found","_Language2","_this2","weakVowels","strongVowels","uDiphthongExceptions","previousIsVowel","previousIsStrongVowel","cIsStrongVowel","isStrongVowel","createSyllable","consonant2","numberOfConsonants","j","tripthong","endj","findVowelSegment","Glyphs","None","svgSrc","paths","type","data","bounds","origin","AcuteAccent","Stropha","BeginningAscLiquescent","BeginningDesLiquescent","CustodDescLong","CustodDescShort","CustodLong","CustodShort","DoClef","FaClef","Flat","Mora","Natural","OriscusAsc","OriscusDes","OriscusLiquescent","PodatusLower","PodatusUpper","Porrectus1","Porrectus2","Porrectus3","Porrectus4","PunctumCavum","PunctumCuadratum","PunctumCuadratumAscLiquescent","PunctumCuadratumDesLiquescent","PunctumInclinatum","PunctumInclinatumLiquescent","Quilisma","TerminatingAscLiquescent","TerminatingDesLiquescent","VerticalEpisemaAbove","VerticalEpisemaBelow","VirgaLong","VirgaShort","Virgula","MarkupStackFrame","symbol","properties","ChantNotationElement","DropCap","Lyric","LyricType","TextElement","GlyphVisualizer","HorizontalEpisemaVisualizer","NeumeLineVisualizer","DividerLineVisualizer","ChantLayoutElement","QuickSvg","GlyphCode","_get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getter","__exsurgeCharactersFont","ns","xmlns","xlink","svg","node","createElementNS","setAttribute","setAttributeNS","defs","appendChild","clearNotations","removeChild","hasChildNodes","lastChild","line","x1","y1","x2","y2","g","tspan","str","textContent","use","nodeRef","createFragment","attributes","child","fragment","attr","parseFragment","well","createElement","container","replace","il","firstChild","childNodes","translate","scale","sx","sy","lyricTextColor","dropCapTextSize","dropCapTextColor","annotationTextSize","annotationTextColor","glyphPunctumWidth","glyphPunctumHeight","glyphScaling","staffInterval","staffLineWeight","neumeLineWeight","dividerLineWeight","episemaLineWeight","activeClef","staffLineColor","dividerLineColor","defaultLanguage","svgTextMeasurer","querySelector","hyphen","SingleSyllable","hyphenWidth","minLyricWordSpacing","intraNeumeSpacing","syllableConnector","drawGuides","drawDebuggingBounds","condensingTolerance","autoColor","insertFontsInDoc","staffPosition","styleElement","getElementById","createTextNode","head","selected","highlighted","TextSpan","_ChantLayoutElement","staffPosition0","staffPosition1","y0","calculateHeightFromStaffPosition","temp","fill","class","_ChantLayoutElement2","note0","note1","hanging","neumeLineColor","_ChantLayoutElement3","_this3","_ChantLayoutElement4","glyphCode","_this4","glyph","setGlyph","glyphSrc","transform","xlink:href","boldMarkup","italicMarkup","redMarkup","smallCapsMarkup","createStackFrame","__subsForTspans","&","<",">","_ChantLayoutElement5","fontFamily","fontSize","textAnchor","_this5","dominantBaseline","generateSpansFromText","recalculateMetrics","unsanitizedText","spans","markupStack","spanStartIndex","filterFrames","frame","Symbol","that","closeSpan","spanText","extraProperties","markupRegex","match","exec","markupSymbol","pop","filter","xml","doc","DOMParser","parseFromString","remove","ownerDocument","importNode","documentElement","bbox","getBBox","options","escapeForTspan","styleProperties","getExtraStyleProperties","getCssClasses","trim","text-anchor","dominant-baseline","style","string","String","BeginningSyllable","MiddleSyllable","EndingSyllable","Directive","_TextElement","lyricType","_this6","cssClasses","needsConnector","needs","widthWithConnector","lastSpanTextWithConnector","widthWithoutConnector","lastSpanText","textWithConnector","activeLanguage","result","getSubStringLength","classes","_TextElement2","_this7","padding","_TextElement3","_this8","_ChantLayoutElement6","_this9","leadingSpace","trailingSpace","keepWithNext","lyric","visualizers","chantLayoutElement","isEmpty","clone","union","unshift","hasLyric","inner","ChantDocument","ChantScore","ChantLine","ChantLineBreak","Clef","Note","NoteShapeModifiers","NoteShape","LiquescentType","Exsurge","Large","Small","Ascending","Descending","InitioDebilis","LargeAscending","LargeDescending","SmallAscending","SmallDescending","Virga","Inclinatum","Oriscus","Cavum","Stemmed","glyphVisualizer","liquescent","shape","shapeModifiers","markings","setStaffPosition","shapeModifier","draw","_ChantNotationElement","defaultAccidental","arguments","isClef","activeAccidental","accidentalGlyph","createGlyphVisualizer","addVisualizer","_Clef","stepToStaffOffset","octaveOffset","staffOffsetToStep","accidentalType","finishLayout","_Clef2","AccidentalType","_ChantNotationElement2","justify","lb","scoreNotationStart","scoreNotationCount","notations","notationBounds","lyricBounds","staffLeft","staffRight","custod","ledgerLines","startingClef","nextLine","previousLine","spaceAfterNotations","spaceBetweenTextTracks","clef","notation","lyricVerticalOffset","dropCap","stroke","stroke-width","ledgerLine","newElementStart","setStartingClef","current","previous","previousWithLyric","rightBoundary","scoreNotations","fitsOnLine","positionNotationElement","k","cne","chantLine","last","extraSpace","getLyricRight","notes","Custod","referringNeume","justifyElements","indices","prev","curr","prevWithLyrics","allowsConnector","increment","lastIndex","epismata","neume","note","minLedgerSeperation","half","noteHasEpisema","episema","positionHint","terminating","newY","updateY","l","updateWidth","prevWithLyric","maxRight","setNeedsConnector","getLyricLeft","currLyricLeft","prevLyricRight","lines","compiled","autoColoring","finishedCallback","setTimeout","compileElement","timeout","Date","getTime","currIndex","buildFromChantNotationIndex","lastLine","drawable","def","version","xmlns:xlink","createDropCap","parseChantNotations","defaults","layout","default-font","font-family","font-size","page","margin-left","margin-top","margin-right","margin-bottom","scores","copyLayout","to","from","unserializeFromJson","serializeToJson","Accidental","DoubleBar","FullBar","HalfBar","QuarterBar","DividingLine","getGlyphCode","abs","resetsAccidentals","_DividingLine","apply","_DividingLine2","_DividingLine3","_DividingLine4","line0","line1","Sharp","_ChantNotationElement3","isAccidental","adjustStep","_ChantNotationElement4","Markings","Signs","Neumes","__syllablesRegex","__notationsRegex","gabcNotations","passByRef","currSyllable","matches","lyricText","notationData","items","createNotations","notationWithLyrics","makeLyric","resetAccidentals","concat","elides","elidesToNext","TextOnly","out","addNotation","neumes","createNeumesFromNotes","atoms","atom","lineBreak","convertGabcStaffPositionToScribamPitch","createNoteFromData","accidental","finalTrailingSpace","prevNote","currNote","firstNoteIndex","currNoteIndex","createNeume","includeCurrNote","lastNoteIndex","unknownState","Punctum","handle","virgaState","apostrophaState","oriscusState","punctumState","podatusState","climacusState","clivisState","distrophaState","PesQuassus","Clivis","Podatus","salicusState","scandicusState","pesSubpunctisState","torculusState","porrectusState","Climacus","state","Porrectus","PorrectusFlexus","PesSubpunctis","Salicus","salicusFlexusState","SalicusFlexus","Scandicus","scandicusFlexusState","ScandicusFlexus","bivirgaState","Bivirga","Trivirga","Apostropha","Distropha","Tristropha","Torculus","torculusResupinusState","TorculusResupinus","TorculusResupinusFlexus","toUpperCase","convertGabcStaffPositionToScribamStaffPosition","mark","HorizontalEpisema","Ictus","gabcStaffPos","charCodeAt","scribamStaffPosition","staffPositionToPitch","applyToPitch","Marking","horizontalOffset","verticalOffset","visualizer","_Marking","_Marking2","minDistanceAway","round","_Marking3","_Marking4","Neume","positionMarkings","marking","lowerNote","upperNote","startingX","overhangUpperNote","prevStaffPosition","advanceWidth","multiple","_Neume","StrophaLiquescent","_Neume2","note2","_Neume3","note3","_Neume4","virga","layoutNotesAsInclinati","slice","_Neume5","hasLowerMora","upper","lower","_Neume6","determineNoteGlyphCode","_Neume7","_Neume8","lowerStaffPos","upperStaffPos","needsLines","_Neume9","layoutNotesAsPodatus","_Neume10","_Neume11","first","second","third","firstStaffPosition","secondStaffPosition","thirdStaffPosition","overhangThirdNote","_Neume12","fourth","fourthStaffPosition","_Neume13","_Neume14","_Neume15","_Neume16","isLiquescent","_Neume17","staffPos3","staffPos4","extraLine","_Neume18","_Neume19","drawFirstLine","_Neume20","_Neume21","fifth","fifthStaffPosition","_Neume22","_Neume23"],"mappings":"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","file":"exsurge.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"exsurge\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"exsurge\"] = factory();\n\telse\n\t\troot[\"exsurge\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"exsurge\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"exsurge\"] = factory();\n\telse\n\t\troot[\"exsurge\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t//\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.ChantVisualElement = undefined;\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar _loop = function _loop(_key10) {\n\t  if (_key10 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key10, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge[_key10];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key10 in _Exsurge) {\n\t  var _ret = _loop(_key10);\n\t\n\t  if (_ret === 'continue') continue;\n\t}\n\t\n\tvar _Exsurge2 = __webpack_require__(2);\n\t\n\tvar _loop2 = function _loop2(_key11) {\n\t  if (_key11 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key11, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge2[_key11];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key11 in _Exsurge2) {\n\t  var _ret2 = _loop2(_key11);\n\t\n\t  if (_ret2 === 'continue') continue;\n\t}\n\t\n\tvar _Exsurge3 = __webpack_require__(3);\n\t\n\tvar _loop3 = function _loop3(_key12) {\n\t  if (_key12 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key12, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge3[_key12];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key12 in _Exsurge3) {\n\t  var _ret3 = _loop3(_key12);\n\t\n\t  if (_ret3 === 'continue') continue;\n\t}\n\t\n\tvar _Exsurge4 = __webpack_require__(4);\n\t\n\tvar _loop4 = function _loop4(_key13) {\n\t  if (_key13 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key13, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge4[_key13];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key13 in _Exsurge4) {\n\t  var _ret4 = _loop4(_key13);\n\t\n\t  if (_ret4 === 'continue') continue;\n\t}\n\t\n\tvar _Exsurge5 = __webpack_require__(6);\n\t\n\tvar _loop5 = function _loop5(_key14) {\n\t  if (_key14 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key14, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge5[_key14];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key14 in _Exsurge5) {\n\t  var _ret5 = _loop5(_key14);\n\t\n\t  if (_ret5 === 'continue') continue;\n\t}\n\t\n\tvar _ExsurgeChant = __webpack_require__(9);\n\t\n\tvar _loop6 = function _loop6(_key15) {\n\t  if (_key15 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key15, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _ExsurgeChant[_key15];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key15 in _ExsurgeChant) {\n\t  var _ret6 = _loop6(_key15);\n\t\n\t  if (_ret6 === 'continue') continue;\n\t}\n\t\n\tvar _ExsurgeChant2 = __webpack_require__(7);\n\t\n\tvar _loop7 = function _loop7(_key16) {\n\t  if (_key16 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key16, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _ExsurgeChant2[_key16];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key16 in _ExsurgeChant2) {\n\t  var _ret7 = _loop7(_key16);\n\t\n\t  if (_ret7 === 'continue') continue;\n\t}\n\t\n\tvar _ExsurgeChant3 = __webpack_require__(10);\n\t\n\tvar _loop8 = function _loop8(_key17) {\n\t  if (_key17 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key17, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _ExsurgeChant3[_key17];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key17 in _ExsurgeChant3) {\n\t  var _ret8 = _loop8(_key17);\n\t\n\t  if (_ret8 === 'continue') continue;\n\t}\n\t\n\tvar _Exsurge6 = __webpack_require__(8);\n\t\n\tvar _loop9 = function _loop9(_key18) {\n\t  if (_key18 === \"default\") return 'continue';\n\t  Object.defineProperty(exports, _key18, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _Exsurge6[_key18];\n\t    }\n\t  });\n\t};\n\t\n\tfor (var _key18 in _Exsurge6) {\n\t  var _ret9 = _loop9(_key18);\n\t\n\t  if (_ret9 === 'continue') continue;\n\t}\n\t\n\t// client side support\n\tvar ChantVisualElementPrototype = Object.create(HTMLElement.prototype);\n\t\n\tChantVisualElementPrototype.createdCallback = function () {\n\t  var ctxt = new _Exsurge4.ChantContext();\n\t\n\t  ctxt.lyricTextFont = \"'Crimson Text', serif\";\n\t  ctxt.lyricTextSize *= 1.2;\n\t  ctxt.dropCapTextFont = ctxt.lyricTextFont;\n\t  ctxt.annotationTextFont = ctxt.lyricTextFont;\n\t\n\t  var useDropCap = true;\n\t  var useDropCapAttr = this.getAttribute(\"use-drop-cap\");\n\t  if (useDropCapAttr === 'false') useDropCap = false;\n\t\n\t  var score = _Exsurge6.Gabc.loadChantScore(ctxt, this.innerText, useDropCap);\n\t\n\t  var annotationAttr = this.getAttribute(\"annotation\");\n\t  if (annotationAttr) {\n\t    // add an annotation\n\t    score.annotation = new _Exsurge4.Annotation(ctxt, annotationAttr);\n\t  }\n\t\n\t  var _element = this;\n\t\n\t  var width = 0;\n\t  var doLayout = function doLayout() {\n\t    var newWidth = _element.parentElement.clientWidth;\n\t    if (width === newWidth) return;\n\t    width = newWidth;\n\t    // perform layout on the chant\n\t    score.performLayout(ctxt, function () {\n\t      score.layoutChantLines(ctxt, width, function () {\n\t        // render the score to svg code\n\t        _element.innerHTML = score.createDrawable(ctxt);\n\t      });\n\t    });\n\t  };\n\t  doLayout();\n\t  if (window.addEventListener) window.addEventListener('resize', doLayout, false);else if (window.attachEvent) window.attachEvent('onresize', doLayout);\n\t};\n\t\n\tChantVisualElementPrototype.attachedCallback = function () {};\n\t\n\tdocument.registerElement = document.registerElement || function () {};\n\t// register the custom element\n\tvar ChantVisualElement = exports.ChantVisualElement = document.registerElement('chant-visual', {\n\t  prototype: ChantVisualElementPrototype\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.DeviceIndependent = DeviceIndependent;\n\texports.Centimeters = Centimeters;\n\texports.Millimeters = Millimeters;\n\texports.Inches = Inches;\n\texports.ToCentimeters = ToCentimeters;\n\texports.ToMillimeters = ToMillimeters;\n\texports.ToInches = ToInches;\n\texports.generateRandomGuid = generateRandomGuid;\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t//\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar Units = exports.Units = {\n\t  // enums\n\t  DeviceIndepenedent: 0, // device independent units: 96/inch\n\t  Centimeters: 1,\n\t  Millimeters: 2,\n\t  Inches: 3,\n\t\n\t  // constants for device independent units (diu)\n\t  DIU_PER_INCH: 96,\n\t  DIU_PER_CENTIMETER: 96 / 2.54,\n\t\n\t  ToDeviceIndependent: function ToDeviceIndependent(n, inputUnits) {\n\t    switch (inputUnits) {\n\t      case Centimeters:\n\t        return n * DIU_PER_CENTIMETER;\n\t      case Millimeters:\n\t        return n * DIU_PER_CENTIMETER / 10;\n\t      case Inches:\n\t        return n * DIU_PER_INCH;\n\t      default:\n\t        return n;\n\t    }\n\t  },\n\t\n\t  FromDeviceIndependent: function FromDeviceIndependent(n, outputUnits) {\n\t    switch (outputUnits) {\n\t      case Centimeters:\n\t        return n / DIU_PER_CENTIMETER;\n\t      case Millimeters:\n\t        return n / DIU_PER_CENTIMETER * 10;\n\t      case Inches:\n\t        return n / DIU_PER_INCH;\n\t      default:\n\t        return n;\n\t    }\n\t  },\n\t\n\t  StringToUnitsType: function StringToUnitsType(s) {\n\t    switch (s.ToLower()) {\n\t      case \"in\":\n\t      case \"inches\":\n\t        return Inches;\n\t\n\t      case \"cm\":\n\t      case \"centimeters\":\n\t        return Centimeters;\n\t\n\t      case \"mm\":\n\t      case \"millimeters\":\n\t        return Millimeters;\n\t\n\t      case \"di\":\n\t      case \"device-independent\":\n\t        return DeviceIndepenedent;\n\t\n\t      default:\n\t        return DeviceIndepenedent;\n\t    }\n\t  },\n\t\n\t  UnitsTypeToString: function UnitsTypeToString(units) {\n\t    switch (units) {\n\t      case Inches:\n\t        return \"in\";\n\t      case Centimeters:\n\t        return \"cm\";\n\t      case Millimeters:\n\t        return \"mm\";\n\t      case DeviceIndepenedent:\n\t        return \"device-independent\";\n\t      default:\n\t        return \"device-independent\";\n\t    }\n\t  }\n\t};\n\t\n\tfunction DeviceIndependent(n) {\n\t  return n;\n\t}\n\t\n\tfunction Centimeters(n) {\n\t  return Units.ToDeviceIndependent(n, Units.Centimeters);\n\t}\n\t\n\tfunction Millimeters(n) {\n\t  return Units.ToDeviceIndependent(n, Units.Millimeters);\n\t}\n\t\n\tfunction Inches(n) {\n\t  return Units.ToDeviceIndependent(n, Units.Inches);\n\t}\n\t\n\tfunction ToCentimeters(n) {\n\t  return Units.FromDeviceIndependent(n, Units.Centimeters);\n\t}\n\t\n\tfunction ToMillimeters(n) {\n\t  return Units.FromDeviceIndependent(n, Units.Millimeters);\n\t}\n\t\n\tfunction ToInches(n) {\n\t  return Units.FromDeviceIndependent(n, Units.Inches);\n\t}\n\t\n\t/*\r\n\t * Point\r\n\t */\n\t\n\tvar Point = exports.Point = function () {\n\t  function Point(x, y) {\n\t    _classCallCheck(this, Point);\n\t\n\t    this.x = typeof x !== 'undefined' ? x : 0;\n\t    this.y = typeof y !== 'undefined' ? y : 0;\n\t  }\n\t\n\t  _createClass(Point, [{\n\t    key: \"clone\",\n\t    value: function clone() {\n\t      return new Point(this.x, this.y);\n\t    }\n\t  }, {\n\t    key: \"equals\",\n\t    value: function equals(point) {\n\t      return this.x === point.x && this.y === point.y;\n\t    }\n\t  }]);\n\t\n\t  return Point;\n\t}();\n\t\n\t/*\r\n\t * Rect\r\n\t */\n\t\n\t\n\tvar Rect = exports.Rect = function () {\n\t  function Rect(x, y, width, height) {\n\t    _classCallCheck(this, Rect);\n\t\n\t    this.x = typeof x !== 'undefined' ? x : Infinity;\n\t    this.y = typeof y !== 'undefined' ? y : Infinity;\n\t    this.width = typeof width !== 'undefined' ? width : -Infinity;\n\t    this.height = typeof height !== 'undefined' ? height : -Infinity;\n\t  }\n\t\n\t  _createClass(Rect, [{\n\t    key: \"clone\",\n\t    value: function clone() {\n\t      return new Rect(this.x, this.y, this.width, this.height);\n\t    }\n\t  }, {\n\t    key: \"isEmpty\",\n\t    value: function isEmpty() {\n\t      return this.x === Infinity && this.y === Infinity && this.width === -Infinity && this.height === -Infinity;\n\t    }\n\t\n\t    // convenience method\n\t\n\t  }, {\n\t    key: \"right\",\n\t    value: function right() {\n\t      return this.x + this.width;\n\t    }\n\t  }, {\n\t    key: \"bottom\",\n\t    value: function bottom() {\n\t      return this.y + this.height;\n\t    }\n\t  }, {\n\t    key: \"equals\",\n\t    value: function equals(rect) {\n\t      return this.x === rect.x && this.y === rect.y && this.width === rect.width && this.height === rect.height;\n\t    }\n\t\n\t    // other can be a Point or a Rect\n\t\n\t  }, {\n\t    key: \"contains\",\n\t    value: function contains(other) {\n\t      if (other instanceof Point) {\n\t        return other.x >= this.x && other.x <= this.x + this.width && other.y >= this.y && other.y <= this.y + this.height;\n\t      } else {\n\t        // better be instance of Rect\n\t        return this.x <= other.x && this.x + this.width >= other.x + other.width && this.y <= other.y && this.y + this.height >= other.y + other.height;\n\t      }\n\t    }\n\t  }, {\n\t    key: \"union\",\n\t    value: function union(rect) {\n\t\n\t      var right = Math.max(this.x + this.width, rect.x + rect.width);\n\t      var bottom = Math.max(this.y + this.height, rect.y + rect.height);\n\t\n\t      this.x = Math.min(this.x, rect.x);\n\t      this.y = Math.min(this.y, rect.y);\n\t\n\t      this.width = right - this.x;\n\t      this.height = bottom - this.y;\n\t    }\n\t  }]);\n\t\n\t  return Rect;\n\t}();\n\t\n\t/**\r\n\t * Margins\r\n\t *\r\n\t * @class\r\n\t */\n\t\n\t\n\tvar Margins = exports.Margins = function () {\n\t  function Margins(left, top, right, bottom) {\n\t    _classCallCheck(this, Margins);\n\t\n\t    this.left = typeof left !== 'undefined' ? left : 0;\n\t    this.top = typeof top !== 'undefined' ? top : 0;\n\t    this.right = typeof right !== 'undefined' ? right : 0;\n\t    this.bottom = typeof bottom !== 'undefined' ? bottom : 0;\n\t  }\n\t\n\t  _createClass(Margins, [{\n\t    key: \"clone\",\n\t    value: function clone() {\n\t      return new Margins(this.left, this.top, this.right, this.bottom);\n\t    }\n\t  }, {\n\t    key: \"equals\",\n\t    value: function equals(margins) {\n\t      return this.left === margins.left && this.top === margins.top && this.right === margins.right && this.bottom === margins.bottom;\n\t    }\n\t  }]);\n\t\n\t  return Margins;\n\t}();\n\t\n\t/**\r\n\t * Size\r\n\t *\r\n\t * @class\r\n\t */\n\t\n\t\n\tvar Size = exports.Size = function () {\n\t  function Size(width, height) {\n\t    _classCallCheck(this, Size);\n\t\n\t    this.width = typeof width !== 'undefined' ? width : 0;\n\t    this.height = typeof height !== 'undefined' ? height : 0;\n\t  }\n\t\n\t  _createClass(Size, [{\n\t    key: \"clone\",\n\t    value: function clone() {\n\t      return new Size(this.width, this.height);\n\t    }\n\t  }, {\n\t    key: \"equals\",\n\t    value: function equals(size) {\n\t      return this.width === size.width && this.height === size.height;\n\t    }\n\t  }]);\n\t\n\t  return Size;\n\t}();\n\t\n\t/*\r\n\t * Pitches, notes\r\n\t */\n\t\n\t\n\tvar Step = exports.Step = {\n\t  Do: 0,\n\t  Du: 1,\n\t  Re: 2,\n\t  Me: 3,\n\t  Mi: 4,\n\t  Fa: 5,\n\t  Fu: 6,\n\t  So: 7,\n\t  La: 9,\n\t  Te: 10,\n\t  Ti: 11\n\t};\n\t\n\t// this little array helps map step values to staff positions. The numeric values of steps\n\t// correspond to whole step increments (2) or half step increments (1). This gives us the ability\n\t// to compare pitches precisely, but makes it challenging to place steps on the staff. this little\n\t// array maps the steps to an incremental position the steps take on the staff line. This works\n\t// so simply because chant only uses do and fa clefs, and only has a flatted ti (te), making\n\t// for relatively easy mapping to staff line locations.\n\t//                         Do Du Re Me Mi Fa Fu So    La Te Ti\n\tvar __StepToStaffPosition = [0, 0, 1, 1, 2, 3, 3, 4, 4, 5, 6, 6];\n\tvar __StaffOffsetToStep = [Step.Do, Step.Re, Step.Mi, Step.Fa, Step.So, Step.La, Step.Ti]; // no accidentals in this one\n\t\n\tvar Pitch = exports.Pitch = function () {\n\t  function Pitch(step, octave) {\n\t    _classCallCheck(this, Pitch);\n\t\n\t    this.step = step;\n\t    this.octave = octave;\n\t  }\n\t\n\t  _createClass(Pitch, [{\n\t    key: \"toInt\",\n\t    value: function toInt() {\n\t      return this.octave * 12 + this.step;\n\t    }\n\t  }, {\n\t    key: \"isHigherThan\",\n\t    value: function isHigherThan(pitch) {\n\t      return this.toInt() > pitch.toInt();\n\t    }\n\t  }, {\n\t    key: \"isLowerThan\",\n\t    value: function isLowerThan(pitch) {\n\t      return this.toInt() < pitch.toInt();\n\t    }\n\t  }, {\n\t    key: \"equals\",\n\t    value: function equals(pitch) {\n\t      return this.toInt() === pitch.toInt();\n\t    }\n\t  }], [{\n\t    key: \"stepToStaffOffset\",\n\t    value: function stepToStaffOffset(step) {\n\t      return __StepToStaffPosition[step];\n\t    }\n\t  }, {\n\t    key: \"staffOffsetToStep\",\n\t    value: function staffOffsetToStep(offset) {\n\t      while (offset < 0) {\n\t        offset = __StaffOffsetToStep.length + offset;\n\t      }return __StaffOffsetToStep[offset % __StaffOffsetToStep.length];\n\t    }\n\t  }]);\n\t\n\t  return Pitch;\n\t}();\n\t\n\t// for positioning markings on notes\n\t\n\t\n\tvar MarkingPositionHint = exports.MarkingPositionHint = {\n\t  Default: 0,\n\t  Above: 1,\n\t  Below: 2\n\t};\n\t\n\tfunction generateRandomGuid() {\n\t  function s4() {\n\t    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n\t  }\n\t  return s4() + s4();\n\t}\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Spanish = exports.Latin = exports.Language = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar Exsurge = _interopRequireWildcard(_Exsurge);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\r\n\t * @class\r\n\t */\n\t\n\tvar Language = exports.Language = function () {\n\t  function Language(name) {\n\t    _classCallCheck(this, Language);\n\t\n\t    this.name = typeof name !== 'undefined' ? name : \"<unknown>\";\n\t  }\n\t\n\t  /**\r\n\t   * @param {String} text The string to parsed into words.\r\n\t   * @return {Word[]} the resulting parsed words from syllabification\r\n\t   */\n\t\n\t\n\t  _createClass(Language, [{\n\t    key: 'syllabify',\n\t    value: function syllabify(text) {\n\t\n\t      var parsedWords = [];\n\t\n\t      if (typeof text === 'undefined' || text === \"\") return parsedWords;\n\t\n\t      // Divide the text into words separated by whitespace\n\t      var words = text.split(/[\\s]+/);\n\t\n\t      for (var i = 0, end = words.length; i < end; i++) {\n\t        parsedWords.push(this.syllabifyWord(words[i]));\n\t      }return parsedWords;\n\t    }\n\t  }]);\n\t\n\t  return Language;\n\t}();\n\t\n\t/**\r\n\t * @class\r\n\t */\n\t\n\t\n\tvar Latin = exports.Latin = function (_Language) {\n\t  _inherits(Latin, _Language);\n\t\n\t  /**\r\n\t   * @constructs\r\n\t   */\n\t\n\t  function Latin() {\n\t    _classCallCheck(this, Latin);\n\t\n\t    // fixme: should we include 'diphthongs' with accented vowels, e.g., e?\n\t    // fixme: ui is only diphthong in the exceptional cases below (according to Wheelock's Latin)\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Latin).call(this, \"Latin\"));\n\t\n\t    _this.diphthongs = [\"ae\", \"au\", \"oe\"];\n\t\n\t    // some words that are simply exceptions to standard syllabification rules!\n\t    var wordExceptions = new Object();\n\t\n\t    // ui combos pronounced as diphthongs\n\t    wordExceptions[\"huius\"] = [\"hui\", \"us\"];\n\t    wordExceptions[\"cuius\"] = [\"cui\", \"us\"];\n\t    wordExceptions[\"huic\"] = [\"huic\"];\n\t    wordExceptions[\"cui\"] = [\"cui\"];\n\t    wordExceptions[\"hui\"] = [\"hui\"];\n\t\n\t    _this.vowels = ['a', 'e', 'i', 'o', 'u', '', '', '', '', '', '', '', '', // no accented  in unicode?\n\t    'y']; // y is treated as a vowel; not native to Latin but useful for words borrowed from Greek\n\t\n\t    _this.muteConsonantsAndF = ['b', 'c', 'd', 'g', 'p', 't', 'f'];\n\t\n\t    _this.liquidConsonants = ['l', 'r'];\n\t    return _this;\n\t  }\n\t\n\t  // c must be lowercase!\n\t\n\t\n\t  _createClass(Latin, [{\n\t    key: 'isVowel',\n\t    value: function isVowel(c) {\n\t      for (var i = 0, end = this.vowels.length; i < end; i++) {\n\t        if (this.vowels[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     * f is not a mute consonant, but we lump it together for syllabification\r\n\t     * since it is syntactically treated the same way\r\n\t     *\r\n\t     * @param {String} c The character to test; must be lowercase\r\n\t     * @return {boolean} true if c is an f or a mute consonant\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isMuteConsonantOrF',\n\t    value: function isMuteConsonantOrF(c) {\n\t      for (var i = 0, end = this.muteConsonantsAndF.length; i < end; i++) {\n\t        if (this.muteConsonantsAndF[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} c The character to test; must be lowercase\r\n\t     * @return {boolean} true if c is a liquid consonant\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isLiquidConsonant',\n\t    value: function isLiquidConsonant(c) {\n\t      for (var i = 0, end = this.liquidConsonants.length; i < end; i++) {\n\t        if (this.liquidConsonants[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} s The string to test; must be lowercase\r\n\t     * @return {boolean} true if s is a diphthong\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isDiphthong',\n\t    value: function isDiphthong(s) {\n\t      for (var i = 0, end = this.diphthongs.length; i < end; i++) {\n\t        if (this.diphthongs[i] === s) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     * Rules for Latin syllabification (from Collins, \"A Primer on Ecclesiastical Latin\")\r\n\t     *\r\n\t     * Divisions occur when:\r\n\t     *   1. After open vowels (those not followed by a consonant) (e.g., \"pi-us\" and \"De-us\")\r\n\t     *   2. After vowels followed by a single consonant (e.g., \"vi-ta\" and \"ho-ra\")\r\n\t     *   3. After the first consonant when two or more consonants follow a vowel\r\n\t     *      (e.g., \"mis-sa\", \"minis-ter\", and \"san-ctus\").\r\n\t     *\r\n\t     * Exceptions:\r\n\t     *   1. In compound words the consonants stay together (e.g., \"de-scribo\").\r\n\t     *   2. A mute consonant (b, c, d, g, p, t) or f followed by a liquid consonant (l, r)\r\n\t     *      go with the succeeding vowel: \"la-crima\", \"pa-tris\"\r\n\t     *\r\n\t     * In addition to these rules, Wheelock's Latin provides this sound exception:\r\n\t     *   -  Also counted as single consonants are qu and the aspirates ch, ph,\r\n\t     *      th, which should never be separated in syllabification:\r\n\t     *      architectus, ar-chi-tec-tus; loquacem, lo-qua-cem.\r\n\t     *\r\n\t     */\n\t\n\t  }, {\n\t    key: 'syllabifyWord',\n\t    value: function syllabifyWord(word) {\n\t      var syllables = [];\n\t      var haveCompleteSyllable = false;\n\t      var previousWasVowel = false;\n\t      var workingString = word.toLowerCase();\n\t      var startSyllable = 0;\n\t\n\t      var c, lookahead, haveLookahead;\n\t\n\t      // a helper function to create syllables\n\t      var makeSyllable = function makeSyllable(length) {\n\t        if (haveCompleteSyllable) {\n\t          syllables.push(word.substr(startSyllable, length));\n\t          startSyllable += length;\n\t        }\n\t\n\t        haveCompleteSyllable = false;\n\t      };\n\t\n\t      for (var i = 0, wordLength = workingString.length; i < wordLength; i++) {\n\t\n\t        c = workingString[i];\n\t\n\t        // get our lookahead in case we need them...\n\t        lookahead = '*';\n\t        haveLookahead = i + 1 < wordLength;\n\t\n\t        if (haveLookahead) lookahead = workingString[i + 1];\n\t\n\t        var cIsVowel = this.isVowel(c);\n\t\n\t        // i is a special case for a vowel. when i is at the beginning\n\t        // of the word (Iesu) or i is between vowels (alleluia),\n\t        // then the i is treated as a consonant (y)\n\t        if (c === 'i') {\n\t          if (i === 0 && haveLookahead && this.isVowel(lookahead)) cIsVowel = false;else if (previousWasVowel && haveLookahead && this.isVowel(lookahead)) {\n\t            cIsVowel = false;\n\t          }\n\t        }\n\t\n\t        if (c === '-') {\n\t\n\t          // a hyphen forces a syllable break, which effectively resets\n\t          // the logic...\n\t\n\t          haveCompleteSyllable = true;\n\t          previousWasVowel = false;\n\t          makeSyllable(i - startSyllable);\n\t          startSyllable++;\n\t        } else if (cIsVowel) {\n\t\n\t          // once we get a vowel, we have a complete syllable\n\t          haveCompleteSyllable = true;\n\t\n\t          if (previousWasVowel && !this.isDiphthong(workingString[i - 1] + \"\" + c)) {\n\t            makeSyllable(i - startSyllable);\n\t            haveCompleteSyllable = true;\n\t          }\n\t\n\t          previousWasVowel = true;\n\t        } else if (haveLookahead) {\n\t\n\t          if (c === 'q' && lookahead === 'u' || lookahead === 'h' && (c === 'c' || c === 'p' || c === 't')) {\n\t            // handle wheelock's exceptions for qu, ch, ph and th\n\t            makeSyllable(i - startSyllable);\n\t            i++; // skip over the 'h' or 'u'\n\t          } else if (previousWasVowel && this.isVowel(lookahead)) {\n\t              // handle division rule 2\n\t              makeSyllable(i - startSyllable);\n\t            } else if (this.isMuteConsonantOrF(c) && this.isLiquidConsonant(lookahead)) {\n\t              // handle exception 2\n\t              makeSyllable(i - startSyllable);\n\t            } else if (haveCompleteSyllable) {\n\t              // handle division rule 3\n\t              makeSyllable(i + 1 - startSyllable);\n\t            }\n\t\n\t          previousWasVowel = false;\n\t        }\n\t      }\n\t\n\t      // if we have a complete syllable, we can add it as a new one. Otherwise\n\t      // we tack the remaining characters onto the last syllable.\n\t      if (haveCompleteSyllable) syllables.push(word.substr(startSyllable));else if (startSyllable > 0) syllables[syllables.length - 1] += word.substr(startSyllable);\n\t\n\t      return syllables;\n\t    }\n\t\n\t    /**\r\n\t     * @param {String} s the string to search\r\n\t     * @param {Number} startIndex The index at which to start searching for a vowel in the string\r\n\t     * @retuns a custom class with three properties: {found: (true/false) startIndex: (start index in s of vowel segment) length ()}\r\n\t     */\n\t\n\t  }, {\n\t    key: 'findVowelSegment',\n\t    value: function findVowelSegment(s, startIndex) {\n\t\n\t      var i, end, index;\n\t      var workingString = s.toLowerCase();\n\t\n\t      // do we have a diphthongs?\n\t      for (i = 0, end = this.diphthongs.length; i < end; i++) {\n\t        var d = this.diphthongs[i];\n\t        index = workingString.indexOf(d, startIndex);\n\t\n\t        if (index >= 0) return { found: true, startIndex: index, length: d.length };\n\t      }\n\t\n\t      // no diphthongs. Let's look for single vowels then...\n\t      for (i = 0, end = this.vowels.length; i < end; i++) {\n\t        index = workingString.indexOf(this.vowels[i], startIndex);\n\t\n\t        if (index >= 0) {\n\t          // if the first vowel found is a U, and it is immediately followed by another vowel, (e.g., sanguis, quis), the first u counts as a consonant:\n\t          // (in practice, this only affects words such as equus that contain a uu, since the alphabetically earlier vowel would be found before the U)\n\t          if (this.vowels[i] === 'u' && this.isVowel(workingString[index + 1])) {\n\t            ++index;\n\t          }\n\t          return { found: true, startIndex: index, length: 1 };\n\t        }\n\t      }\n\t\n\t      // no vowels sets found after startIndex!\n\t      return { found: false, startIndex: -1, length: -1 };\n\t    }\n\t  }]);\n\t\n\t  return Latin;\n\t}(Language);\n\t\n\t/**\r\n\t * @class\r\n\t */\n\t\n\t\n\tvar Spanish = exports.Spanish = function (_Language2) {\n\t  _inherits(Spanish, _Language2);\n\t\n\t  function Spanish() {\n\t    _classCallCheck(this, Spanish);\n\t\n\t    var _this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(Spanish).call(this, \"Spanish\"));\n\t\n\t    _this2.vowels = ['a', 'e', 'i', 'o', 'u', 'y', '', '', '', '', '', ''];\n\t\n\t    _this2.weakVowels = ['i', 'u', '', 'y'];\n\t\n\t    _this2.strongVowels = ['a', 'e', 'o', '', '', '', '', ''];\n\t\n\t    _this2.diphthongs = [\"ai\", \"ei\", \"oi\", \"ui\", \"ia\", \"ie\", \"io\", \"iu\", \"au\", \"eu\", \"ou\", \"ua\", \"ue\", \"uo\", \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"u\", \"u\", \"u\", \"u\", \"u\", \"u\", \"e\", \"i\"];\n\t\n\t    _this2.uDiphthongExceptions = [\"gue\", \"gui\", \"qua\", \"que\", \"qui\", \"quo\"];\n\t    return _this2;\n\t  }\n\t\n\t  // c must be lowercase!\n\t\n\t\n\t  _createClass(Spanish, [{\n\t    key: 'isVowel',\n\t    value: function isVowel(c) {\n\t      for (var i = 0, end = this.vowels.length; i < end; i++) {\n\t        if (this.vowels[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     * @param {String} c The character to test; must be lowercase\r\n\t     * @return {boolean} true if c is an f or a mute consonant\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isWeakVowel',\n\t    value: function isWeakVowel(c) {\n\t      for (var i = 0, end = this.weakVowels.length; i < end; i++) {\n\t        if (this.weakVowels[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     * @param {String} c The character to test; must be lowercase\r\n\t     * @return {boolean} true if c is an f or a mute consonant\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isStrongVowel',\n\t    value: function isStrongVowel(c) {\n\t      for (var i = 0, end = this.strongVowels.length; i < end; i++) {\n\t        if (this.strongVowels[i] === c) return true;\n\t      }return false;\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} s The string to test; must be lowercase\r\n\t     * @return {boolean} true if s is a diphthong\r\n\t     */\n\t\n\t  }, {\n\t    key: 'isDiphthong',\n\t    value: function isDiphthong(s) {\n\t      for (var i = 0, end = this.diphthongs.length; i < end; i++) {\n\t        if (this.diphthongs[i] === s) return true;\n\t      }return false;\n\t    }\n\t  }, {\n\t    key: 'createSyllable',\n\t    value: function createSyllable(text) {\n\t\n\t      /*\r\n\t          var accented = false;\r\n\t          var ellidesToNext = false;\r\n\t      \r\n\t          if (text.length > 0) {\r\n\t              \r\n\t              if (text[0] == '`') {\r\n\t                  accented = true;\r\n\t                  text = text.substr(1);\r\n\t              }\r\n\t      \r\n\t              if (text[text.length - 1] == '_') {\r\n\t                  ellidesToNext = true;\r\n\t                  text = text.substr(0, text.length - 1);\r\n\t              }\r\n\t          }\r\n\t      \r\n\t          var s = new Syllable(text);\r\n\t      \r\n\t          s.isMusicalAccent = accented;\r\n\t          s.elidesToNext = ellidesToNext;*/\n\t\n\t      return text;\n\t    }\n\t\n\t    /**\r\n\t     */\n\t\n\t  }, {\n\t    key: 'syllabifyWord',\n\t    value: function syllabifyWord(word) {\n\t\n\t      var syllables = [];\n\t\n\t      var haveCompleteSyllable = false;\n\t      var previousIsVowel = false;\n\t      var previousIsStrongVowel = false; // only valid if previousIsVowel == true\n\t      var startSyllable = 0;\n\t\n\t      // fixme: first check for prefixes\n\t\n\t      for (i = 0; i < word.length; i++) {\n\t\n\t        var c = word[i].toLowerCase();\n\t\n\t        if (this.isVowel(c)) {\n\t\n\t          // we have a complete syllable as soon as we have a vowel\n\t          haveCompleteSyllable = true;\n\t\n\t          var cIsStrongVowel = this.isStrongVowel(c);\n\t\n\t          if (previousIsVowel) {\n\t            // if we're at a strong vowel, then we finish out the last syllable\n\t            if (cIsStrongVowel) {\n\t              if (previousIsStrongVowel) {\n\t                syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\n\t                startSyllable = i;\n\t              }\n\t            }\n\t          }\n\t\n\t          previousIsVowel = true;\n\t          previousIsStrongVowel = cIsStrongVowel;\n\t        } else {\n\t          if (!haveCompleteSyllable) {\n\t            // do nothing since we don't have a complete syllable yet...\n\t          } else {\n\t\n\t              // handle explicit syllable breaks\n\t              if (word[i] === '-') {\n\t                // start new syllable\n\t                syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\n\t                startSyllable = ++i;\n\t              } else {\n\t\n\t                var numberOfConsonants = 1,\n\t                    consonant2;\n\t\n\t                // count how many more consonants there are\n\t                for (j = i + 1; j < word.length; j++) {\n\t                  if (this.isVowel(word[j])) break;\n\t                  numberOfConsonants++;\n\t                }\n\t\n\t                if (numberOfConsonants === 1) {\n\t                  // start new syllable\n\t                  syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\n\t                  startSyllable = i;\n\t                } else if (numberOfConsonants === 2) {\n\t                  consonant2 = word[i + 1].toLowerCase();\n\t                  if (consonant2 === 'l' || consonant2 === 'r' || c === 'c' && consonant2 === 'h') {\n\t                    // split before the consonant pair\n\t                    syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\n\t                    startSyllable = i++;\n\t                  } else {\n\t                    //split the consonants\n\t                    syllables.push(this.createSyllable(word.substr(startSyllable, ++i - startSyllable)));\n\t                    startSyllable = i;\n\t                  }\n\t                } else if (numberOfConsonants === 3) {\n\t                  consonant2 = word[i + 1].toLowerCase();\n\t\n\t                  // if second consonant is s, divide cc-c, otherwise divide c-cc\n\t                  if (consonant2 === 's') {\n\t                    i += 2;\n\t                    syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\n\t                  } else syllables.push(this.createSyllable(word.substr(startSyllable, ++i - startSyllable)));\n\t\n\t                  startSyllable = i;\n\t                } else if (numberOfConsonants === 4) {\n\t                  // four always get split cc-cc\n\t                  syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable + 2)));\n\t                  startSyllable = i + 2;\n\t                  i += 3;\n\t                }\n\t              }\n\t\n\t              haveCompleteSyllable = false;\n\t            }\n\t\n\t          previousIsVowel = false;\n\t        }\n\t      }\n\t\n\t      // if we have a complete syllable, we can add it as a new one. Otherwise\n\t      // we tack the remaining characters onto the last syllable.\n\t      if (haveCompleteSyllable) syllables.push(word.substr(startSyllable));else if (startSyllable > 0) syllables[syllables.length - 1] += word.substr(startSyllable);else if (syllables.length === 0) syllables.push(this.createSyllable(word));\n\t\n\t      return syllables;\n\t    }\n\t\n\t    /**\r\n\t     * @param {String} s the string to search\r\n\t     * @param {Number} startIndex The index at which to start searching for a vowel in the string\r\n\t     * @retuns a custom class with three properties: {found: (true/false) startIndex: (start index in s of vowel segment) length ()}\r\n\t     */\n\t\n\t  }, {\n\t    key: 'findVowelSegment',\n\t    value: function findVowelSegment(s, startIndex) {\n\t\n\t      var i, end, index;\n\t      var workingString = s.toLowerCase();\n\t\n\t      // do we have a diphthongs?\n\t      for (i = 0, end = this.diphthongs.length; i < end; i++) {\n\t        var d = this.diphthongs[i];\n\t        index = workingString.indexOf(d, startIndex);\n\t\n\t        if (index >= 0) {\n\t\n\t          // check the exceptions...\n\t          if (d[0] === 'u' && index > 0) {\n\t            var tripthong = s.substr(index - 1, 3).toLowerCase();\n\t\n\t            for (j = 0, endj = this.uDiphthongExceptions.length; i < endj; j++) {\n\t              if (tripthong === this.uDiphthongExceptions[j]) {\n\t                // search from after the u...\n\t                return this.findVowelSegment(s, index + 1);\n\t              }\n\t            }\n\t          }\n\t\n\t          return { found: true, startIndex: index, length: d.length };\n\t        }\n\t      }\n\t\n\t      // no diphthongs. Let's look for single vowels then...\n\t      for (i = 0, end = this.vowels.length; i < end; i++) {\n\t        index = workingString.indexOf(this.vowels[i], startIndex);\n\t\n\t        if (index >= 0) return { found: true, startIndex: index, length: 1 };\n\t      }\n\t\n\t      // no vowels sets found after startIndex!\n\t      return { found: false, startIndex: -1, length: -1 };\n\t    }\n\t  }]);\n\t\n\t  return Spanish;\n\t}(Language);\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t//\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\t// generated based on the svg data\n\tvar Glyphs = exports.Glyphs = {\n\t  \"None\": {\n\t    \"svgSrc\": \"<g></g>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 0,\n\t      \"height\": 0\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 0\n\t    }\n\t  },\n\t  \"AcuteAccent\": {\n\t    \"svgSrc\": \"<path d=\\\"M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 110.99200439453125,\n\t      \"height\": 125.79399108886719\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0.8030000329017639,\n\t      \"y\": 125.27399444580078\n\t    }\n\t  },\n\t  \"Stropha\": {\n\t    \"svgSrc\": \"<path d=\\\"M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 97.65699768066406,\n\t      \"height\": 151.56201171875\n\t    },\n\t    \"origin\": {\n\t      \"x\": 48,\n\t      \"y\": 73.43800354003906\n\t    }\n\t  },\n\t  \"BeginningAscLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 152.343994140625\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 88.34400177001953\n\t    }\n\t  },\n\t  \"BeginningDesLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 151.56199645996094\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 75.56199645996094\n\t    }\n\t  },\n\t  \"CustodDescLong\": {\n\t    \"svgSrc\": \"<path d=\\\"M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 46.35300064086914,\n\t      \"height\": 339.58197021484375\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 65.58999633789062\n\t    }\n\t  },\n\t  \"CustodDescShort\": {\n\t    \"svgSrc\": \"<path d=\\\"M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 43.75,\n\t      \"height\": 270.0530090332031\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 65.88999938964844\n\t    }\n\t  },\n\t  \"CustodLong\": {\n\t    \"svgSrc\": \"<path d=\\\"M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 46.35300064086914,\n\t      \"height\": 339.5820007324219\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 270.0820007324219\n\t    }\n\t  },\n\t  \"CustodShort\": {\n\t    \"svgSrc\": \"<path d=\\\"M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 43.75,\n\t      \"height\": 270.052001953125\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 200.36500549316406\n\t    }\n\t  },\n\t  \"DoClef\": {\n\t    \"svgSrc\": \"<path d=\\\"M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 331.2510070800781\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0,\n\t      \"y\": 164.87600708007812\n\t    }\n\t  },\n\t  \"FaClef\": {\n\t    \"svgSrc\": \"<path d=\\\"M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 193.75201416015625,\n\t      \"height\": 333.5950012207031\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0.001003265380859375,\n\t      \"y\": 157.00100708007812\n\t    }\n\t  },\n\t  \"Flat\": {\n\t    \"svgSrc\": \"<path d=\\\"M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 97.91699981689453,\n\t      \"height\": 267.968994140625\n\t    },\n\t    \"origin\": {\n\t      \"x\": 1.0420000553131104,\n\t      \"y\": 204.406005859375\n\t    }\n\t  },\n\t  \"Mora\": {\n\t    \"svgSrc\": \"<path d=\\\"M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 48,\n\t      \"height\": 48\n\t    },\n\t    \"origin\": {\n\t      \"x\": -24,\n\t      \"y\": 24\n\t    }\n\t  },\n\t  \"Natural\": {\n\t    \"svgSrc\": \"<path d=\\\"M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 70.31100463867188,\n\t      \"height\": 330.468994140625\n\t    },\n\t    \"origin\": {\n\t      \"x\": 0.3120002746582031,\n\t      \"y\": 166.56300354003906\n\t    }\n\t  },\n\t  \"OriscusAsc\": {\n\t    \"svgSrc\": \"<path d=\\\"M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 147.656005859375\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 76\n\t    }\n\t  },\n\t  \"OriscusDes\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 147.656005859375\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 75.40599822998047\n\t    }\n\t  },\n\t  \"OriscusLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 147.656005859375\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 75.40599822998047\n\t    }\n\t  },\n\t  \"PodatusLower\": {\n\t    \"svgSrc\": \"<path d=\\\"M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 103.12399291992188\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 42\n\t    }\n\t  },\n\t  \"PodatusUpper\": {\n\t    \"svgSrc\": \"<path d=\\\"M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 91.406005859375,\n\t      \"height\": 125.78099822998047\n\t    },\n\t    \"origin\": {\n\t      \"x\": 91.406005859375,\n\t      \"y\": 63.78099822998047\n\t    }\n\t  },\n\t  \"Porrectus1\": {\n\t    \"svgSrc\": \"<path d=\\\"M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 302.343994140625,\n\t      \"height\": 215.6269989013672\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 52.75\n\t    }\n\t  },\n\t  \"Porrectus2\": {\n\t    \"svgSrc\": \"<path d=\\\"M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 377.3429870605469,\n\t      \"height\": 328.1260070800781\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 68.75\n\t    }\n\t  },\n\t  \"Porrectus3\": {\n\t    \"svgSrc\": \"<path d=\\\"M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 377.343994140625,\n\t      \"height\": 427.3450012207031\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 70\n\t    }\n\t  },\n\t  \"Porrectus4\": {\n\t    \"svgSrc\": \"<path d=\\\"M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 420,\n\t      \"height\": 525.780029296875\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 70\n\t    }\n\t  },\n\t  \"PunctumCavum\": {\n\t    \"svgSrc\": \"<path d=\\\"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\\\"/><path fill=\\\"#fff\\\" d=\\\"M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\"\n\t    }, {\n\t      \"type\": \"negative\",\n\t      \"data\": \"M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 123.43799591064453\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 60.90599822998047\n\t    }\n\t  },\n\t  \"PunctumCuadratum\": {\n\t    \"svgSrc\": \"<path d=\\\"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 123.43799591064453\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 60.90599822998047\n\t    }\n\t  },\n\t  \"PunctumCuadratumAscLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 152.343994140625\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 88.34400177001953\n\t    }\n\t  },\n\t  \"PunctumCuadratumDesLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 151.56199645996094\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 75.56199645996094\n\t    }\n\t  },\n\t  \"PunctumInclinatum\": {\n\t    \"svgSrc\": \"<path d=\\\"M0-75.78L50 0 0 75-50 0 0-75.78z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M0-75.78L50 0 0 75-50 0 0-75.78z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 150.77999877929688\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 75.77999877929688\n\t    }\n\t  },\n\t  \"PunctumInclinatumLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 70,\n\t      \"height\": 105.546\n\t    },\n\t    \"origin\": {\n\t      \"x\": 35,\n\t      \"y\": 53.164062\n\t    }\n\t  },\n\t  \"Quilisma\": {\n\t    \"svgSrc\": \"<path d=\\\"M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 150\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 89.28199768066406\n\t    }\n\t  },\n\t  \"TerminatingAscLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 49.999000549316406,\n\t      \"height\": 121.87299346923828\n\t    },\n\t    \"origin\": {\n\t      \"x\": 49.999000549316406,\n\t      \"y\": 48.842994689941406\n\t    }\n\t  },\n\t  \"TerminatingDesLiquescent\": {\n\t    \"svgSrc\": \"<path d=\\\"M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 50,\n\t      \"height\": 122.65800476074219\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 80.97000122070312\n\t    }\n\t  },\n\t  \"VerticalEpisemaAbove\": {\n\t    \"svgSrc\": \"<path d=\\\"M-8-80H8L4 0h-8l-4-80z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-8-80H8L4 0h-8l-4-80z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 16,\n\t      \"height\": 80\n\t    },\n\t    \"origin\": {\n\t      \"x\": 8,\n\t      \"y\": 80\n\t    }\n\t  },\n\t  \"VerticalEpisemaBelow\": {\n\t    \"svgSrc\": \"<path d=\\\"M-8 80H8L4 0h-8l-4 80z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M-8 80H8L4 0h-8l-4 80z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 16,\n\t      \"height\": 80\n\t    },\n\t    \"origin\": {\n\t      \"x\": 8,\n\t      \"y\": 0\n\t    }\n\t  },\n\t  \"VirgaLong\": {\n\t    \"svgSrc\": \"<path d=\\\"M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 326.56201171875\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 66.90599822998047\n\t    }\n\t  },\n\t  \"VirgaShort\": {\n\t    \"svgSrc\": \"<path d=\\\"M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 100,\n\t      \"height\": 253.12600708007812\n\t    },\n\t    \"origin\": {\n\t      \"x\": 50,\n\t      \"y\": 66.90599822998047\n\t    }\n\t  },\n\t  \"Virgula\": {\n\t    \"svgSrc\": \"<path d=\\\"M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z\\\"/>\",\n\t    \"paths\": [{\n\t      \"type\": \"positive\",\n\t      \"data\": \"M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z\"\n\t    }],\n\t    \"bounds\": {\n\t      \"x\": 0,\n\t      \"y\": 0,\n\t      \"width\": 98.01399993896484,\n\t      \"height\": 175.2209930419922\n\t    },\n\t    \"origin\": {\n\t      \"x\": 1.0739939212799072,\n\t      \"y\": 88.86000061035156\n\t    }\n\t  }\n\t};\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.ChantNotationElement = exports.Annotation = exports.DropCap = exports.Lyric = exports.LyricType = exports.TextElement = exports.GlyphVisualizer = exports.HorizontalEpisemaVisualizer = exports.NeumeLineVisualizer = exports.DividerLineVisualizer = exports.ChantLayoutElement = exports.ChantContext = exports.QuickSvg = exports.GlyphCode = undefined;\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar _Exsurge2 = __webpack_require__(3);\n\t\n\tvar _Exsurge3 = __webpack_require__(2);\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t// load in the web font for special chant characters here:\n\tvar __exsurgeCharactersFont = __webpack_require__(5);\n\t\n\tvar GlyphCode = exports.GlyphCode = {\n\t\n\t  None: \"None\",\n\t\n\t  AcuteAccent: \"AcuteAccent\",\n\t  Stropha: \"Stropha\",\n\t  //  StrophaLiquescent: \"StrophaLiquescent\",\n\t\n\t  BeginningAscLiquescent: \"BeginningAscLiquescent\",\n\t  BeginningDesLiquescent: \"BeginningDesLiquescent\",\n\t\n\t  CustodDescLong: \"CustodDescLong\",\n\t  CustodDescShort: \"CustodDescShort\",\n\t  CustodLong: \"CustodLong\",\n\t  CustodShort: \"CustodShort\",\n\t\n\t  // clefs and other markings\n\t  DoClef: \"DoClef\",\n\t  FaClef: \"FaClef\",\n\t  Flat: \"Flat\",\n\t  Mora: \"Mora\",\n\t  Natural: \"Natural\",\n\t  OriscusAsc: \"OriscusAsc\",\n\t  OriscusDes: \"OriscusDes\",\n\t  OriscusLiquescent: \"OriscusLiquescent\",\n\t\n\t  PodatusLower: \"PodatusLower\",\n\t  PodatusUpper: \"PodatusUpper\",\n\t\n\t  Porrectus1: \"Porrectus1\", // 1 staff line difference,\n\t  Porrectus2: \"Porrectus2\", // 2 lines difference, etc...\n\t  Porrectus3: \"Porrectus3\",\n\t  Porrectus4: \"Porrectus4\",\n\t\n\t  PunctumCavum: \"PunctumCavum\",\n\t  PunctumCuadratum: \"PunctumCuadratum\",\n\t  PunctumCuadratumAscLiquescent: \"PunctumCuadratumAscLiquescent\",\n\t  PunctumCuadratumDesLiquescent: \"PunctumCuadratumDesLiquescent\",\n\t  PunctumInclinatum: \"PunctumInclinatum\",\n\t  PunctumInclinatumLiquescent: \"PunctumInclinatumLiquescent\",\n\t  Quilisma: \"Quilisma\",\n\t\n\t  TerminatingAscLiquescent: \"TerminatingAscLiquescent\",\n\t  TerminatingDesLiquescent: \"TerminatingDesLiquescent\",\n\t  VerticalEpisemaAbove: \"VerticalEpisemaAbove\",\n\t  VerticalEpisemaBelow: \"VerticalEpisemaBelow\",\n\t  VirgaLong: \"VirgaLong\",\n\t  VirgaShort: \"VirgaShort\",\n\t  Virgula: \"Virgula\"\n\t}; // GlyphCode\n\t\n\tvar QuickSvg = exports.QuickSvg = {\n\t\n\t  // namespaces \n\t  ns: 'http://www.w3.org/2000/svg',\n\t  xmlns: 'http://www.w3.org/2000/xmlns/',\n\t  xlink: 'http://www.w3.org/1999/xlink',\n\t\n\t  // create the root level svg object\n\t  svg: function svg(width, height) {\n\t    var node = document.createElementNS(this.ns, 'svg');\n\t\n\t    node.setAttribute('xmlns', this.ns);\n\t    node.setAttribute('version', '1.1');\n\t    node.setAttributeNS(this.xmlns, 'xmlns:xlink', this.xlink);\n\t\n\t    node.setAttribute('width', width);\n\t    node.setAttribute('height', height);\n\t\n\t    // create the defs element\n\t    var defs = document.createElementNS(this.ns, 'defs');\n\t    node.appendChild(defs);\n\t\n\t    node.defs = defs;\n\t\n\t    node.clearNotations = function () {\n\t      // clear out all children except defs\n\t      node.removeChild(defs);\n\t\n\t      while (node.hasChildNodes()) {\n\t        node.removeChild(node.lastChild);\n\t      }node.appendChild(defs);\n\t    };\n\t\n\t    return node;\n\t  },\n\t\n\t  defs: function defs() {\n\t    return node;\n\t  },\n\t\n\t  rect: function rect(width, height) {\n\t    var node = document.createElementNS(this.ns, 'rect');\n\t\n\t    node.setAttribute('width', width);\n\t    node.setAttribute('height', height);\n\t\n\t    return node;\n\t  },\n\t\n\t  line: function line(x1, y1, x2, y2) {\n\t    var node = document.createElementNS(this.ns, 'line');\n\t\n\t    node.setAttribute('x1', x1);\n\t    node.setAttribute('y1', y1);\n\t    node.setAttribute('x2', x2);\n\t    node.setAttribute('y2', y2);\n\t\n\t    return node;\n\t  },\n\t\n\t  g: function g() {\n\t    var node = document.createElementNS(this.ns, 'g');\n\t\n\t    return node;\n\t  },\n\t\n\t  text: function text() {\n\t    var node = document.createElementNS(this.ns, 'text');\n\t\n\t    return node;\n\t  },\n\t\n\t  tspan: function tspan(str) {\n\t    var node = document.createElementNS(this.ns, 'tspan');\n\t    node.textContent = str;\n\t\n\t    return node;\n\t  },\n\t\n\t  // nodeRef should be the id of the object in defs (without the #)\n\t  use: function use(nodeRef) {\n\t    var node = document.createElementNS(this.ns, 'use');\n\t    node.setAttributeNS(this.xlink, \"xlink:href\", '#' + nodeRef);\n\t\n\t    return node;\n\t  },\n\t\n\t  createFragment: function createFragment(name, attributes, child) {\n\t    if (child === undefined || child === null) child = '';\n\t\n\t    var fragment = '<' + name + ' ';\n\t\n\t    for (var attr in attributes) {\n\t      if (attributes.hasOwnProperty(attr)) fragment += attr + '=\"' + attributes[attr] + '\" ';\n\t    }\n\t\n\t    fragment += '>' + child + '</' + name + '>';\n\t\n\t    return fragment;\n\t  },\n\t\n\t  parseFragment: function parseFragment(fragment) {\n\t\n\t    // create temporary holder\n\t    var well = document.createElement('svg');\n\t\n\t    // act as a setter if svg is given\n\t    if (fragment) {\n\t\n\t      var container = this.g();\n\t\n\t      // dump raw svg\n\t      // do this to allow the browser to automatically create svg nodes?\n\t      well.innerHTML = '<svg>' + fragment.replace(/\\n/, '').replace(/<(\\w+)([^<]+?)\\/>/g, '<$1$2></$1>') + '</svg>';\n\t\n\t      // transplant nodes\n\t      for (var i = 0, il = well.firstChild.childNodes.length; i < il; i++) {\n\t        container.appendChild(well.firstChild.firstChild);\n\t      }return container;\n\t    }\n\t  },\n\t\n\t  translate: function translate(node, x, y) {\n\t    node.setAttribute('transform', 'translate(' + x + ',' + y + ')');\n\t    return node;\n\t  },\n\t\n\t  scale: function scale(node, sx, sy) {\n\t    node.setAttribute('transform', 'scale(' + sx + ',' + sy + ')');\n\t    return node;\n\t  }\n\t};\n\t\n\t/*\r\n\t * ChantContext\r\n\t */\n\t\n\tvar ChantContext = exports.ChantContext = function () {\n\t  function ChantContext() {\n\t    _classCallCheck(this, ChantContext);\n\t\n\t    this.defs = {};\n\t\n\t    // font styles\n\t    this.lyricTextSize = 16; // in points?\n\t    this.lyricTextFont = \"'Palatino Linotype', 'Book Antiqua', Palatino, serif\";\n\t    this.lyricTextColor = \"#000\";\n\t\n\t    this.dropCapTextSize = 64;\n\t    this.dropCapTextFont = this.lyricTextFont;\n\t    this.dropCapTextColor = this.lyricTextColor;\n\t\n\t    this.annotationTextSize = 13;\n\t    this.annotationTextFont = this.lyricTextFont;\n\t    this.annotationTextColor = this.lyricTextColor;\n\t\n\t    // everything depends on the scale of the punctum\n\t    this.glyphPunctumWidth = _Exsurge2.Glyphs.PunctumCuadratum.bounds.width;\n\t    this.glyphPunctumHeight = _Exsurge2.Glyphs.PunctumCuadratum.bounds.height;\n\t\n\t    // fixme: for now, we just set these using the glyph scales as noted above, presuming a\n\t    // staff line size of 0.5 in. Really what we should do is scale the punctum size based\n\t    // on the text metrics, right? 1 punctum ~ x height size?\n\t    this.glyphScaling = 1.0 / 16.0;\n\t\n\t    this.staffInterval = this.glyphPunctumWidth * this.glyphScaling;\n\t    this.staffLineWeight = this.glyphPunctumWidth * this.glyphScaling / 8;\n\t    this.neumeLineWeight = this.glyphPunctumWidth * this.glyphScaling / 8; // the weight of connecting lines in the glyphs.\n\t    this.dividerLineWeight = this.neumeLineWeight; // of quarter bar, half bar, etc.\n\t    this.episemaLineWeight = this.neumeLineWeight; // of horizontal episemae\n\t\n\t    // for keeping track of the clef\n\t    this.activeClef = null;\n\t\n\t    this.staffLineColor = \"#000\";\n\t    this.dividerLineColor = \"#000\";\n\t\n\t    this.defaultLanguage = new _Exsurge3.Latin();\n\t\n\t    this.svgTextMeasurer = QuickSvg.svg(1, 1);\n\t    this.svgTextMeasurer.setAttribute('id', \"TextMeasurer\");\n\t    document.querySelector('body').appendChild(this.svgTextMeasurer);\n\t\n\t    // measure the size of a hyphen for the lyrics\n\t    var hyphen = new Lyric(this, \"-\", LyricType.SingleSyllable);\n\t    this.hyphenWidth = hyphen.bounds.width;\n\t\n\t    this.minLyricWordSpacing = this.hyphenWidth;\n\t\n\t    this.intraNeumeSpacing = this.staffInterval / 2.0;\n\t\n\t    // for connecting neume syllables...\n\t    this.syllableConnector = '-';\n\t\n\t    this.drawGuides = false;\n\t    this.drawDebuggingBounds = true;\n\t\n\t    // chant notation elements are normally separated by a minimum fixed amount of space\n\t    // on the staff line. It can happen, however, that two text elements are almost close\n\t    // enough to merge, only to be separated much more by the required hyphen (or other\n\t    // connecting string).\n\t    //\n\t    // This tolerance value allows a little bit of flexibility to merge two close lyrical\n\t    // elements, thus bringing the chant notation elements a bit closer than otherwise\n\t    // would be normally allowed.\n\t    //\n\t    // condensing tolerance is a percentage value (0.0-1.0, inclusive) that indicates\n\t    // how much the default spacing can shrink. E.g., a value of 0.80 allows the layout\n\t    // engine to separate two glyphs by only 80% of the normal inter-neume spacing value.\n\t    //\n\t    // fixme: condensing tolerance is not implemented yet!\n\t    this.condensingTolerance = 0.9;\n\t\n\t    // if auto color is true, then exsurge tries to automatically colorize\n\t    // some elements of the chant (directives become rubric color, etc.)\n\t    this.autoColor = true;\n\t\n\t    this.insertFontsInDoc();\n\t  }\n\t\n\t  _createClass(ChantContext, [{\n\t    key: 'calculateHeightFromStaffPosition',\n\t    value: function calculateHeightFromStaffPosition(staffPosition) {\n\t      return -staffPosition * this.staffInterval;\n\t    }\n\t  }, {\n\t    key: 'insertFontsInDoc',\n\t    value: function insertFontsInDoc() {\n\t\n\t      var styleElement = document.getElementById('exsurge-fonts');\n\t\n\t      if (styleElement === null) {\n\t        // create it since it doesn't exist yet.\n\t        styleElement = document.createElement('style');\n\t        styleElement.id = 'exsurge-fonts';\n\t\n\t        styleElement.appendChild(document.createTextNode(\"@font-face{font-family: 'Exsurge Characters';font-weight: normal;font-style: normal;src: url(\" + __exsurgeCharactersFont + \") format('opentype');}\"));\n\t\n\t        document.head.appendChild(styleElement);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return ChantContext;\n\t}();\n\t\n\t/*\r\n\t * ChantLayoutElement\r\n\t */\n\t\n\t\n\tvar ChantLayoutElement = exports.ChantLayoutElement = function () {\n\t  function ChantLayoutElement() {\n\t    _classCallCheck(this, ChantLayoutElement);\n\t\n\t    this.bounds = new _Exsurge.Rect();\n\t    this.origin = new _Exsurge.Point(0, 0);\n\t\n\t    this.selected = false;\n\t    this.highlighted = false;\n\t  }\n\t\n\t  // draws the element an html5 canvas\n\t\n\t\n\t  _createClass(ChantLayoutElement, [{\n\t    key: 'draw',\n\t    value: function draw(ctxt) {}\n\t\n\t    // returns svg code for the element, used for printing support\n\t\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t      throw \"ChantLayout Elements must implement createDrawable(ctxt)\";\n\t    }\n\t  }]);\n\t\n\t  return ChantLayoutElement;\n\t}();\n\t\n\tvar DividerLineVisualizer = exports.DividerLineVisualizer = function (_ChantLayoutElement) {\n\t  _inherits(DividerLineVisualizer, _ChantLayoutElement);\n\t\n\t  function DividerLineVisualizer(ctxt, staffPosition0, staffPosition1) {\n\t    _classCallCheck(this, DividerLineVisualizer);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(DividerLineVisualizer).call(this));\n\t\n\t    var y0 = ctxt.calculateHeightFromStaffPosition(staffPosition0);\n\t    var y1 = ctxt.calculateHeightFromStaffPosition(staffPosition1);\n\t\n\t    if (y0 > y1) {\n\t      var temp = y0;\n\t      y0 = y1;\n\t      y1 = temp;\n\t    }\n\t\n\t    _this.bounds.x = 0;\n\t    _this.bounds.y = y0;\n\t    _this.bounds.width = ctxt.dividerLineWeight;\n\t    _this.bounds.height = y1 - y0;\n\t\n\t    _this.origin.x = _this.bounds.width / 2;\n\t    _this.origin.y = y0;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(DividerLineVisualizer, [{\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      return QuickSvg.createFragment('rect', {\n\t        'x': this.bounds.x,\n\t        'y': this.bounds.y,\n\t        'width': ctxt.dividerLineWeight,\n\t        'height': this.bounds.height,\n\t        'fill': ctxt.dividerLineColor,\n\t        'class': 'dividerLine'\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return DividerLineVisualizer;\n\t}(ChantLayoutElement);\n\t\n\tvar NeumeLineVisualizer = exports.NeumeLineVisualizer = function (_ChantLayoutElement2) {\n\t  _inherits(NeumeLineVisualizer, _ChantLayoutElement2);\n\t\n\t  function NeumeLineVisualizer(ctxt, note0, note1, hanging) {\n\t    _classCallCheck(this, NeumeLineVisualizer);\n\t\n\t    var _this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(NeumeLineVisualizer).call(this));\n\t\n\t    var y0 = ctxt.calculateHeightFromStaffPosition(note0.staffPosition);\n\t    var y1 = ctxt.calculateHeightFromStaffPosition(note1.staffPosition);\n\t\n\t    if (y0 > y1) {\n\t      var temp = y0;\n\t      y0 = y1;\n\t      y1 = temp;\n\t    }\n\t\n\t    if (hanging) y1 += ctxt.glyphPunctumHeight * ctxt.glyphScaling / 2.2;\n\t\n\t    _this2.bounds.x = 0;\n\t    _this2.bounds.y = y0;\n\t    _this2.bounds.width = ctxt.neumeLineWeight;\n\t    _this2.bounds.height = y1 - y0;\n\t\n\t    _this2.origin.x = 0;\n\t    _this2.origin.y = 0;\n\t    return _this2;\n\t  }\n\t\n\t  _createClass(NeumeLineVisualizer, [{\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      return QuickSvg.createFragment('rect', {\n\t        'x': this.bounds.x,\n\t        'y': this.bounds.y,\n\t        'width': ctxt.neumeLineWeight,\n\t        'height': this.bounds.height,\n\t        'fill': ctxt.neumeLineColor,\n\t        'class': 'neumeLine'\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return NeumeLineVisualizer;\n\t}(ChantLayoutElement);\n\t\n\tvar HorizontalEpisemaVisualizer = exports.HorizontalEpisemaVisualizer = function (_ChantLayoutElement3) {\n\t  _inherits(HorizontalEpisemaVisualizer, _ChantLayoutElement3);\n\t\n\t  function HorizontalEpisemaVisualizer(ctxt, x, y, width) {\n\t    _classCallCheck(this, HorizontalEpisemaVisualizer);\n\t\n\t    var _this3 = _possibleConstructorReturn(this, Object.getPrototypeOf(HorizontalEpisemaVisualizer).call(this));\n\t\n\t    _this3.bounds.x = x;\n\t    _this3.bounds.y = y;\n\t    _this3.bounds.width = width;\n\t    _this3.bounds.height = ctxt.episemaLineWeight;\n\t\n\t    _this3.origin.x = 0;\n\t    _this3.origin.y = 0;\n\t    return _this3;\n\t  }\n\t\n\t  _createClass(HorizontalEpisemaVisualizer, [{\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      return QuickSvg.createFragment('rect', {\n\t        'x': this.bounds.x,\n\t        'y': this.bounds.y,\n\t        'width': this.bounds.width,\n\t        'height': this.bounds.height,\n\t        'fill': ctxt.neumeLineColor,\n\t        'class': 'horizontalEpisema'\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return HorizontalEpisemaVisualizer;\n\t}(ChantLayoutElement);\n\t\n\tvar GlyphVisualizer = exports.GlyphVisualizer = function (_ChantLayoutElement4) {\n\t  _inherits(GlyphVisualizer, _ChantLayoutElement4);\n\t\n\t  function GlyphVisualizer(ctxt, glyphCode) {\n\t    _classCallCheck(this, GlyphVisualizer);\n\t\n\t    var _this4 = _possibleConstructorReturn(this, Object.getPrototypeOf(GlyphVisualizer).call(this));\n\t\n\t    _this4.glyph = null;\n\t\n\t    _this4.setGlyph(ctxt, glyphCode);\n\t    return _this4;\n\t  }\n\t\n\t  _createClass(GlyphVisualizer, [{\n\t    key: 'setGlyph',\n\t    value: function setGlyph(ctxt, glyphCode) {\n\t\n\t      if (this.glyphCode === glyphCode) return;\n\t\n\t      if (typeof glyphCode === 'undefined' || glyphCode === null || glyphCode === \"\") this.glyphCode = GlyphCode.None;else this.glyphCode = glyphCode;\n\t\n\t      this.glyph = _Exsurge2.Glyphs[this.glyphCode];\n\t\n\t      // if this glyph hasn't been used yet, then load it up in the defs section for sharing\n\t      if (!ctxt.defs.hasOwnProperty(this.glyphCode)) {\n\t        var glyphSrc = this.glyph.svgSrc;\n\t\n\t        // create the ref\n\t        ctxt.defs[this.glyphCode] = QuickSvg.createFragment('g', {\n\t          id: this.glyphCode,\n\t          'class': 'glyph',\n\t          transform: 'scale(' + ctxt.glyphScaling + ')'\n\t        }, glyphSrc);\n\t      }\n\t\n\t      this.origin.x = this.glyph.origin.x * ctxt.glyphScaling;\n\t      this.origin.y = this.glyph.origin.y * ctxt.glyphScaling;\n\t\n\t      this.bounds.x = 0;\n\t      this.bounds.y = -this.origin.y;\n\t      this.bounds.width = this.glyph.bounds.width * ctxt.glyphScaling;\n\t      this.bounds.height = this.glyph.bounds.height * ctxt.glyphScaling;\n\t    }\n\t  }, {\n\t    key: 'setStaffPosition',\n\t    value: function setStaffPosition(ctxt, staffPosition) {\n\t      this.bounds.y += ctxt.calculateHeightFromStaffPosition(staffPosition);\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      return QuickSvg.createFragment('use', {\n\t        'xlink:href': '#' + this.glyphCode,\n\t        x: this.bounds.x + this.origin.x,\n\t        y: this.bounds.y + this.origin.y\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return GlyphVisualizer;\n\t}(ChantLayoutElement);\n\t\n\tvar TextSpan = function TextSpan(text, properties) {\n\t  if (typeof properties === 'undefined' || properties === null) properties = \"\";\n\t\n\t  this.text = text;\n\t  this.properties = properties;\n\t};\n\t\n\tvar boldMarkup = \"*\";\n\tvar italicMarkup = \"_\";\n\tvar redMarkup = \"^\";\n\tvar smallCapsMarkup = \"%\";\n\t\n\tfunction MarkupStackFrame(symbol, startIndex, properties) {\n\t  this.symbol = symbol;\n\t  this.startIndex = startIndex;\n\t  this.properties = properties;\n\t}\n\t\n\tMarkupStackFrame.createStackFrame = function (symbol, startIndex) {\n\t\n\t  var properties = \"\";\n\t\n\t  switch (symbol) {\n\t    case boldMarkup:\n\t      properties = 'font-weight:bold;';\n\t      break;\n\t    case italicMarkup:\n\t      properties = 'font-style:italic;';\n\t      break;\n\t    case redMarkup:\n\t      properties = 'fill:#f00;'; // SVG text color is set by the fill property\n\t      break;\n\t    case smallCapsMarkup:\n\t      properties = \"font-variant:small-caps;font-feature-settings:'smcp';-webkit-font-feature-settings:'smcp';\";\n\t      break;\n\t  }\n\t\n\t  return new MarkupStackFrame(symbol, startIndex, properties);\n\t};\n\t\n\t// for escaping html strings before they go into the svgs\n\t// adapted from http://stackoverflow.com/a/12034334/5720160\n\tvar __subsForTspans = {\n\t  \"&\": \"&amp;\",\n\t  \"<\": \"&lt;\",\n\t  \">\": \"&gt;\"\n\t};\n\t\n\tvar TextElement = exports.TextElement = function (_ChantLayoutElement5) {\n\t  _inherits(TextElement, _ChantLayoutElement5);\n\t\n\t  function TextElement(ctxt, text, fontFamily, fontSize, textAnchor) {\n\t    _classCallCheck(this, TextElement);\n\t\n\t    // set these to some sane values for now...\n\t\n\t    var _this5 = _possibleConstructorReturn(this, Object.getPrototypeOf(TextElement).call(this));\n\t\n\t    _this5.bounds.x = 0;\n\t    _this5.bounds.y = 0;\n\t    _this5.bounds.width = 0;\n\t    _this5.bounds.height = 0;\n\t    _this5.origin.x = 0;\n\t    _this5.origin.y = 0;\n\t\n\t    _this5.fontFamily = fontFamily;\n\t    _this5.fontSize = fontSize;\n\t    _this5.textAnchor = textAnchor;\n\t    _this5.dominantBaseline = 'baseline'; // default placement\n\t\n\t    _this5.generateSpansFromText(ctxt, text);\n\t\n\t    _this5.recalculateMetrics(ctxt);\n\t    return _this5;\n\t  }\n\t\n\t  _createClass(TextElement, [{\n\t    key: 'generateSpansFromText',\n\t    value: function generateSpansFromText(ctxt, text) {\n\t\n\t      this.unsanitizedText = text;\n\t      this.text = \"\";\n\t      this.spans = [];\n\t\n\t      // save ourselves a lot of grief for a very common text:\n\t      if (text === \"*\" || text === \"\") {\n\t        this.spans.push(new TextSpan(text, \"\"));\n\t        return;\n\t      }\n\t\n\t      var markupStack = [];\n\t      var spanStartIndex = 0;\n\t\n\t      var filterFrames = function filterFrames(frame, symbol) {\n\t        return frame.Symbol === symbol;\n\t      };\n\t\n\t      var that = this;\n\t      var closeSpan = function closeSpan(spanText, extraProperties) {\n\t        if (spanText === \"\") return;\n\t\n\t        that.text += spanText;\n\t\n\t        var properties = \"\";\n\t        for (var i = 0; i < markupStack.length; i++) {\n\t          properties += markupStack[i].properties;\n\t        }if (extraProperties) properties = properties + extraProperties;\n\t\n\t        that.spans.push(new TextSpan(spanText, properties));\n\t      };\n\t\n\t      var markupRegex = /(\\*|_|\\^|%|[ARVarv]\\/\\.)/g;\n\t\n\t      var match = null;\n\t      while (match = markupRegex.exec(text)) {\n\t\n\t        var markupSymbol = match[0];\n\t\n\t        // non-matching symbols first\n\t        if (markupSymbol === \"A/.\" || markupSymbol === \"R/.\" || markupSymbol === \"V/.\" || markupSymbol === \"a/.\" || markupSymbol === \"r/.\" || markupSymbol === \"v/.\") {\n\t          closeSpan(text[match.index] + \".\", \"font-family:'Exsurge Characters';fill:#f00;\");\n\t        } else if (markupStack.length === 0) {\n\t          // otherwise we're dealing with matching markup delimeters\n\t          // if this is our first markup frame, then just create an inline for preceding text and push the stack frame\n\t          closeSpan(text.substring(spanStartIndex, match.index));\n\t          markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol, match.index));\n\t        } else {\n\t\n\t          if (markupStack[markupStack.length - 1].symbol === markupSymbol) {\n\t            // group close\n\t            closeSpan(text.substring(spanStartIndex, match.index));\n\t            markupStack.pop();\n\t          } else if (markupStack.filter(filterFrames).length > 0) {\n\t            // trying to open a recursive group (or forgot to close a previous group)\n\t            // in either case, we just unwind to the previous stack frame\n\t            spanStartIndex = markupStack[markupStack.length - 1].startIndex;\n\t            markupStack.pop();\n\t            continue;\n\t          } else {\n\t            // group open\n\t            closeSpan(text.substring(spanStartIndex, match.index));\n\t            markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol, match.index));\n\t          }\n\t        }\n\t\n\t        // advance the start index past the current markup\n\t        spanStartIndex = match.index + markupSymbol.length;\n\t      }\n\t\n\t      // if we finished matches, and there is still some text left, create one final run\n\t      if (spanStartIndex < text.length) closeSpan(text.substring(spanStartIndex, text.length));\n\t\n\t      // if after all of that we still didn't create any runs, then just add the entire text\n\t      // string itself as a run\n\t      if (this.spans.length === 0) closeSpan(text);\n\t    }\n\t  }, {\n\t    key: 'recalculateMetrics',\n\t    value: function recalculateMetrics(ctxt) {\n\t\n\t      this.bounds.x = 0;\n\t      this.bounds.y = 0;\n\t\n\t      var xml = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + this.createDrawable(ctxt) + '</svg>';\n\t      var doc = new DOMParser().parseFromString(xml, 'application/xml');\n\t      while (ctxt.svgTextMeasurer.firstChild) {\n\t        ctxt.svgTextMeasurer.firstChild.remove();\n\t      }\n\t      ctxt.svgTextMeasurer.appendChild(ctxt.svgTextMeasurer.ownerDocument.importNode(doc.documentElement, true).firstChild);\n\t\n\t      var bbox = ctxt.svgTextMeasurer.firstChild.getBBox();\n\t\n\t      this.bounds.x = 0;\n\t      this.bounds.y = 0;\n\t      this.bounds.width = bbox.width;\n\t      this.bounds.height = bbox.height;\n\t      this.origin.x = 0;\n\t      this.origin.y = 0; // baseline?\n\t    }\n\t  }, {\n\t    key: 'getCssClasses',\n\t    value: function getCssClasses() {\n\t      return \"\";\n\t    }\n\t  }, {\n\t    key: 'getExtraStyleProperties',\n\t    value: function getExtraStyleProperties(ctxt) {\n\t      return \"\";\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      var spans = \"\";\n\t\n\t      for (var i = 0; i < this.spans.length; i++) {\n\t        var options = {};\n\t\n\t        if (this.spans[i].properties) options['style'] = this.spans[i].properties;\n\t\n\t        spans += QuickSvg.createFragment('tspan', options, TextElement.escapeForTspan(this.spans[i].text));\n\t      }\n\t\n\t      var styleProperties = \"font-family:\" + this.fontFamily + \";font-size:\" + this.fontSize + \"px\" + \";font-kerning:normal;\" + this.getExtraStyleProperties(ctxt);\n\t\n\t      return QuickSvg.createFragment('text', {\n\t        'x': this.bounds.x,\n\t        'y': this.bounds.y,\n\t        'class': this.getCssClasses().trim(),\n\t        'text-anchor': this.textAnchor,\n\t        'dominant-baseline': this.dominantBaseline,\n\t        'style': styleProperties\n\t      }, spans);\n\t    }\n\t  }], [{\n\t    key: 'escapeForTspan',\n\t    value: function escapeForTspan(string) {\n\t      return String(string).replace(/[&<>]/g, function (s) {\n\t        return __subsForTspans[s];\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return TextElement;\n\t}(ChantLayoutElement);\n\t\n\tvar LyricType = exports.LyricType = {\n\t  SingleSyllable: 0,\n\t  BeginningSyllable: 1,\n\t  MiddleSyllable: 2,\n\t  EndingSyllable: 3,\n\t\n\t  Directive: 4 // for asterisks, \"ij.\" elements, or other performance notes.\n\t};\n\t\n\tvar Lyric = exports.Lyric = function (_TextElement) {\n\t  _inherits(Lyric, _TextElement);\n\t\n\t  function Lyric(ctxt, text, lyricType) {\n\t    _classCallCheck(this, Lyric);\n\t\n\t    var _this6 = _possibleConstructorReturn(this, Object.getPrototypeOf(Lyric).call(this, ctxt, text, ctxt.lyricTextFont, ctxt.lyricTextSize, 'start'));\n\t\n\t    _this6.cssClasses += \" Lyric\";\n\t\n\t    if (typeof lyricType === 'undefined' || lyricType === null || lyricType === \"\") _this6.lyricType = LyricType.SingleSyllable;else _this6.lyricType = lyricType;\n\t\n\t    _this6.needsConnector = false;\n\t    return _this6;\n\t  }\n\t\n\t  _createClass(Lyric, [{\n\t    key: 'allowsConnector',\n\t    value: function allowsConnector() {\n\t      return this.lyricType === LyricType.BeginningSyllable || this.lyricType === LyricType.MiddleSyllable;\n\t    }\n\t  }, {\n\t    key: 'setNeedsConnector',\n\t    value: function setNeedsConnector(needs) {\n\t      if (needs === true) {\n\t        this.needsConnector = true;\n\t        this.bounds.width = this.widthWithConnector;\n\t\n\t        if (this.spans.length > 0) this.spans[this.spans.length - 1].text = this.lastSpanTextWithConnector;\n\t      } else {\n\t        this.needsConnector = false;\n\t        this.bounds.width = this.widthWithoutConnector;\n\t\n\t        if (this.spans.length > 0) this.spans[this.spans.length - 1].text = this.lastSpanText;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'generateSpansFromText',\n\t    value: function generateSpansFromText(ctxt, text) {\n\t      _get(Object.getPrototypeOf(Lyric.prototype), 'generateSpansFromText', this).call(this, ctxt, text);\n\t\n\t      if (this.spans.length > 0) {\n\t        this.lastSpanText = this.spans[this.spans.length - 1].text;\n\t        this.lastSpanTextWithConnector = this.lastSpanText + ctxt.syllableConnector;\n\t      } else {\n\t        this.lastSpanText = \"\";\n\t        this.lastSpanTextWithConnector = \"\";\n\t      }\n\t    }\n\t  }, {\n\t    key: 'recalculateMetrics',\n\t    value: function recalculateMetrics(ctxt) {\n\t      _get(Object.getPrototypeOf(Lyric.prototype), 'recalculateMetrics', this).call(this, ctxt);\n\t\n\t      this.widthWithoutConnector = this.bounds.width;\n\t      this.textWithConnector = this.text + ctxt.syllableConnector;\n\t\n\t      this.widthWithConnector = this.bounds.width + ctxt.hyphenWidth;\n\t\n\t      var activeLanguage = ctxt.defaultLanguage;\n\t\n\t      // calculate the point where the text lines up to the staff notation\n\t      // and offset the rect that much\n\t      var offset = 0;\n\t\n\t      if (this.lyricType !== LyricType.Directive) {\n\t\n\t        // Non-directive elements are lined up to the chant notation based on vowel segments.\n\t        // First we determine the vowel segment of the text, then we calculate the center point\n\t        // of that vowel segment.\n\t        var result = activeLanguage.findVowelSegment(this.text, 0);\n\t        if (result.found === true) {\n\t\n\t          // svgTextMeasurer still has the current lyric in it...\n\t\n\t          var x1 = ctxt.svgTextMeasurer.firstChild.getSubStringLength(0, result.startIndex);\n\t          var x2 = ctxt.svgTextMeasurer.firstChild.getSubStringLength(0, result.startIndex + result.length);\n\t\n\t          offset = x1 + (x2 - x1) / 2;\n\t        } else {\n\t          // no vowels found according the text's language. for now we just center the text\n\t          offset = this.widthWithoutConnector / 2;\n\t        }\n\t      } else {\n\t        // directives are always centered on the chant notation\n\t        offset = this.widthWithoutConnector / 2;\n\t      }\n\t\n\t      this.bounds.x = -offset;\n\t      this.bounds.y = 0;\n\t\n\t      this.origin.x = offset;\n\t\n\t      this.bounds.width = this.widthWithoutConnector;\n\t      this.bounds.height = ctxt.lyricTextSize;\n\t    }\n\t  }, {\n\t    key: 'getCssClasses',\n\t    value: function getCssClasses() {\n\t\n\t      var classes = \"lyric \";\n\t\n\t      if (this.lyricType === LyricType.Directive) classes += \"directive \";\n\t\n\t      return classes + _get(Object.getPrototypeOf(Lyric.prototype), 'getCssClasses', this).call(this);\n\t    }\n\t  }, {\n\t    key: 'getExtraStyleProperties',\n\t    value: function getExtraStyleProperties(ctxt) {\n\t      var props = _get(Object.getPrototypeOf(Lyric.prototype), 'getExtraStyleProperties', this).call(this);\n\t\n\t      if (this.lyricType === LyricType.Directive && ctxt.autoColor === true) props += \"fill:#f00;\";\n\t\n\t      return props;\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t      if (this.spans.length > 0) {\n\t        if (this.needsConnector) this.spans[this.spans.length - 1].text = this.lastSpanTextWithConnector;else this.spans[this.spans.length - 1].text = this.lastSpanText;\n\t      }\n\t\n\t      return _get(Object.getPrototypeOf(Lyric.prototype), 'createDrawable', this).call(this, ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Lyric;\n\t}(TextElement);\n\t\n\tvar DropCap = exports.DropCap = function (_TextElement2) {\n\t  _inherits(DropCap, _TextElement2);\n\t\n\t  /**\r\n\t   * @param {String} text\r\n\t   */\n\t\n\t  function DropCap(ctxt, text) {\n\t    _classCallCheck(this, DropCap);\n\t\n\t    var _this7 = _possibleConstructorReturn(this, Object.getPrototypeOf(DropCap).call(this, ctxt, text, ctxt.dropCapTextFont, ctxt.dropCapTextSize, 'middle'));\n\t\n\t    _this7.padding = ctxt.staffInterval * 2;\n\t    return _this7;\n\t  }\n\t\n\t  _createClass(DropCap, [{\n\t    key: 'getCssClasses',\n\t    value: function getCssClasses() {\n\t      return \"dropCap \" + _get(Object.getPrototypeOf(DropCap.prototype), 'getCssClasses', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return DropCap;\n\t}(TextElement);\n\t\n\tvar Annotation = exports.Annotation = function (_TextElement3) {\n\t  _inherits(Annotation, _TextElement3);\n\t\n\t  /**\r\n\t   * @param {String} text\r\n\t   */\n\t\n\t  function Annotation(ctxt, text) {\n\t    _classCallCheck(this, Annotation);\n\t\n\t    var _this8 = _possibleConstructorReturn(this, Object.getPrototypeOf(Annotation).call(this, ctxt, text, ctxt.annotationTextFont, ctxt.annotationTextSize, 'middle'));\n\t\n\t    _this8.padding = ctxt.staffInterval;\n\t    _this8.dominantBaseline = 'hanging'; // so that annotations can be aligned at the top.\n\t    return _this8;\n\t  }\n\t\n\t  _createClass(Annotation, [{\n\t    key: 'getCssClasses',\n\t    value: function getCssClasses() {\n\t      return \"annotation \" + _get(Object.getPrototypeOf(Annotation.prototype), 'getCssClasses', this).call(this);\n\t    }\n\t  }]);\n\t\n\t  return Annotation;\n\t}(TextElement);\n\t\n\tvar ChantNotationElement = exports.ChantNotationElement = function (_ChantLayoutElement6) {\n\t  _inherits(ChantNotationElement, _ChantLayoutElement6);\n\t\n\t  function ChantNotationElement() {\n\t    _classCallCheck(this, ChantNotationElement);\n\t\n\t    //double\n\t\n\t    var _this9 = _possibleConstructorReturn(this, Object.getPrototypeOf(ChantNotationElement).call(this));\n\t\n\t    _this9.leadingSpace = 0.0;\n\t    _this9.trailingSpace = -1; // if less than zero, this is automatically calculated at layout time\n\t    _this9.keepWithNext = false;\n\t\n\t    _this9.lyric = null;\n\t\n\t    _this9.score = null; // the ChantScore\n\t    _this9.line = null; // the ChantLine\n\t\n\t    _this9.visualizers = [];\n\t    return _this9;\n\t  }\n\t\n\t  _createClass(ChantNotationElement, [{\n\t    key: 'hasLyric',\n\t    value: function hasLyric() {\n\t      if (this.lyric !== null) return true;else return false;\n\t    }\n\t  }, {\n\t    key: 'getLyricLeft',\n\t    value: function getLyricLeft() {\n\t      return this.bounds.x + this.lyric.bounds.x;\n\t    }\n\t  }, {\n\t    key: 'getLyricRight',\n\t    value: function getLyricRight() {\n\t      return this.bounds.x + this.lyric.bounds.x + this.lyric.bounds.width;\n\t    }\n\t\n\t    // used by subclasses while building up the chant notations.\n\t\n\t  }, {\n\t    key: 'addVisualizer',\n\t    value: function addVisualizer(chantLayoutElement) {\n\t      if (this.bounds.isEmpty()) this.bounds = chantLayoutElement.bounds.clone();else this.bounds.union(chantLayoutElement.bounds);\n\t\n\t      this.visualizers.push(chantLayoutElement);\n\t    }\n\t\n\t    // same as addVisualizer, except the element is unshifted to the front\n\t    // of the visualizer array rather than the end. This way, some\n\t    // visualizers can be placed behind the others...ledge lines for example.\n\t\n\t  }, {\n\t    key: 'prependVisualizer',\n\t    value: function prependVisualizer(chantLayoutElement) {\n\t      if (this.bounds.isEmpty()) this.bounds = chantLayoutElement.bounds.clone();else this.bounds.union(chantLayoutElement.bounds);\n\t\n\t      this.visualizers.unshift(chantLayoutElement);\n\t    }\n\t\n\t    // chant notation elements are given an opportunity to perform their layout via this function.\n\t    // subclasses should call this function first in overrides of this function.\n\t    // on completion, exsurge presumes that the bounds, the origin, and the drawable objects are\n\t    // all valid and prepared for higher level layout.\n\t\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      if (this.trailingSpace < 0) this.trailingSpace = ctxt.intraNeumeSpacing * 4;\n\t\n\t      // reset the bounds and the staff notations before doing a layout\n\t      this.visualizers = [];\n\t      this.bounds = new _Exsurge.Rect(Infinity, Infinity, -Infinity, -Infinity);\n\t\n\t      if (this.hasLyric()) this.lyric.recalculateMetrics(ctxt);\n\t    }\n\t\n\t    // a helper function for subclasses to call after they are done performing layout...\n\t\n\t  }, {\n\t    key: 'finishLayout',\n\t    value: function finishLayout(ctxt) {\n\t      //this.origin.x -= -this.bounds.x;\n\t      this.bounds.x = 0;\n\t\n\t      // add the lyric and line it up\n\t      if (this.hasLyric()) this.lyric.bounds.x = this.origin.x - this.lyric.origin.x;\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t      var inner = \"\";\n\t\n\t      for (var i = 0; i < this.visualizers.length; i++) {\n\t        inner += this.visualizers[i].createDrawable(ctxt);\n\t      }if (this.lyric) inner += this.lyric.createDrawable(ctxt);\n\t\n\t      return QuickSvg.createFragment('g', {\n\t        'class': 'ChantNotationElement ' + this.constructor.name,\n\t        'transform': 'translate(' + this.bounds.x + ',' + 0 + ')'\n\t      }, inner);\n\t    }\n\t  }]);\n\t\n\t  return ChantNotationElement;\n\t}(ChantLayoutElement);\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"data:font/opentype;base64,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eHN1cmdlIENoYXJhY3RlcnM6VmVyc2lvbiAxLjAwVmVyc2lvbiAxLjAwIEZlYnJ1YXJ5IDE4LCAyMDE2LCBpbml0aWFsIHJlbGVhc2VFeHN1cmdlQ2hhcmFjdGVyc1RoaXMgRm9udCBTb2Z0d2FyZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgU0lMIE9wZW4gRm9udCBMaWNlbnNlLCBWZXJzaW9uIDEuMS4gVGhpcyBsaWNlbnNlIGlzIGNvcGllZCBiZWxvdywgYW5kIGlzIGFsc28gYXZhaWxhYmxlIHdpdGggYSBGQVEgYXQ6IGh0dHA6Ly9zY3JpcHRzLnNpbC5vcmcvT0ZMDQoNCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClNJTCBPUEVOIEZPTlQgTElDRU5TRSBWZXJzaW9uIDEuMSAtIDI2IEZlYnJ1YXJ5IDIwMDcNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNClBSRUFNQkxFDQpUaGUgZ29hbHMgb2YgdGhlIE9wZW4gRm9udCBMaWNlbnNlIChPRkwpIGFyZSB0byBzdGltdWxhdGUgd29ybGR3aWRlIGRldmVsb3BtZW50IG9mIGNvbGxhYm9yYXRpdmUgZm9udCBwcm9qZWN0cywgdG8gc3VwcG9ydCB0aGUgZm9udCBjcmVhdGlvbiBlZmZvcnRzIG9mIGFjYWRlbWljIGFuZCBsaW5ndWlzdGljIGNvbW11bml0aWVzLCBhbmQgdG8gcHJvdmlkZSBhIGZyZWUgYW5kIG9wZW4gZnJhbWV3b3JrIGluIHdoaWNoIGZvbnRzIG1heSBiZSBzaGFyZWQgYW5kIGltcHJvdmVkIGluIHBhcnRuZXJzaGlwIHdpdGggb3RoZXJzLg0KDQpUaGUgT0ZMIGFsbG93cyB0aGUgbGljZW5zZWQgZm9udHMgdG8gYmUgdXNlZCwgc3R1ZGllZCwgbW9kaWZpZWQgYW5kIHJlZGlzdHJpYnV0ZWQgZnJlZWx5IGFzIGxvbmcgYXMgdGhleSBhcmUgbm90IHNvbGQgYnkgdGhlbXNlbHZlcy4gVGhlIGZvbnRzLCBpbmNsdWRpbmcgYW55IGRlcml2YXRpdmUgd29ya3MsIGNhbiBiZSBidW5kbGVkLCBlbWJlZGRlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSBwcm92aWRlZCB0aGF0IGFueSByZXNlcnZlZCBuYW1lcyBhcmUgbm90IHVzZWQgYnkgZGVyaXZhdGl2ZSB3b3Jrcy4gVGhlIGZvbnRzIGFuZCBkZXJpdmF0aXZlcywgaG93ZXZlciwgY2Fubm90IGJlIHJlbGVhc2VkIHVuZGVyIGFueSBvdGhlciB0eXBlIG9mIGxpY2Vuc2UuIFRoZSByZXF1aXJlbWVudCBmb3IgZm9udHMgdG8gcmVtYWluIHVuZGVyIHRoaXMgbGljZW5zZSBkb2VzIG5vdCBhcHBseSB0byBhbnkgZG9jdW1lbnQgY3JlYXRlZCB1c2luZyB0aGUgZm9udHMgb3IgdGhlaXIgZGVyaXZhdGl2ZXMuDQoNCkRFRklOSVRJT05TDQoiRm9udCBTb2Z0d2FyZSIgcmVmZXJzIHRvIHRoZSBzZXQgb2YgZmlsZXMgcmVsZWFzZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykgdW5kZXIgdGhpcyBsaWNlbnNlIGFuZCBjbGVhcmx5IG1hcmtlZCBhcyBzdWNoLiBUaGlzIG1heSBpbmNsdWRlIHNvdXJjZSBmaWxlcywgYnVpbGQgc2NyaXB0cyBhbmQgZG9jdW1lbnRhdGlvbi4NCg0KIlJlc2VydmVkIEZvbnQgTmFtZSIgcmVmZXJzIHRvIGFueSBuYW1lcyBzcGVjaWZpZWQgYXMgc3VjaCBhZnRlciB0aGUgY29weXJpZ2h0IHN0YXRlbWVudChzKS4NCg0KIk9yaWdpbmFsIFZlcnNpb24iIHJlZmVycyB0byB0aGUgY29sbGVjdGlvbiBvZiBGb250IFNvZnR3YXJlIGNvbXBvbmVudHMgYXMgZGlzdHJpYnV0ZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykuDQoNCiJNb2RpZmllZCBWZXJzaW9uIiByZWZlcnMgdG8gYW55IGRlcml2YXRpdmUgbWFkZSBieSBhZGRpbmcgdG8sIGRlbGV0aW5nLCBvciBzdWJzdGl0dXRpbmcgLS0gaW4gcGFydCBvciBpbiB3aG9sZSAtLSBhbnkgb2YgdGhlIGNvbXBvbmVudHMgb2YgdGhlIE9yaWdpbmFsIFZlcnNpb24sIGJ5IGNoYW5naW5nIGZvcm1hdHMgb3IgYnkgcG9ydGluZyB0aGUgRm9udCBTb2Z0d2FyZSB0byBhIG5ldyBlbnZpcm9ubWVudC4NCg0KIkF1dGhvciIgcmVmZXJzIHRvIGFueSBkZXNpZ25lciwgZW5naW5lZXIsIHByb2dyYW1tZXIsIHRlY2huaWNhbCB3cml0ZXIgb3Igb3RoZXIgcGVyc29uIHdobyBjb250cmlidXRlZCB0byB0aGUgRm9udCBTb2Z0d2FyZS4NCg0KUEVSTUlTU0lPTiAmIENPTkRJVElPTlMNClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhlIEZvbnQgU29mdHdhcmUsIHRvIHVzZSwgc3R1ZHksIGNvcHksIG1lcmdlLCBlbWJlZCwgbW9kaWZ5LCByZWRpc3RyaWJ1dGUsIGFuZCBzZWxsIG1vZGlmaWVkIGFuZCB1bm1vZGlmaWVkIGNvcGllcyBvZiB0aGUgRm9udCBTb2Z0d2FyZSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6DQoNCjEpIE5laXRoZXIgdGhlIEZvbnQgU29mdHdhcmUgbm9yIGFueSBvZiBpdHMgaW5kaXZpZHVhbCBjb21wb25lbnRzLCBpbiBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucywgbWF5IGJlIHNvbGQgYnkgaXRzZWxmLg0KDQoyKSBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucyBvZiB0aGUgRm9udCBTb2Z0d2FyZSBtYXkgYmUgYnVuZGxlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSwgcHJvdmlkZWQgdGhhdCBlYWNoIGNvcHkgY29udGFpbnMgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgbGljZW5zZS4gVGhlc2UgY2FuIGJlIGluY2x1ZGVkIGVpdGhlciBhcyBzdGFuZC1hbG9uZSB0ZXh0IGZpbGVzLCBodW1hbi1yZWFkYWJsZSBoZWFkZXJzIG9yIGluIHRoZSBhcHByb3ByaWF0ZSBtYWNoaW5lLXJlYWRhYmxlIG1ldGFkYXRhIGZpZWxkcyB3aXRoaW4gdGV4dCBvciBiaW5hcnkgZmlsZXMgYXMgbG9uZyBhcyB0aG9zZSBmaWVsZHMgY2FuIGJlIGVhc2lseSB2aWV3ZWQgYnkgdGhlIHVzZXIuDQoNCjMpIE5vIE1vZGlmaWVkIFZlcnNpb24gb2YgdGhlIEZvbnQgU29mdHdhcmUgbWF5IHVzZSB0aGUgUmVzZXJ2ZWQgRm9udCBOYW1lKHMpIHVubGVzcyBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24gaXMgZ3JhbnRlZCBieSB0aGUgY29ycmVzcG9uZGluZyBDb3B5cmlnaHQgSG9sZGVyLiBUaGlzIHJlc3RyaWN0aW9uIG9ubHkgYXBwbGllcyB0byB0aGUgcHJpbWFyeSBmb250IG5hbWUgYXMgcHJlc2VudGVkIHRvIHRoZSB1c2Vycy4NCg0KNCkgVGhlIG5hbWUocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgb3IgdGhlIEF1dGhvcihzKSBvZiB0aGUgRm9udCBTb2Z0d2FyZSBzaGFsbCBub3QgYmUgdXNlZCB0byBwcm9tb3RlLCBlbmRvcnNlIG9yIGFkdmVydGlzZSBhbnkgTW9kaWZpZWQgVmVyc2lvbiwgZXhjZXB0IHRvIGFja25vd2xlZGdlIHRoZSBjb250cmlidXRpb24ocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgYW5kIHRoZSBBdXRob3Iocykgb3Igd2l0aCB0aGVpciBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24uDQoNCjUpIFRoZSBGb250IFNvZnR3YXJlLCBtb2RpZmllZCBvciB1bm1vZGlmaWVkLCBpbiBwYXJ0IG9yIGluIHdob2xlLCBtdXN0IGJlIGRpc3RyaWJ1dGVkIGVudGlyZWx5IHVuZGVyIHRoaXMgbGljZW5zZSwgYW5kIG11c3Qgbm90IGJlIGRpc3RyaWJ1dGVkIHVuZGVyIGFueSBvdGhlciBsaWNlbnNlLiBUaGUgcmVxdWlyZW1lbnQgZm9yIGZvbnRzIHRvIHJlbWFpbiB1bmRlciB0aGlzIGxpY2Vuc2UgZG9lcyBub3QgYXBwbHkgdG8gYW55IGRvY3VtZW50IGNyZWF0ZWQgdXNpbmcgdGhlIEZvbnQgU29mdHdhcmUuDQoNClRFUk1JTkFUSU9ODQpUaGlzIGxpY2Vuc2UgYmVjb21lcyBudWxsIGFuZCB2b2lkIGlmIGFueSBvZiB0aGUgYWJvdmUgY29uZGl0aW9ucyBhcmUgbm90IG1ldC4NCg0KRElTQ0xBSU1FUg0KVEhFIEZPTlQgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIEFOWSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVCBPRiBDT1BZUklHSFQsIFBBVEVOVCwgVFJBREVNQVJLLCBPUiBPVEhFUiBSSUdIVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBJTkNMVURJTkcgQU5ZIEdFTkVSQUwsIFNQRUNJQUwsIElORElSRUNULCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgVEhFIFVTRSBPUiBJTkFCSUxJVFkgVE8gVVNFIFRIRSBGT05UIFNPRlRXQVJFIE9SIEZST00gT1RIRVIgREVBTElOR1MgSU4gVEhFIEZPTlQgU09GVFdBUkUuAEMAbwBwAHkAcgBpAGcAaAB0ACAAKABjACkAIAAyADAAMQA2ACAARgByAC4AIABNAGEAdAB0AGgAZQB3ACAAUwBwAGUAbgBjAGUAcgAsACAATwAuAFMALgBKAC4AUgBlAGcAdQBsAGEAcgBFAHgAcwB1AHIAZwBlACAAQwBoAGEAcgBhAGMAdABlAHIAcwA6AFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwAFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwACAARgBlAGIAcgB1AGEAcgB5ACAAMQA4ACwAIAAyADAAMQA2ACwAIABpAG4AaQB0AGkAYQBsACAAcgBlAGwAZQBhAHMAZQBFAHgAcwB1AHIAZwBlAEMAaABhAHIAYQBjAHQAZQByAHMAVABoAGkAcwAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABpAHMAIABsAGkAYwBlAG4AcwBlAGQAIAB1AG4AZABlAHIAIAB0AGgAZQAgAFMASQBMACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACwAIABWAGUAcgBzAGkAbwBuACAAMQAuADEALgAgAFQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAaQBzACAAYwBvAHAAaQBlAGQAIABiAGUAbABvAHcALAAgAGEAbgBkACAAaQBzACAAYQBsAHMAbwAgAGEAdgBhAGkAbABhAGIAbABlACAAdwBpAHQAaAAgAGEAIABGAEEAUQAgAGEAdAA6ACAAaAB0AHQAcAA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAA0ACgANAAoADQAKAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQANAAoAUwBJAEwAIABPAFAARQBOACAARgBPAE4AVAAgAEwASQBDAEUATgBTAEUAIABWAGUAcgBzAGkAbwBuACAAMQAuADEAIAAtACAAMgA2ACAARgBlAGIAcgB1AGEAcgB5ACAAMgAwADAANwANAAoALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAA0ACgANAAoAUABSAEUAQQBNAEIATABFAA0ACgBUAGgAZQAgAGcAbwBhAGwAcwAgAG8AZgAgAHQAaABlACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACAAKABPAEYATAApACAAYQByAGUAIAB0AG8AIABzAHQAaQBtAHUAbABhAHQAZQAgAHcAbwByAGwAZAB3AGkAZABlACAAZABlAHYAZQBsAG8AcABtAGUAbgB0ACAAbwBmACAAYwBvAGwAbABhAGIAbwByAGEAdABpAHYAZQAgAGYAbwBuAHQAIABwAHIAbwBqAGUAYwB0AHMALAAgAHQAbwAgAHMAdQBwAHAAbwByAHQAIAB0AGgAZQAgAGYAbwBuAHQAIABjAHIAZQBhAHQAaQBvAG4AIABlAGYAZgBvAHIAdABzACAAbwBmACAAYQBjAGEAZABlAG0AaQBjACAAYQBuAGQAIABsAGkAbgBnAHUAaQBzAHQAaQBjACAAYwBvAG0AbQB1AG4AaQB0AGkAZQBzACwAIABhAG4AZAAgAHQAbwAgAHAAcgBvAHYAaQBkAGUAIABhACAAZgByAGUAZQAgAGEAbgBkACAAbwBwAGUAbgAgAGYAcgBhAG0AZQB3AG8AcgBrACAAaQBuACAAdwBoAGkAYwBoACAAZgBvAG4AdABzACAAbQBhAHkAIABiAGUAIABzAGgAYQByAGUAZAAgAGEAbgBkACAAaQBtAHAAcgBvAHYAZQBkACAAaQBuACAAcABhAHIAdABuAGUAcgBzAGgAaQBwACAAdwBpAHQAaAAgAG8AdABoAGUAcgBzAC4ADQAKAA0ACgBUAGgAZQAgAE8ARgBMACAAYQBsAGwAbwB3AHMAIAB0AGgAZQAgAGwAaQBjAGUAbgBzAGUAZAAgAGYAbwBuAHQAcwAgAHQAbwAgAGIAZQAgAHUAcwBlAGQALAAgAHMAdAB1AGQAaQBlAGQALAAgAG0AbwBkAGkAZgBpAGUAZAAgAGEAbgBkACAAcgBlAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGYAcgBlAGUAbAB5ACAAYQBzACAAbABvAG4AZwAgAGEAcwAgAHQAaABlAHkAIABhAHIAZQAgAG4AbwB0ACAAcwBvAGwAZAAgAGIAeQAgAHQAaABlAG0AcwBlAGwAdgBlAHMALgAgAFQAaABlACAAZgBvAG4AdABzACwAIABpAG4AYwBsAHUAZABpAG4AZwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAHcAbwByAGsAcwAsACAAYwBhAG4AIABiAGUAIABiAHUAbgBkAGwAZQBkACwAIABlAG0AYgBlAGQAZABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUAIABwAHIAbwB2AGkAZABlAGQAIAB0AGgAYQB0ACAAYQBuAHkAIAByAGUAcwBlAHIAdgBlAGQAIABuAGEAbQBlAHMAIABhAHIAZQAgAG4AbwB0ACAAdQBzAGUAZAAgAGIAeQAgAGQAZQByAGkAdgBhAHQAaQB2AGUAIAB3AG8AcgBrAHMALgAgAFQAaABlACAAZgBvAG4AdABzACAAYQBuAGQAIABkAGUAcgBpAHYAYQB0AGkAdgBlAHMALAAgAGgAbwB3AGUAdgBlAHIALAAgAGMAYQBuAG4AbwB0ACAAYgBlACAAcgBlAGwAZQBhAHMAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIAB0AHkAcABlACAAbwBmACAAbABpAGMAZQBuAHMAZQAuACAAVABoAGUAIAByAGUAcQB1AGkAcgBlAG0AZQBuAHQAIABmAG8AcgAgAGYAbwBuAHQAcwAgAHQAbwAgAHIAZQBtAGEAaQBuACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUAIABkAG8AZQBzACAAbgBvAHQAIABhAHAAcABsAHkAIAB0AG8AIABhAG4AeQAgAGQAbwBjAHUAbQBlAG4AdAAgAGMAcgBlAGEAdABlAGQAIAB1AHMAaQBuAGcAIAB0AGgAZQAgAGYAbwBuAHQAcwAgAG8AcgAgAHQAaABlAGkAcgAgAGQAZQByAGkAdgBhAHQAaQB2AGUAcwAuAA0ACgANAAoARABFAEYASQBOAEkAVABJAE8ATgBTAA0ACgAiAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAdABoAGUAIABzAGUAdAAgAG8AZgAgAGYAaQBsAGUAcwAgAHIAZQBsAGUAYQBzAGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAHUAbgBkAGUAcgAgAHQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAYQBuAGQAIABjAGwAZQBhAHIAbAB5ACAAbQBhAHIAawBlAGQAIABhAHMAIABzAHUAYwBoAC4AIABUAGgAaQBzACAAbQBhAHkAIABpAG4AYwBsAHUAZABlACAAcwBvAHUAcgBjAGUAIABmAGkAbABlAHMALAAgAGIAdQBpAGwAZAAgAHMAYwByAGkAcAB0AHMAIABhAG4AZAAgAGQAbwBjAHUAbQBlAG4AdABhAHQAaQBvAG4ALgANAAoADQAKACIAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABuAGEAbQBlAHMAIABzAHAAZQBjAGkAZgBpAGUAZAAgAGEAcwAgAHMAdQBjAGgAIABhAGYAdABlAHIAIAB0AGgAZQAgAGMAbwBwAHkAcgBpAGcAaAB0ACAAcwB0AGEAdABlAG0AZQBuAHQAKABzACkALgANAAoADQAKACIATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAiACAAcgBlAGYAZQByAHMAIAB0AG8AIAB0AGgAZQAgAGMAbwBsAGwAZQBjAHQAaQBvAG4AIABvAGYAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAGEAcwAgAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAuAA0ACgANAAoAIgBNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuACIAIAByAGUAZgBlAHIAcwAgAHQAbwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAG0AYQBkAGUAIABiAHkAIABhAGQAZABpAG4AZwAgAHQAbwAsACAAZABlAGwAZQB0AGkAbgBnACwAIABvAHIAIABzAHUAYgBzAHQAaQB0AHUAdABpAG4AZwAgAC0ALQAgAGkAbgAgAHAAYQByAHQAIABvAHIAIABpAG4AIAB3AGgAbwBsAGUAIAAtAC0AIABhAG4AeQAgAG8AZgAgAHQAaABlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAG8AZgAgAHQAaABlACAATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAsACAAYgB5ACAAYwBoAGEAbgBnAGkAbgBnACAAZgBvAHIAbQBhAHQAcwAgAG8AcgAgAGIAeQAgAHAAbwByAHQAaQBuAGcAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIAB0AG8AIABhACAAbgBlAHcAIABlAG4AdgBpAHIAbwBuAG0AZQBuAHQALgANAAoADQAKACIAQQB1AHQAaABvAHIAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABkAGUAcwBpAGcAbgBlAHIALAAgAGUAbgBnAGkAbgBlAGUAcgAsACAAcAByAG8AZwByAGEAbQBtAGUAcgAsACAAdABlAGMAaABuAGkAYwBhAGwAIAB3AHIAaQB0AGUAcgAgAG8AcgAgAG8AdABoAGUAcgAgAHAAZQByAHMAbwBuACAAdwBoAG8AIABjAG8AbgB0AHIAaQBiAHUAdABlAGQAIAB0AG8AIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALgANAAoADQAKAFAARQBSAE0ASQBTAFMASQBPAE4AIAAmACAAQwBPAE4ARABJAFQASQBPAE4AUwANAAoAUABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGgAZQByAGUAYgB5ACAAZwByAGEAbgB0AGUAZAAsACAAZgByAGUAZQAgAG8AZgAgAGMAaABhAHIAZwBlACwAIAB0AG8AIABhAG4AeQAgAHAAZQByAHMAbwBuACAAbwBiAHQAYQBpAG4AaQBuAGcAIABhACAAYwBvAHAAeQAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAsACAAdABvACAAdQBzAGUALAAgAHMAdAB1AGQAeQAsACAAYwBvAHAAeQAsACAAbQBlAHIAZwBlACwAIABlAG0AYgBlAGQALAAgAG0AbwBkAGkAZgB5ACwAIAByAGUAZABpAHMAdAByAGkAYgB1AHQAZQAsACAAYQBuAGQAIABzAGUAbABsACAAbQBvAGQAaQBmAGkAZQBkACAAYQBuAGQAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACAAYwBvAHAAaQBlAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALAAgAHMAdQBiAGoAZQBjAHQAIAB0AG8AIAB0AGgAZQAgAGYAbwBsAGwAbwB3AGkAbgBnACAAYwBvAG4AZABpAHQAaQBvAG4AcwA6AA0ACgANAAoAMQApACAATgBlAGkAdABoAGUAcgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG4AbwByACAAYQBuAHkAIABvAGYAIABpAHQAcwAgAGkAbgBkAGkAdgBpAGQAdQBhAGwAIABjAG8AbQBwAG8AbgBlAG4AdABzACwAIABpAG4AIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMALAAgAG0AYQB5ACAAYgBlACAAcwBvAGwAZAAgAGIAeQAgAGkAdABzAGUAbABmAC4ADQAKAA0ACgAyACkAIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABtAGEAeQAgAGIAZQAgAGIAdQBuAGQAbABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUALAAgAHAAcgBvAHYAaQBkAGUAZAAgAHQAaABhAHQAIABlAGEAYwBoACAAYwBvAHAAeQAgAGMAbwBuAHQAYQBpAG4AcwAgAHQAaABlACAAYQBiAG8AdgBlACAAYwBvAHAAeQByAGkAZwBoAHQAIABuAG8AdABpAGMAZQAgAGEAbgBkACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALgAgAFQAaABlAHMAZQAgAGMAYQBuACAAYgBlACAAaQBuAGMAbAB1AGQAZQBkACAAZQBpAHQAaABlAHIAIABhAHMAIABzAHQAYQBuAGQALQBhAGwAbwBuAGUAIAB0AGUAeAB0ACAAZgBpAGwAZQBzACwAIABoAHUAbQBhAG4ALQByAGUAYQBkAGEAYgBsAGUAIABoAGUAYQBkAGUAcgBzACAAbwByACAAaQBuACAAdABoAGUAIABhAHAAcAByAG8AcAByAGkAYQB0AGUAIABtAGEAYwBoAGkAbgBlAC0AcgBlAGEAZABhAGIAbABlACAAbQBlAHQAYQBkAGEAdABhACAAZgBpAGUAbABkAHMAIAB3AGkAdABoAGkAbgAgAHQAZQB4AHQAIABvAHIAIABiAGkAbgBhAHIAeQAgAGYAaQBsAGUAcwAgAGEAcwAgAGwAbwBuAGcAIABhAHMAIAB0AGgAbwBzAGUAIABmAGkAZQBsAGQAcwAgAGMAYQBuACAAYgBlACAAZQBhAHMAaQBsAHkAIAB2AGkAZQB3AGUAZAAgAGIAeQAgAHQAaABlACAAdQBzAGUAcgAuAA0ACgANAAoAMwApACAATgBvACAATQBvAGQAaQBmAGkAZQBkACAAVgBlAHIAcwBpAG8AbgAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG0AYQB5ACAAdQBzAGUAIAB0AGgAZQAgAFIAZQBzAGUAcgB2AGUAZAAgAEYAbwBuAHQAIABOAGEAbQBlACgAcwApACAAdQBuAGwAZQBzAHMAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGcAcgBhAG4AdABlAGQAIABiAHkAIAB0AGgAZQAgAGMAbwByAHIAZQBzAHAAbwBuAGQAaQBuAGcAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByAC4AIABUAGgAaQBzACAAcgBlAHMAdAByAGkAYwB0AGkAbwBuACAAbwBuAGwAeQAgAGEAcABwAGwAaQBlAHMAIAB0AG8AIAB0AGgAZQAgAHAAcgBpAG0AYQByAHkAIABmAG8AbgB0ACAAbgBhAG0AZQAgAGEAcwAgAHAAcgBlAHMAZQBuAHQAZQBkACAAdABvACAAdABoAGUAIAB1AHMAZQByAHMALgANAAoADQAKADQAKQAgAFQAaABlACAAbgBhAG0AZQAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAG8AcgAgAHQAaABlACAAQQB1AHQAaABvAHIAKABzACkAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABzAGgAYQBsAGwAIABuAG8AdAAgAGIAZQAgAHUAcwBlAGQAIAB0AG8AIABwAHIAbwBtAG8AdABlACwAIABlAG4AZABvAHIAcwBlACAAbwByACAAYQBkAHYAZQByAHQAaQBzAGUAIABhAG4AeQAgAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4ALAAgAGUAeABjAGUAcAB0ACAAdABvACAAYQBjAGsAbgBvAHcAbABlAGQAZwBlACAAdABoAGUAIABjAG8AbgB0AHIAaQBiAHUAdABpAG8AbgAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAGEAbgBkACAAdABoAGUAIABBAHUAdABoAG8AcgAoAHMAKQAgAG8AcgAgAHcAaQB0AGgAIAB0AGgAZQBpAHIAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAuAA0ACgANAAoANQApACAAVABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACwAIABtAG8AZABpAGYAaQBlAGQAIABvAHIAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACwAIABpAG4AIABwAGEAcgB0ACAAbwByACAAaQBuACAAdwBoAG8AbABlACwAIABtAHUAcwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAZQBuAHQAaQByAGUAbAB5ACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALAAgAGEAbgBkACAAbQB1AHMAdAAgAG4AbwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIABsAGkAYwBlAG4AcwBlAC4AIABUAGgAZQAgAHIAZQBxAHUAaQByAGUAbQBlAG4AdAAgAGYAbwByACAAZgBvAG4AdABzACAAdABvACAAcgBlAG0AYQBpAG4AIAB1AG4AZABlAHIAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGQAbwBlAHMAIABuAG8AdAAgAGEAcABwAGwAeQAgAHQAbwAgAGEAbgB5ACAAZABvAGMAdQBtAGUAbgB0ACAAYwByAGUAYQB0AGUAZAAgAHUAcwBpAG4AZwAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAuAA0ACgANAAoAVABFAFIATQBJAE4AQQBUAEkATwBOAA0ACgBUAGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGIAZQBjAG8AbQBlAHMAIABuAHUAbABsACAAYQBuAGQAIAB2AG8AaQBkACAAaQBmACAAYQBuAHkAIABvAGYAIAB0AGgAZQAgAGEAYgBvAHYAZQAgAGMAbwBuAGQAaQB0AGkAbwBuAHMAIABhAHIAZQAgAG4AbwB0ACAAbQBlAHQALgANAAoADQAKAEQASQBTAEMATABBAEkATQBFAFIADQAKAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAgAEkAUwAgAFAAUgBPAFYASQBEAEUARAAgACIAQQBTACAASQBTACIALAAgAFcASQBUAEgATwBVAFQAIABXAEEAUgBSAEEATgBUAFkAIABPAEYAIABBAE4AWQAgAEsASQBOAEQALAAgAEUAWABQAFIARQBTAFMAIABPAFIAIABJAE0AUABMAEkARQBEACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEIAVQBUACAATgBPAFQAIABMAEkATQBJAFQARQBEACAAVABPACAAQQBOAFkAIABXAEEAUgBSAEEATgBUAEkARQBTACAATwBGACAATQBFAFIAQwBIAEEATgBUAEEAQgBJAEwASQBUAFkALAAgAEYASQBUAE4ARQBTAFMAIABGAE8AUgAgAEEAIABQAEEAUgBUAEkAQwBVAEwAQQBSACAAUABVAFIAUABPAFMARQAgAEEATgBEACAATgBPAE4ASQBOAEYAUgBJAE4ARwBFAE0ARQBOAFQAIABPAEYAIABDAE8AUABZAFIASQBHAEgAVAAsACAAUABBAFQARQBOAFQALAAgAFQAUgBBAEQARQBNAEEAUgBLACwAIABPAFIAIABPAFQASABFAFIAIABSAEkARwBIAFQALgAgAEkATgAgAE4ATwAgAEUAVgBFAE4AVAAgAFMASABBAEwATAAgAFQASABFACAAQwBPAFAAWQBSAEkARwBIAFQAIABIAE8ATABEAEUAUgAgAEIARQAgAEwASQBBAEIATABFACAARgBPAFIAIABBAE4AWQAgAEMATABBAEkATQAsACAARABBAE0AQQBHAEUAUwAgAE8AUgAgAE8AVABIAEUAUgAgAEwASQBBAEIASQBMAEkAVABZACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEEATgBZACAARwBFAE4ARQBSAEEATAAsACAAUwBQAEUAQwBJAEEATAAsACAASQBOAEQASQBSAEUAQwBUACwAIABJAE4AQwBJAEQARQBOAFQAQQBMACwAIABPAFIAIABDAE8ATgBTAEUAUQBVAEUATgBUAEkAQQBMACAARABBAE0AQQBHAEUAUwAsACAAVwBIAEUAVABIAEUAUgAgAEkATgAgAEEATgAgAEEAQwBUAEkATwBOACAATwBGACAAQwBPAE4AVABSAEEAQwBUACwAIABUAE8AUgBUACAATwBSACAATwBUAEgARQBSAFcASQBTAEUALAAgAEEAUgBJAFMASQBOAEcAIABGAFIATwBNACwAIABPAFUAVAAgAE8ARgAgAFQASABFACAAVQBTAEUAIABPAFIAIABJAE4AQQBCAEkATABJAFQAWQAgAFQATwAgAFUAUwBFACAAVABIAEUAIABGAE8ATgBUACAAUwBPAEYAVABXAEEAUgBFACAATwBSACAARgBSAE8ATQAgAE8AVABIAEUAUgAgAEQARQBBAEwASQBOAEcAUwAgAEkATgAgAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAuAAAAAgAAAAAAAP8GAGQAAAAAAAAAAAAAAAAAAAAAAAAAAABfAAMABAAFAAYABwAIAAkACgALAAwADQAOAA8AEAARABIAEwAUABUAFgAXABgAGQAaABsAHAAdAB4AHwAgACEAIgAjACQAJQAmACcAKAApACoAKwAsAC0ALgAvADAAMQAyADMANAA1ADYANwA4ADkAOgA7ADwAPQA+AD8AQABBAEIAQwBEAEUARgBHAEgASQBKAEsATABNAE4ATwBQAFEAUgBTAFQAVQBWAFcAWABZAFoAWwBcAF0AXgBfAGAAYQAAAAMACAACABAAAf//AAIAAAABAAAAAAABAAAADgAAAAAAAAAAAAIAAQAAAF4AAQABAAAACgBKAGQAAmN5cmwADmxhdG4AGAAEAAAAAP//AAAAEAACSVBBIAAaVklUIAAiAAD//wACAAEAAAAA//8AAQABAAD//wAAAAJrZXJuAA5tYXJrABQAAAABAAEAAAABAAAAAgAGAA4ABAAEAAEAEAACAAAAAQAsAAEADAAQAAAAIAAiAAIAAAABAAYAIQAyADYAQQBSAFYAAAAGAAEAjgAEAAAABgAWADAASgBkAHIAgAAGAA7/nAAhADYAQQA2ADIADQA2//IAUgAXAAYADv+cACEAWABBAFgAMgChADYAvQBSAE8ABgAO/nAAIf6TAEH+kwAy//kANgAOAFL/YQADAA7/nABSABcAVv/VAAMADv+cAFIANgBWAEwAAwAO/nAAUgAJAFYAGQABAAYAIQAyADYAQQBSAFYAAQAAAAoATgBoAAJjeXJsAA5sYXRuABoABAAAAAD//wABAAAAEAACSVBBIAAaVklUIAAiAAD//wACAAAAAQAA//8AAQAAAAD//wABAAAAAmFhbHQADnNtY3AAFAAAAAEAAAAAAAEAAAABAAQAAwAAAAEACAABABgAAwAMABAAFAABAEEAAQBSAAEAVgABAAMAIQAyADYAAA==\"\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.ChantDocument = exports.ChantScore = exports.ChantLine = exports.ChantLineBreak = exports.FaClef = exports.DoClef = exports.Clef = exports.Note = exports.NoteShapeModifiers = exports.NoteShape = exports.LiquescentType = undefined;\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar Exsurge = _interopRequireWildcard(_Exsurge);\n\t\n\tvar _Exsurge2 = __webpack_require__(4);\n\t\n\tvar _Exsurge3 = __webpack_require__(3);\n\t\n\tvar _ExsurgeChant = __webpack_require__(7);\n\t\n\tvar _Exsurge4 = __webpack_require__(8);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar LiquescentType = exports.LiquescentType = {\n\t  None: 0,\n\t\n\t  // flags that can be combined, though of course it\n\t  // it doesn't make sense to combine some!\n\t  Large: 1 << 0,\n\t  Small: 1 << 1,\n\t  Ascending: 1 << 2,\n\t  Descending: 1 << 3,\n\t  InitioDebilis: 1 << 4,\n\t\n\t  // handy liquescent types\n\t  LargeAscending: 1 << 0 | 1 << 2,\n\t  LargeDescending: 1 << 0 | 1 << 3,\n\t  SmallAscending: 1 << 1 | 1 << 2,\n\t  SmallDescending: 1 << 1 | 1 << 3\n\t};\n\t\n\tvar NoteShape = exports.NoteShape = {\n\t  // shapes\n\t  Default: 0,\n\t  Virga: 1,\n\t  Inclinatum: 2,\n\t  Quilisma: 3,\n\t  Stropha: 4,\n\t  Oriscus: 5\n\t};\n\t\n\tvar NoteShapeModifiers = exports.NoteShapeModifiers = {\n\t\n\t  // flags which modify the shape\n\t  // not all of them apply to every shape of course\n\t  None: 0,\n\t  Ascending: 1 << 0,\n\t  Descending: 1 << 1,\n\t  Cavum: 1 << 2,\n\t  Stemmed: 1 << 3\n\t};\n\t\n\t/**\r\n\t * @class\r\n\t */\n\t\n\tvar Note = exports.Note = function (_ChantLayoutElement) {\n\t  _inherits(Note, _ChantLayoutElement);\n\t\n\t  /**\r\n\t   * @para {Pitch} pitch\r\n\t   */\n\t\n\t  function Note(pitch) {\n\t    _classCallCheck(this, Note);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Note).call(this));\n\t\n\t    if (typeof pitch !== 'undefined') _this.pitch = pitch;else _this.pitch = null;\n\t\n\t    _this.glyphVisualizer = null;\n\t\n\t    // The staffPosition on a note is an integer that indicates the vertical position on the staff.\n\t    // 0 is the center space on the staff (equivalent to gabc 'g'). Positive numbers go up\n\t    // the staff, and negative numbers go down, i.e., 1 is gabc 'h', 2 is gabc 'i', -1 is gabc 'f', etc.\n\t    _this.staffPosition = 0;\n\t    _this.liquescent = LiquescentType.None;\n\t    _this.shape = NoteShape.Default;\n\t    _this.shapeModifiers = NoteShapeModifiers.None;\n\t    _this.markings = [];\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Note, [{\n\t    key: 'setGlyph',\n\t    value: function setGlyph(ctxt, glyphCode) {\n\t      if (this.glyphVisualizer) this.glyphVisualizer.setGlyph(ctxt, glyphCode);else this.glyphVisualizer = new _Exsurge2.GlyphVisualizer(ctxt, glyphCode);\n\t\n\t      this.glyphVisualizer.setStaffPosition(ctxt, this.staffPosition);\n\t\n\t      // assign glyphvisualizer metrics to this note\n\t      this.bounds.x = this.glyphVisualizer.bounds.x;\n\t      this.bounds.y = this.glyphVisualizer.bounds.y;\n\t      this.bounds.width = this.glyphVisualizer.bounds.width;\n\t      this.bounds.height = this.glyphVisualizer.bounds.height;\n\t\n\t      this.origin.x = this.glyphVisualizer.origin.x;\n\t      this.origin.y = this.glyphVisualizer.origin.y;\n\t    }\n\t\n\t    // a utility function for modifiers\n\t\n\t  }, {\n\t    key: 'shapeModifierMatches',\n\t    value: function shapeModifierMatches(shapeModifier) {\n\t      if (shapeModifier === NoteShapeModifiers.None) return this.shapeModifier === NoteShapeModifiers.None;else return this.shapeModifier & shapeModifier !== 0;\n\t    }\n\t  }, {\n\t    key: 'draw',\n\t    value: function draw(ctxt) {\n\t\n\t      this.glyphVisualizer.bounds.x = this.bounds.x;\n\t      this.glyphVisualizer.bounds.y = this.bounds.y;\n\t\n\t      this.glyphVisualizer.draw(ctxt);\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      this.glyphVisualizer.bounds.x = this.bounds.x;\n\t      this.glyphVisualizer.bounds.y = this.bounds.y;\n\t      return this.glyphVisualizer.createDrawable(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Note;\n\t}(_Exsurge2.ChantLayoutElement);\n\t\n\tvar Clef = exports.Clef = function (_ChantNotationElement) {\n\t  _inherits(Clef, _ChantNotationElement);\n\t\n\t  function Clef(staffPosition, octave) {\n\t    var defaultAccidental = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t    _classCallCheck(this, Clef);\n\t\n\t    var _this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(Clef).call(this));\n\t\n\t    _this2.isClef = true;\n\t    _this2.staffPosition = staffPosition;\n\t    _this2.octave = octave;\n\t    _this2.defaultAccidental = defaultAccidental;\n\t    _this2.activeAccidental = defaultAccidental;\n\t    return _this2;\n\t  }\n\t\n\t  _createClass(Clef, [{\n\t    key: 'resetAccidentals',\n\t    value: function resetAccidentals() {\n\t      this.activeAccidental = this.defaultAccidental;\n\t    }\n\t  }, {\n\t    key: 'pitchToStaffPosition',\n\t    value: function pitchToStaffPosition(pitch) {}\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      ctxt.activeClef = this;\n\t\n\t      if (this.defaultAccidental) this.defaultAccidental.performLayout(ctxt);\n\t\n\t      _get(Object.getPrototypeOf(Clef.prototype), 'performLayout', this).call(this, ctxt);\n\t    }\n\t  }, {\n\t    key: 'finishLayout',\n\t    value: function finishLayout(ctxt) {\n\t\n\t      // if we have a default accidental, then add a glyph for it now\n\t      if (this.defaultAccidental) {\n\t        var accidentalGlyph = this.defaultAccidental.createGlyphVisualizer(ctxt);\n\t        accidentalGlyph.bounds.x += this.visualizers[0].bounds.right() + ctxt.intraNeumeSpacing;\n\t        this.addVisualizer(accidentalGlyph);\n\t      }\n\t\n\t      _get(Object.getPrototypeOf(Clef.prototype), 'finishLayout', this).call(this, ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Clef;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\tvar DoClef = exports.DoClef = function (_Clef) {\n\t  _inherits(DoClef, _Clef);\n\t\n\t  function DoClef(staffPosition, octave) {\n\t    var defaultAccidental = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t    _classCallCheck(this, DoClef);\n\t\n\t    var _this3 = _possibleConstructorReturn(this, Object.getPrototypeOf(DoClef).call(this, staffPosition, octave, defaultAccidental));\n\t\n\t    _this3.leadingSpace = 0.0;\n\t    return _this3;\n\t  }\n\t\n\t  _createClass(DoClef, [{\n\t    key: 'pitchToStaffPosition',\n\t    value: function pitchToStaffPosition(pitch) {\n\t      return (pitch.octave - this.octave) * 7 + this.staffPosition + _Exsurge.Pitch.stepToStaffOffset(pitch.step) - _Exsurge.Pitch.stepToStaffOffset(_Exsurge.Step.Do);\n\t    }\n\t  }, {\n\t    key: 'staffPositionToPitch',\n\t    value: function staffPositionToPitch(staffPosition) {\n\t      var offset = staffPosition - this.staffPosition;\n\t      var octaveOffset = Math.floor(offset / 7);\n\t\n\t      var step = _Exsurge.Pitch.staffOffsetToStep(offset);\n\t\n\t      if (this.defaultAccidental !== null && step === this.defaultAccidental.step) step += this.defaultAccidental.accidentalType;\n\t\n\t      return new _Exsurge.Pitch(step, this.octave + octaveOffset);\n\t    }\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(DoClef.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      var glyph = new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.DoClef);\n\t      glyph.setStaffPosition(ctxt, this.staffPosition);\n\t      this.addVisualizer(glyph);\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new DoClef(this.staffPosition, this.octave, this.defaultAccidental);\n\t    }\n\t  }]);\n\t\n\t  return DoClef;\n\t}(Clef);\n\t\n\tvar FaClef = exports.FaClef = function (_Clef2) {\n\t  _inherits(FaClef, _Clef2);\n\t\n\t  function FaClef(staffPosition, octave) {\n\t    var defaultAccidental = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];\n\t\n\t    _classCallCheck(this, FaClef);\n\t\n\t    var _this4 = _possibleConstructorReturn(this, Object.getPrototypeOf(FaClef).call(this, staffPosition, octave, defaultAccidental));\n\t\n\t    _this4.octave = octave;\n\t\n\t    _this4.leadingSpace = 0;\n\t    return _this4;\n\t  }\n\t\n\t  _createClass(FaClef, [{\n\t    key: 'pitchToStaffPosition',\n\t    value: function pitchToStaffPosition(pitch) {\n\t      return (pitch.octave - this.octave) * 7 + this.staffPosition + _Exsurge.Pitch.stepToStaffOffset(pitch.step) - _Exsurge.Pitch.stepToStaffOffset(_Exsurge.Step.Fa);\n\t    }\n\t  }, {\n\t    key: 'staffPositionToPitch',\n\t    value: function staffPositionToPitch(staffPosition) {\n\t      var offset = staffPosition - this.staffPosition + 3; // + 3 because it's a fa clef (3 == offset from Do)\n\t      var octaveOffset = Math.floor(offset / 7);\n\t\n\t      var step = _Exsurge.Pitch.staffOffsetToStep(offset);\n\t\n\t      if (step === _Exsurge.Step.Ti && this.defaultAccidental === _ExsurgeChant.AccidentalType.Flat) step = _Exsurge.Step.Te;\n\t\n\t      return new _Exsurge.Pitch(step, this.octave + octaveOffset);\n\t    }\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(FaClef.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      var glyph = new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.FaClef);\n\t      glyph.setStaffPosition(ctxt, this.staffPosition);\n\t      this.addVisualizer(glyph);\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new FaClef(this.staffPosition, this.octave, this.defaultAccidental);\n\t    }\n\t  }]);\n\t\n\t  return FaClef;\n\t}(Clef);\n\t\n\tvar ChantLineBreak = exports.ChantLineBreak = function (_ChantNotationElement2) {\n\t  _inherits(ChantLineBreak, _ChantNotationElement2);\n\t\n\t  function ChantLineBreak(justify) {\n\t    _classCallCheck(this, ChantLineBreak);\n\t\n\t    var _this5 = _possibleConstructorReturn(this, Object.getPrototypeOf(ChantLineBreak).call(this));\n\t\n\t    _this5.justify = justify;\n\t    return _this5;\n\t  }\n\t\n\t  _createClass(ChantLineBreak, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      // reset the bounds before doing a layout\n\t      this.bounds = new _Exsurge.Rect(0, 0, 0, 0);\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      var lb = new ChantLineBreak();\n\t      lb.justify = this.justify;\n\t\n\t      return lb;\n\t    }\n\t  }]);\n\t\n\t  return ChantLineBreak;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\t// a chant line represents one staff line on the page. ChantLines are created by the score\n\t// and laid out by the page\n\t\n\t\n\tvar ChantLine = exports.ChantLine = function (_ChantLayoutElement2) {\n\t  _inherits(ChantLine, _ChantLayoutElement2);\n\t\n\t  function ChantLine(score) {\n\t    _classCallCheck(this, ChantLine);\n\t\n\t    var _this6 = _possibleConstructorReturn(this, Object.getPrototypeOf(ChantLine).call(this));\n\t\n\t    _this6.score = score;\n\t\n\t    _this6.scoreNotationStart = 0;\n\t    _this6.scoreNotationCount = 0;\n\t    _this6.notations = [];\n\t    _this6.notationBounds = null; // Rect\n\t\n\t    _this6.lyricBounds = null; // Rect\n\t\n\t    _this6.staffLeft = 0;\n\t    _this6.staffRight = 0;\n\t\n\t    _this6.custod = null;\n\t\n\t    _this6.justify = true;\n\t\n\t    _this6.ledgerLines = [];\n\t\n\t    _this6.startingClef = null; // necessary for the layout process\n\t\n\t    _this6.nextLine = null;\n\t    _this6.previousLine = null; // for layout assistance\n\t\n\t    // fixme: make these configurable values from the score\n\t    _this6.spaceAfterNotations = 30; // the space between the notation bounds and the first text track\n\t    _this6.spaceBetweenTextTracks = 20; // spacing between each text track\n\t    return _this6;\n\t  }\n\t\n\t  _createClass(ChantLine, [{\n\t    key: 'setStartingClef',\n\t    value: function setStartingClef(clef) {\n\t      this.startingClef = clef.clone();\n\t    }\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      // start off with a rectangle that holds at least the four staff lines\n\t      // we fudge the 3 to 3.1 so that the svg doesn't crop off the upper/lower staff lines...\n\t      this.notationBounds = new _Exsurge.Rect(this.staffLeft, -3.1 * ctxt.staffInterval, this.staffRight - this.staffLeft, 6.2 * ctxt.staffInterval);\n\t\n\t      // run through all the elements of the line and calculate the bounds of the notations,\n\t      // as well as the bounds of each text track we will use\n\t      var i;\n\t      var notation = null;\n\t\n\t      for (i = 0; i < this.notations.length; i++) {\n\t        this.notationBounds.union(this.notations[i].bounds);\n\t      }this.lyricVerticalOffset = this.notationBounds.y + this.notationBounds.height + ctxt.lyricTextSize;\n\t\n\t      // finalize the lyrics placement\n\t      for (i = 0; i < this.notations.length; i++) {\n\t        notation = this.notations[i];\n\t\n\t        if (!notation.hasLyric()) continue;\n\t\n\t        notation.lyric.bounds.y = this.lyricVerticalOffset;\n\t      }\n\t\n\t      // dropCap and the annotations\n\t      if (this.scoreNotationStart === 0) {\n\t\n\t        if (this.score.dropCap !== null) {\n\t\n\t          // drop caps and annotations are drawn from their center, so aligning them\n\t          // horizontally is as easy as this.staffLeft / 2\n\t          this.score.dropCap.bounds.x = this.staffLeft / 2;\n\t          this.score.dropCap.bounds.y = this.lyricVerticalOffset;\n\t        }\n\t\n\t        if (this.score.annotation !== null) {\n\t          // annotations use dominant-baseline to align text to the top\n\t          this.score.annotation.bounds.x += this.staffLeft / 2;\n\t          this.score.annotation.bounds.y += -ctxt.staffInterval * 3;\n\t        }\n\t      }\n\t\n\t      this.notationBounds.height += ctxt.lyricTextSize;\n\t\n\t      this.bounds.x = 0;\n\t      this.bounds.y = this.notationBounds.y;\n\t      this.bounds.width = this.notationBounds.right();\n\t      this.bounds.height = this.notationBounds.height;\n\t\n\t      // the origin of the chant line's coordinate space is at the center line of the left extremity of the staff\n\t      this.origin = new _Exsurge.Point(this.staffLeft, -this.notationBounds.y);\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t      var inner = \"\";\n\t\n\t      // add the chant lines\n\t      var i,\n\t          x1 = this.staffLeft,\n\t          x2 = this.staffRight;\n\t\n\t      // create the staff lines\n\t      for (i = -3; i <= 3; i += 2) {\n\t\n\t        inner += _Exsurge2.QuickSvg.createFragment('line', {\n\t          'x1': x1,\n\t          'y1': ctxt.staffInterval * i,\n\t          'x2': x2,\n\t          'y2': ctxt.staffInterval * i,\n\t          'stroke': ctxt.staffLineColor,\n\t          'stroke-width': ctxt.staffLineWeight,\n\t          'class': 'staffLine'\n\t        });\n\t      }\n\t\n\t      // create the ledger lines\n\t      for (i = 0; i < this.ledgerLines.length; i++) {\n\t\n\t        var ledgerLine = this.ledgerLines[i];\n\t        var y = ctxt.calculateHeightFromStaffPosition(ledgerLine.staffPosition);\n\t\n\t        inner += _Exsurge2.QuickSvg.createFragment('line', {\n\t          'x1': ledgerLine.x1,\n\t          'y1': y,\n\t          'x2': ledgerLine.x2,\n\t          'y2': y,\n\t          'stroke': ctxt.staffLineColor,\n\t          'stroke-width': ctxt.staffLineWeight,\n\t          'class': 'ledgerLine'\n\t        });\n\t      }\n\t\n\t      // dropCap and the annotations\n\t      if (this.scoreNotationStart === 0) {\n\t\n\t        if (this.score.dropCap !== null) inner += this.score.dropCap.createDrawable(ctxt);\n\t\n\t        if (this.score.annotation !== null) inner += this.score.annotation.createDrawable(ctxt);\n\t      }\n\t\n\t      // add all of the notations\n\t      for (i = 0; i < this.notations.length; i++) {\n\t        inner += this.notations[i].createDrawable(ctxt);\n\t      }return _Exsurge2.QuickSvg.createFragment('g', {\n\t        'class': 'chantLine',\n\t        'transform': 'translate(' + this.bounds.x + ',' + this.bounds.y + ')'\n\t      }, inner);\n\t    }\n\t  }, {\n\t    key: 'buildFromChantNotationIndex',\n\t    value: function buildFromChantNotationIndex(ctxt, newElementStart, width) {\n\t\n\t      // todo: reset / clear the children we have in case they have data\n\t      this.scoreNotationStart = newElementStart;\n\t      this.scoreNotationCount = 0;\n\t      this.notations = [];\n\t\n\t      this.staffLeft = 0;\n\t\n\t      if (width > 0) this.staffRight = this.staffLeft + width;else this.staffRight = 99999999; // no limit to staff size\n\t\n\t      // If this is the first chant line, then we have to make room for a\n\t      // drop cap and/or annotation, if present\n\t      if (this.scoreNotationStart === 0) {\n\t\n\t        var padding = 0;\n\t\n\t        if (this.score.dropCap !== null) padding = this.score.dropCap.bounds.width + this.score.dropCap.padding * 2;\n\t\n\t        if (this.score.annotation !== null) padding = Math.max(padding, this.score.annotation.bounds.width + this.score.annotation.padding * 4);\n\t\n\t        this.staffLeft += padding;\n\t      }\n\t\n\t      // set up the clef...\n\t      // Also, add the clef as a child (which will also set the clef in the context)\n\t      this.setStartingClef(ctxt.activeClef);\n\t      this.startingClef.performLayout(ctxt);\n\t      this.startingClef.bounds.x = this.staffLeft;\n\t      this.notations.push(this.startingClef);\n\t\n\t      var current = this.startingClef,\n\t          previous = null,\n\t          previousWithLyric = null;\n\t\n\t      // todo: estimate how much space we have available to us\n\t      var rightBoundary = this.staffRight - _Exsurge3.Glyphs.CustodLong.bounds.width - ctxt.intraNeumeSpacing * 4; // possible custod on the line\n\t\n\t      // todo: iterate through the notations, fittng what we can on this line\n\t      var i,\n\t          scoreNotations = this.score.notations;\n\t\n\t      for (i = newElementStart; i < scoreNotations.length; i++) {\n\t\n\t        if (current.hasLyric()) previousWithLyric = current;\n\t\n\t        previous = current;\n\t        current = scoreNotations[i];\n\t\n\t        // try to fit the current element on this line.\n\t        // if it doesn't fit, we finish up here.\n\t        var fitsOnLine = this.positionNotationElement(ctxt, previousWithLyric, previous, current, rightBoundary);\n\t        if (fitsOnLine === false) {\n\t\n\t          // check if the previous elements want to be kept with this one\n\t          for (var k = i - 1; k > this.scoreNotationStart; k--) {\n\t            var cne = this.score.notations[k];\n\t\n\t            if (cne.keepWithNext === true) {\n\t              this.notations.pop(); // remove it from our notations\n\t              this.scoreNotationCount--;\n\t            } else break;\n\t          }\n\t\n\t          // we are at the end of the line!\n\t          break;\n\t        }\n\t\n\t        current.chantLine = this;\n\t        this.notations.push(current);\n\t        this.scoreNotationCount++;\n\t\n\t        // line breaks are a special case indicating to stop processing here\n\t        if (current.constructor.name === 'ChantLineBreak' && width > 0) {\n\t          this.justify = current.justify;\n\t          break;\n\t        }\n\t      }\n\t\n\t      var last,\n\t          extraSpace = 0;\n\t\n\t      if (this.notations.length > 0) {\n\t        last = this.notations[this.notations.length - 1];\n\t\n\t        if (last.hasLyric() && last.getLyricRight() > last.bounds.right() + last.trailingSpace) extraSpace = this.staffRight - last.getLyricRight();else extraSpace = this.staffRight - (last.bounds.right() + last.trailingSpace);\n\t      }\n\t\n\t      // create the custod at the end of the line (if we need it!)\n\t      // if we find an element following this one that is a neume, we create a custod for it\n\t      for (i = this.scoreNotationStart + this.scoreNotationCount; i < this.score.notations.length; i++) {\n\t        var notation = this.score.notations[i];\n\t\n\t        if ('notes' in notation && notation.notes.length > 0) {\n\t\n\t          var custod = new _ExsurgeChant.Custod();\n\t          custod.referringNeume = notation;\n\t\n\t          custod.performLayout(ctxt);\n\t\n\t          if (this.notations.length > 0) {\n\t            last = this.notations[this.notations.length - 1];\n\t            custod.bounds.x = last.bounds.x + last.bounds.width;\n\t          }\n\t\n\t          this.custod = custod;\n\t          this.notations.push(custod);\n\t\n\t          extraSpace -= custod.bounds.width + custod.leadingSpace;\n\t\n\t          // nothing more to see here...\n\t          break;\n\t        }\n\t      }\n\t\n\t      if (width <= 0 && this.notations.length > 0) {\n\t        // set the staff width based on the notations.\n\t        this.staffRight = this.notations[this.notations.length - 1].bounds.right();\n\t      }\n\t\n\t      // Justify the line if we are not the last one\n\t      if (this.justify === true && width > 0 && this.scoreNotationStart + this.scoreNotationCount < this.score.notations.length && extraSpace > 0) this.justifyElements(extraSpace);\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }, {\n\t    key: 'justifyElements',\n\t    value: function justifyElements(extraSpace) {\n\t\n\t      var indices = [];\n\t\n\t      var i,\n\t          prev = null,\n\t          curr = null,\n\t          prevWithLyrics = null;\n\t\n\t      // if we have a custod, place it at the end of the line\n\t      if (this.custod !== null) this.custod.bounds.x = this.staffRight - this.custod.bounds.width - this.custod.leadingSpace;\n\t\n\t      // first pass: determine the neumes we can space apart\n\t      // start at 1 to skip the clef\n\t      for (i = 1; i < this.notations.length - 1; i++) {\n\t\n\t        if (curr !== null && curr.hasLyric()) prevWithLyrics = curr;\n\t\n\t        prev = curr;\n\t        curr = this.notations[i];\n\t\n\t        if (prev !== null && prev.keepWithNext === true) continue;\n\t\n\t        if (prevWithLyrics !== null && prevWithLyrics.lyric.allowsConnector() && !prevWithLyrics.lyric.needsConnector) continue;\n\t\n\t        if (curr.constructor.name === 'ChantLineBreak') continue;\n\t\n\t        // otherwise, we can add space before this element\n\t        indices.push(i);\n\t      }\n\t\n\t      if (indices.length === 0) return;\n\t\n\t      var offset = 0;\n\t      var increment = extraSpace / indices.length;\n\t      var lastIndex = this.notations[this.notations.length - 1].constructor.name === 'Custod' ? this.notations.length - 1 : this.notations.length;\n\t      for (i = 1; i < lastIndex; i++) {\n\t\n\t        curr = this.notations[i];\n\t\n\t        if (indices.indexOf(i) >= 0) {\n\t          curr.bounds.x += offset + increment;\n\t          offset += increment;\n\t        } else curr.bounds.x += offset;\n\t      }\n\t\n\t      offset = offset;\n\t    }\n\t  }, {\n\t    key: 'finishLayout',\n\t    value: function finishLayout(ctxt) {\n\t\n\t      this.ledgerLines = []; // clear any existing ledger lines\n\t\n\t      var epismata = []; // keep track of epismata in case we can connect some\n\t\n\t      // make a final pass over all of the notes to add any necessary\n\t      // ledger lines and to smooth out epismata\n\t      for (var i = 0; i < this.notations.length; i++) {\n\t\n\t        // if it's not a neume, then skip over it, right?\n\t        if (typeof this.notations[i].notes === 'undefined') continue;\n\t\n\t        var neume = this.notations[i];\n\t\n\t        for (var j = 0; j < neume.notes.length; j++) {\n\t          var note = neume.notes[j];\n\t\n\t          // do we need a ledger line for this note?\n\t          var staffPosition = note.staffPosition;\n\t\n\t          if (staffPosition >= 5 || staffPosition <= -5) {\n\t\n\t            var x1 = neume.bounds.x + note.bounds.x - ctxt.staffInterval;\n\t            var x2 = neume.bounds.x + note.bounds.x + note.bounds.width + ctxt.staffInterval;\n\t\n\t            // round the staffPosition to the nearest line\n\t            if (staffPosition > 0) staffPosition = staffPosition - (staffPosition - 1) % 2;else staffPosition = staffPosition - (staffPosition + 1) % 2;\n\t\n\t            // if we have a ledger line close by, then average out the distance between the two\n\t            var minLedgerSeperation = ctxt.staffInterval * 5;\n\t\n\t            if (this.ledgerLines.length > 0 && this.ledgerLines[this.ledgerLines.length - 1].x2 + minLedgerSeperation >= x1) {\n\t\n\t              // average out the distance\n\t              var half = (x1 - this.ledgerLines[this.ledgerLines.length - 1].x2) / 2;\n\t              this.ledgerLines[this.ledgerLines.length - 1].x2 += half;\n\t              x1 -= half;\n\t            }\n\t\n\t            // finally, add the ledger line\n\t            this.ledgerLines.push({\n\t              x1: x1,\n\t              x2: x2,\n\t              staffPosition: staffPosition\n\t            });\n\t          }\n\t\n\t          var noteHasEpisema = false;\n\t\n\t          // blend epismata as we're able\n\t          for (var k = 0; k < note.markings.length; k++) {\n\t\n\t            if (note.markings[k].constructor.name !== \"HorizontalEpisema\") continue;\n\t\n\t            noteHasEpisema = true;\n\t            var episema = note.markings[k];\n\t\n\t            // we try to blend the episema if we're able.\n\t            if (epismata.length === 0 || epismata[0].episema.positionHint !== episema.positionHint || epismata[0].episema.terminating === true) {\n\t\n\t              // start a new set of epismata to potentially blend\n\t              epismata = [];\n\t              epismata.push({\n\t                episema: episema,\n\t                neume: neume\n\t              });\n\t            } else {\n\t              // blend all previous with this one\n\t              var newY;\n\t\n\t              if (episema.positionHint === Exsurge.MarkingPositionHint.Below) newY = Math.max(episema.bounds.y, epismata[0].episema.bounds.y);else newY = Math.min(episema.bounds.y, epismata[0].episema.bounds.y);\n\t\n\t              if (episema.bounds.y !== newY) episema.updateY(newY);else {\n\t                for (var l = 0; l < epismata.length; l++) {\n\t                  epismata[l].episema.updateY(newY);\n\t                }\n\t              }\n\t\n\t              // extend the last episema to meet the new one\n\t              var newWidth = neume.bounds.x + episema.bounds.x - (epismata[epismata.length - 1].neume.bounds.x + epismata[epismata.length - 1].episema.bounds.x);\n\t              epismata[epismata.length - 1].episema.updateWidth(newWidth);\n\t\n\t              epismata.push({\n\t                episema: episema,\n\t                neume: neume\n\t              });\n\t            }\n\t          }\n\t\n\t          // if the note doesn't have any episema, then make sure and stop blending epismata\n\t          if (noteHasEpisema === false) epismata = [];\n\t        }\n\t      }\n\t    }\n\t\n\t    // this is where the real core of positioning neumes takes place\n\t    // returns true if positioning was able to fit the neume before rightBoundary.\n\t    // returns false if cannot fit before given right margin.\n\t    // fixme: if this returns false, shouldn't we set the connectors on prev to be activated?!\n\t\n\t  }, {\n\t    key: 'positionNotationElement',\n\t    value: function positionNotationElement(ctxt, prevWithLyric, prev, curr, rightBoundary) {\n\t\n\t      // To begin we just place the current notation right after the previous,\n\t      // irrespective of lyrics.\n\t      curr.bounds.x = prev.bounds.right() + prev.trailingSpace;\n\t\n\t      if (prevWithLyric === null) {\n\t\n\t        var maxRight = curr.bounds.right() + curr.trailingSpace;\n\t\n\t        // if the lyric left is negative, then offset the neume appropriately\n\t        if (curr.hasLyric()) {\n\t          curr.lyric.setNeedsConnector(false); // we hope for the best!\n\t\n\t          if (curr.getLyricLeft() < 0) curr.bounds.x += -curr.getLyricLeft();\n\t\n\t          maxRight = Math.max(maxRight, curr.getLyricRight());\n\t        }\n\t\n\t        if (maxRight > rightBoundary) return false;else return true;\n\t      }\n\t\n\t      if (curr.hasLyric() === false) {\n\t\n\t        if (prevWithLyric.lyric.allowsConnector()) prevWithLyric.lyric.setNeedsConnector(true);\n\t\n\t        if (curr.bounds.right() + curr.trailingSpace < rightBoundary) return true;else {\n\t          //curr.bounds.x = this.startingClef.bounds.right();\n\t          return false;\n\t        }\n\t      }\n\t\n\t      curr.lyric.setNeedsConnector(false); // we hope for the best!\n\t\n\t      var currLyricLeft = curr.getLyricLeft();\n\t      var prevLyricRight = prevWithLyric.getLyricRight();\n\t\n\t      if (prevWithLyric.lyric.allowsConnector() === false) {\n\t\n\t        // No connector needed, but include space between words if necessary!\n\t        if (prevLyricRight + ctxt.minLyricWordSpacing > currLyricLeft) {\n\t          // push the current element over a bit.\n\t          curr.bounds.x += prevLyricRight + ctxt.minLyricWordSpacing - currLyricLeft;\n\t        }\n\t      } else {\n\t\n\t        // we may need a connector yet...\n\t\n\t        if (prevLyricRight > currLyricLeft) {\n\t          // in this case, the lyric elements actually overlap.\n\t          // so nope, no connector needed. instead, we just place the lyrics together\n\t          // fixme: for better text layout, we could actually use the kerning values\n\t          // between the prev and curr lyric elements!\n\t          curr.bounds.x += prevLyricRight - currLyricLeft;\n\t        } else {\n\t\n\t          // bummer, looks like we couldn't merge the syllables together. Better add a connector...\n\t          prevWithLyric.lyric.setNeedsConnector(true);\n\t          prevLyricRight = prevWithLyric.getLyricRight();\n\t\n\t          if (prevLyricRight > currLyricLeft) curr.bounds.x += prevLyricRight - currLyricLeft;\n\t        }\n\t      }\n\t\n\t      if (curr.bounds.right() + curr.trailingSpace < rightBoundary) return true;\n\t\n\t      // if we made it this far, then the element won't fit on this line.\n\t      // set the position of the current element to the beginning of a chant line,\n\t      // and mark the previous lyric as connecting if needed.\n\t      // curr.bounds.x = this.startingClef.bounds.right();\n\t\n\t      if (prevWithLyric.lyric !== null && prevWithLyric.lyric.allowsConnector()) prevWithLyric.lyric.setNeedsConnector(true);\n\t\n\t      return false;\n\t    }\n\t  }]);\n\t\n\t  return ChantLine;\n\t}(_Exsurge2.ChantLayoutElement);\n\t\n\t/*\r\n\t * Score, document\r\n\t */\n\t\n\t\n\tvar ChantScore = exports.ChantScore = function () {\n\t  function ChantScore() {\n\t    _classCallCheck(this, ChantScore);\n\t\n\t    this.startingClef = null; // Clef\n\t\n\t    this.notations = [];\n\t    this.lines = [];\n\t    this.notes = [];\n\t\n\t    this.dropCap = null;\n\t    this.annotation = null;\n\t\n\t    this.compiled = false;\n\t\n\t    this.autoColoring = true;\n\t\n\t    // valid after chant lines are created...\n\t    this.bounds = new _Exsurge.Rect();\n\t  }\n\t\n\t  _createClass(ChantScore, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt, finishedCallback) {\n\t      var _this7 = this;\n\t\n\t      // first order of business: let the clef perform layout\n\t      this.startingClef.performLayout(ctxt);\n\t\n\t      if (this.dropCap) this.dropCap.recalculateMetrics(ctxt);\n\t\n\t      if (this.annotation) this.annotation.recalculateMetrics(ctxt);\n\t\n\t      if (this.compiled) {\n\t        setTimeout(function () {\n\t          if (finishedCallback) finishedCallback();\n\t        }, 0);\n\t      } else {\n\t        // boot the compilation process\n\t        setTimeout(function () {\n\t          _this7.compileElement(ctxt, 0, finishedCallback);\n\t        }, 0);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'compileElement',\n\t    value: function compileElement(ctxt, index, finishedCallback) {\n\t      var _this8 = this;\n\t\n\t      if (index >= this.notations.length) {\n\t\n\t        if (!this.compiled) {\n\t          this.compiled = true;\n\t          setTimeout(function () {\n\t            if (finishedCallback) finishedCallback();\n\t          }, 0);\n\t        }\n\t\n\t        return;\n\t      }\n\t\n\t      var timeout = new Date().getTime() + 50; // process for fifty milliseconds\n\t      do {\n\t        var notation = this.notations[index++];\n\t        notation.performLayout(ctxt);\n\t      } while (index < this.notations.length && new Date().getTime() < timeout);\n\t\n\t      // schedule the next block of processing\n\t      setTimeout(function () {\n\t        _this8.compileElement(ctxt, index, finishedCallback);\n\t      }, 0);\n\t    }\n\t  }, {\n\t    key: 'layoutChantLines',\n\t    value: function layoutChantLines(ctxt, width, finishedCallback) {\n\t\n\t      this.lines = [];\n\t\n\t      var y = 0;\n\t      var currIndex = 0;\n\t\n\t      ctxt.activeClef = this.startingClef;\n\t\n\t      do {\n\t\n\t        var line = new ChantLine(this);\n\t\n\t        line.buildFromChantNotationIndex(ctxt, currIndex, width);\n\t        currIndex += line.scoreNotationCount;\n\t        line.performLayout(ctxt);\n\t        this.lines.push(line);\n\t\n\t        line.bounds.y = -line.bounds.y + y;\n\t        y += line.bounds.height + ctxt.staffInterval * 3;\n\t      } while (currIndex < this.notations.length);\n\t\n\t      var lastLine = this.lines[this.lines.length - 1];\n\t\n\t      this.bounds.x = 0;\n\t      this.bounds.y = 0;\n\t      this.bounds.width = lastLine.bounds.width;\n\t      this.bounds.height = y;\n\t\n\t      if (finishedCallback) finishedCallback(this);\n\t    }\n\t  }, {\n\t    key: 'createDrawable',\n\t    value: function createDrawable(ctxt) {\n\t\n\t      var i,\n\t          drawable = \"\";\n\t\n\t      // create defs section\n\t      for (var def in ctxt.defs) {\n\t        if (ctxt.defs.hasOwnProperty(def)) drawable += ctxt.defs[def];\n\t      }drawable = _Exsurge2.QuickSvg.createFragment('defs', {}, drawable);\n\t\n\t      for (i = 0; i < this.lines.length; i++) {\n\t        drawable += this.lines[i].createDrawable(ctxt);\n\t      }drawable = _Exsurge2.QuickSvg.createFragment('g', {}, drawable);\n\t\n\t      drawable = _Exsurge2.QuickSvg.createFragment('svg', {\n\t        'xmlns': 'http://www.w3.org/2000/svg',\n\t        'version': '1.1',\n\t        'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n\t        'class': 'ChantScore',\n\t        'width': this.bounds.width,\n\t        'height': this.bounds.height\n\t      }, drawable);\n\t\n\t      return drawable;\n\t    }\n\t  }, {\n\t    key: 'unserializeFromJson',\n\t    value: function unserializeFromJson(data) {\n\t      this.autoColoring = data['auto-coloring'];\n\t\n\t      if (data.annotation !== null && data.annotation !== \"\") {\n\t        // create the annotation\n\t        this.annotation = new _Exsurge2.Annotation(_Exsurge2.ctxt, data.annotation);\n\t      } else this.annotation = null;\n\t\n\t      var createDropCap = data['drop-cap'] === 'auto' ? true : false;\n\t\n\t      _Exsurge4.Gabc.parseChantNotations(data.notations, this, createDropCap);\n\t    }\n\t  }, {\n\t    key: 'serializeToJson',\n\t    value: function serializeToJson() {\n\t      var data = {};\n\t\n\t      data['type'] = \"score\";\n\t      data['auto-coloring'] = true;\n\t\n\t      if (this.annotation !== null) data.annotation = this.annotation.unsanitizedText;else data.annotation = \"\";\n\t\n\t      return data;\n\t    }\n\t  }]);\n\t\n\t  return ChantScore;\n\t}();\n\t\n\tvar ChantDocument = exports.ChantDocument = function () {\n\t  function ChantDocument() {\n\t    _classCallCheck(this, ChantDocument);\n\t\n\t    var defaults = {\n\t      layout: {\n\t        units: \"mm\",\n\t        'default-font': {\n\t          'font-family': \"Crimson\",\n\t          'font-size': 14\n\t        },\n\t        page: {\n\t          width: 8.5,\n\t          height: 11,\n\t          'margin-left': 0,\n\t          'margin-top': 0,\n\t          'margin-right': 0,\n\t          'margin-bottom': 0\n\t        }\n\t      },\n\t      scores: []\n\t    };\n\t\n\t    // default layout\n\t    this.copyLayout(this, defaults);\n\t\n\t    this.scores = defaults.scores;\n\t  }\n\t\n\t  _createClass(ChantDocument, [{\n\t    key: 'copyLayout',\n\t    value: function copyLayout(to, from) {\n\t\n\t      to.layout = {\n\t        units: from.layout.units,\n\t        'default-font': {\n\t          'font-family': from.layout['default-font']['font-family'],\n\t          'font-size': from.layout['default-font']['font-size']\n\t        },\n\t        page: {\n\t          width: from.layout.page.width,\n\t          height: from.layout.page.height,\n\t          'margin-left': from.layout.page['margin-left'],\n\t          'margin-top': from.layout.page['margin-top'],\n\t          'margin-right': from.layout.page['margin-right'],\n\t          'margin-bottom': from.layout.page['margin-bottom']\n\t        }\n\t      };\n\t    }\n\t  }, {\n\t    key: 'unserializeFromJson',\n\t    value: function unserializeFromJson(data) {\n\t\n\t      this.copyLayout(this, data);\n\t\n\t      this.scores = [];\n\t\n\t      // read in the scores\n\t      for (var i = 0; i < data.scores.length; i++) {\n\t        var score = new ChantScore();\n\t\n\t        score.unserializeFromJson(data.scores[i]);\n\t        this.scores.push(score);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'serializeToJson',\n\t    value: function serializeToJson() {\n\t      var data = {};\n\t\n\t      this.copyLayout(data, this);\n\t\n\t      data.scores = [];\n\t\n\t      // save scores...\n\t      for (var i = 0; i < this.scores.length; i++) {\n\t        data.scores.push(this.scores[i].serializeToJson());\n\t      }return data;\n\t    }\n\t  }]);\n\t\n\t  return ChantDocument;\n\t}();\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Virgula = exports.Accidental = exports.AccidentalType = exports.DoubleBar = exports.FullBar = exports.HalfBar = exports.QuarterBar = exports.DividingLine = exports.Custod = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar Exsurge = _interopRequireWildcard(_Exsurge);\n\t\n\tvar _Exsurge2 = __webpack_require__(4);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\t/*\r\n\t *\r\n\t */\n\t\n\tvar Custod = exports.Custod = function (_ChantNotationElement) {\n\t  _inherits(Custod, _ChantNotationElement);\n\t\n\t  function Custod() {\n\t    _classCallCheck(this, Custod);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Custod).call(this));\n\t\n\t    _this.referringNeume = null;\n\t    _this.note = null;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Custod, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(Custod.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      var staffPosition = 0; // a default value just to make sure we don't fail rebuilding\n\t      var glyphCode;\n\t\n\t      if (this.referringNeume !== null) {\n\t        if (this.referringNeume.notes.length > 0) staffPosition = this.referringNeume.notes[0].staffPosition;\n\t      } else if (note !== null) staffPosition = this.note.staffPosition;\n\t\n\t      glyphCode = Custod.getGlyphCode(staffPosition);\n\t\n\t      var glyph = new _Exsurge2.GlyphVisualizer(ctxt, glyphCode);\n\t      glyph.setStaffPosition(ctxt, staffPosition);\n\t      this.addVisualizer(glyph);\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }], [{\n\t    key: 'getGlyphCode',\n\t    value: function getGlyphCode(staffPosition) {\n\t\n\t      if (staffPosition <= 2) {\n\t\n\t        // ascending custodes\n\t        if (Math.abs(staffPosition) % 2 === 1) return _Exsurge2.GlyphCode.CustodLong;else return _Exsurge2.GlyphCode.CustodShort;\n\t      } else {\n\t\n\t        // descending custodes\n\t        if (Math.abs(staffPosition) % 2 === 1) return _Exsurge2.GlyphCode.CustodDescLong;else return _Exsurge2.GlyphCode.CustodDescShort;\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return Custod;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\t/*\r\n\t * DividingLine\r\n\t */\n\t\n\t\n\tvar DividingLine = exports.DividingLine = function (_ChantNotationElement2) {\n\t  _inherits(DividingLine, _ChantNotationElement2);\n\t\n\t  function DividingLine() {\n\t    _classCallCheck(this, DividingLine);\n\t\n\t    var _this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(DividingLine).call(this));\n\t\n\t    _this2.resetsAccidentals = true;\n\t    return _this2;\n\t  }\n\t\n\t  return DividingLine;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\t/*\r\n\t * QuarterBar\r\n\t */\n\t\n\t\n\tvar QuarterBar = exports.QuarterBar = function (_DividingLine) {\n\t  _inherits(QuarterBar, _DividingLine);\n\t\n\t  function QuarterBar() {\n\t    _classCallCheck(this, QuarterBar);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(QuarterBar).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(QuarterBar, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(QuarterBar.prototype), 'performLayout', this).call(this, ctxt);\n\t      this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt, 2, 4));\n\t\n\t      this.origin.x = this.bounds.width / 2;\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return QuarterBar;\n\t}(DividingLine);\n\t\n\t/*\r\n\t * HalfBar\r\n\t */\n\t\n\t\n\tvar HalfBar = exports.HalfBar = function (_DividingLine2) {\n\t  _inherits(HalfBar, _DividingLine2);\n\t\n\t  function HalfBar() {\n\t    _classCallCheck(this, HalfBar);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(HalfBar).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(HalfBar, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(HalfBar.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt, -2, 2));\n\t\n\t      this.origin.x = this.bounds.width / 2;\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return HalfBar;\n\t}(DividingLine);\n\t\n\t/*\r\n\t * FullBar\r\n\t */\n\t\n\t\n\tvar FullBar = exports.FullBar = function (_DividingLine3) {\n\t  _inherits(FullBar, _DividingLine3);\n\t\n\t  function FullBar() {\n\t    _classCallCheck(this, FullBar);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(FullBar).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(FullBar, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(FullBar.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt, -3, 3));\n\t\n\t      this.origin.x = this.bounds.width / 2;\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return FullBar;\n\t}(DividingLine);\n\t\n\t/*\r\n\t * DoubleBar\r\n\t */\n\t\n\t\n\tvar DoubleBar = exports.DoubleBar = function (_DividingLine4) {\n\t  _inherits(DoubleBar, _DividingLine4);\n\t\n\t  function DoubleBar() {\n\t    _classCallCheck(this, DoubleBar);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(DoubleBar).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(DoubleBar, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(DoubleBar.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      var line0 = new _Exsurge2.DividerLineVisualizer(ctxt, -3, 3);\n\t      line0.bounds.x = 0;\n\t      this.addVisualizer(line0);\n\t\n\t      var line1 = new _Exsurge2.DividerLineVisualizer(ctxt, -3, 3);\n\t      line1.bounds.x = ctxt.intraNeumeSpacing * 2;\n\t      this.addVisualizer(line1);\n\t\n\t      this.origin.x = this.bounds.width / 2;\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return DoubleBar;\n\t}(DividingLine);\n\t\n\tvar AccidentalType = exports.AccidentalType = {\n\t  Flat: -1,\n\t  Natural: 0,\n\t  Sharp: 1\n\t};\n\t\n\t/*\r\n\t * Accidental\r\n\t */\n\t\n\tvar Accidental = exports.Accidental = function (_ChantNotationElement3) {\n\t  _inherits(Accidental, _ChantNotationElement3);\n\t\n\t  function Accidental(staffPosition, accidentalType) {\n\t    _classCallCheck(this, Accidental);\n\t\n\t    var _this7 = _possibleConstructorReturn(this, Object.getPrototypeOf(Accidental).call(this));\n\t\n\t    _this7.isAccidental = true;\n\t    _this7.keepWithNext = true; // accidentals should always stay connected...\n\t\n\t    _this7.staffPosition = staffPosition;\n\t    _this7.accidentalType = accidentalType;\n\t    return _this7;\n\t  }\n\t\n\t  _createClass(Accidental, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(Accidental.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      this.addVisualizer(this.createGlyphVisualizer(ctxt));\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t\n\t    // creation of the glyph visualizer is refactored out or performLayout\n\t    // so that clefs can use the same logic for their accidental glyph\n\t\n\t  }, {\n\t    key: 'createGlyphVisualizer',\n\t    value: function createGlyphVisualizer(ctxt) {\n\t\n\t      var glyphCode = _Exsurge2.GlyphCode.Flat;\n\t\n\t      switch (this.accidentalType) {\n\t        case AccidentalType.Natural:\n\t          glyphCode = _Exsurge2.GlyphCode.Natural;\n\t          break;\n\t        case AccidentalType.Sharp:\n\t          glyphCode = _Exsurge2.GlyphCode.Sharp;\n\t          break;\n\t        default:\n\t          glyphCode = _Exsurge2.GlyphCode.Flat;\n\t          break;\n\t      }\n\t\n\t      var glyph = new _Exsurge2.GlyphVisualizer(ctxt, glyphCode);\n\t      glyph.setStaffPosition(ctxt, this.staffPosition);\n\t\n\t      return glyph;\n\t    }\n\t  }, {\n\t    key: 'adjustStep',\n\t    value: function adjustStep(step) {\n\t      switch (this.accidentalType) {\n\t        case AccidentalType.Flat:\n\t          if (step === Step.Ti) return Step.Te;\n\t          if (step === Step.Mi) return Step.Me;\n\t          break;\n\t        case AccidentalType.Sharp:\n\t          if (step === Step.Do) return Step.Du;\n\t          if (step === Step.Fa) return Step.Fu;\n\t          break;\n\t        case AccidentalType.Natural:\n\t          if (step === Step.Te) return Step.Ti;\n\t          if (step === Step.Me) return Step.Mi;\n\t          if (step === Step.Du) return Step.Do;\n\t          if (step === Step.Fu) return Step.Fa;\n\t          break;\n\t      }\n\t\n\t      // no adjustment needed\n\t      return step;\n\t    }\n\t  }, {\n\t    key: 'applyToPitch',\n\t    value: function applyToPitch(pitch) {\n\t\n\t      // fixme: this is broken since we changed to staff positions\n\t\n\t      // no adjusment needed\n\t      if (this.octave !== pitch.octave) return;\n\t\n\t      pitch.step = this.adjustStep(pitch.step);\n\t    }\n\t  }]);\n\t\n\t  return Accidental;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\t/*\r\n\t * Virgula\r\n\t */\n\t\n\t\n\tvar Virgula = exports.Virgula = function (_ChantNotationElement4) {\n\t  _inherits(Virgula, _ChantNotationElement4);\n\t\n\t  function Virgula() {\n\t    _classCallCheck(this, Virgula);\n\t\n\t    // fixme: the staff position of the virgula is customizable, so that it\n\t    // can be placed on different lines (top or bottom) depending on the\n\t    // notation tradition of what is being notated (e.g., Benedictine has it\n\t    //  on top line, Norbertine at the bottom)\n\t\n\t    var _this8 = _possibleConstructorReturn(this, Object.getPrototypeOf(Virgula).call(this));\n\t\n\t    _this8.staffPosition = 3;\n\t    return _this8;\n\t  }\n\t\n\t  _createClass(Virgula, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(Virgula.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      var glyph = new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.Virgula);\n\t      glyph.setStaffPosition(ctxt, this.staffPosition);\n\t\n\t      this.addVisualizer(glyph);\n\t\n\t      this.origin.x = this.bounds.width / 2;\n\t\n\t      this.finishLayout(ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Virgula;\n\t}(_Exsurge2.ChantNotationElement);\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Gabc = undefined;\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar _Exsurge2 = __webpack_require__(4);\n\t\n\tvar _Exsurge3 = __webpack_require__(6);\n\t\n\tvar _ExsurgeChant = __webpack_require__(9);\n\t\n\tvar Markings = _interopRequireWildcard(_ExsurgeChant);\n\t\n\tvar _ExsurgeChant2 = __webpack_require__(7);\n\t\n\tvar Signs = _interopRequireWildcard(_ExsurgeChant2);\n\t\n\tvar _ExsurgeChant3 = __webpack_require__(10);\n\t\n\tvar Neumes = _interopRequireWildcard(_ExsurgeChant3);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\t// reusable reg exps\n\tvar __syllablesRegex = /(?=.)((?:[^(])*)(?:\\(?([^)]*)\\)?)?/g; //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar __notationsRegex = /z0|z|Z|::|:|;|,|`|c1|c2|c3|c4|f3|f4|cb3|cb4|\\/\\/|\\/|\\!|-?[a-mA-M][oOwWvVrRsxy#~\\+><_\\.'012345]*/g;\n\t\n\tvar Gabc = exports.Gabc = {\n\t\n\t  loadChantScore: function loadChantScore(ctxt, gabcNotations, createDropCap) {\n\t\n\t    var score = new _Exsurge3.ChantScore();\n\t\n\t    // fixme: no dropcap until the text engine is working again\n\t    this.parseChantNotations(ctxt, gabcNotations, score, createDropCap);\n\t\n\t    return score;\n\t  },\n\t\n\t  parseChantNotations: function parseChantNotations(ctxt, gabcNotations, score, createDropCap) {\n\t\n\t    score.notations = [];\n\t\n\t    var passByRef = {\n\t      activeClef: null\n\t    };\n\t\n\t    // split the notations on whitespace boundaries\n\t    var words = gabcNotations.match(/\\S+/g);\n\t\n\t    for (var i = 0; i < words.length; i++) {\n\t      var word = words[i];\n\t\n\t      var currSyllable = 0;\n\t\n\t      if (word === '') continue;\n\t\n\t      word = word.trim();\n\t\n\t      var matches = [];\n\t\n\t      while (match = __syllablesRegex.exec(word)) {\n\t        matches.push(match);\n\t      }for (var j = 0; j < matches.length; j++) {\n\t        var match = matches[j];\n\t\n\t        var lyricText = match[1].trim();\n\t        var notationData = match[2];\n\t\n\t        var items = this.createNotations(ctxt, score, notationData, passByRef);\n\t\n\t        if (items.length === 0) continue;\n\t\n\t        // create lyric if we have it...\n\t        if (lyricText !== \"\") {\n\t\n\t          var lyricType;\n\t          if (currSyllable === 0 && matches.length === 1) lyricType = _Exsurge2.LyricType.SingleSyllable;else if (currSyllable === 0 && matches.length > 1) lyricType = _Exsurge2.LyricType.BeginningSyllable;else if (currSyllable === matches.length - 1) lyricType = _Exsurge2.LyricType.EndingSyllable;else lyricType = _Exsurge2.LyricType.MiddleSyllable;\n\t\n\t          // if we are to create a dropCap and we haven't done so yet, do it now\n\t          if (createDropCap && score.dropCap === null) {\n\t            score.dropCap = new _Exsurge2.DropCap(ctxt, lyricText.substring(0, 1));\n\t\n\t            // if the dropcap is a single character syllable (vowel) that is the\n\t            // beginning of the word, then we use a hyphen in place of the lyric text\n\t            // and treat it as a single syllable.\n\t            if (lyricText.length === 1 && lyricType === _Exsurge2.LyricType.BeginningSyllable) {\n\t              lyricText = ctxt.syllableConnector;\n\t              lyricType = _Exsurge2.LyricType.SingleSyllable;\n\t            } else lyricText = lyricText.substring(1);\n\t          }\n\t\n\t          // add the lyrics to the first notation that makes sense...\n\t          var notationWithLyrics = null;\n\t          for (var k = 0; k < items.length; k++) {\n\t            var cne = items[k];\n\t            if (cne.constructor.name === \"Accidental\") continue;\n\t\n\t            notationWithLyrics = cne;\n\t            break;\n\t          }\n\t\n\t          // if it's not a neume then make the lyric a directive\n\t          if (typeof notationWithLyrics.notes === 'undefined') lyricType = _Exsurge2.LyricType.Directive;\n\t\n\t          var lyric = this.makeLyric(ctxt, lyricText, lyricType);\n\t\n\t          // also, new words reset the accidentals, per the Solesmes style (see LU xviij)\n\t          if (lyric.lyricType === _Exsurge2.LyricType.BeginningSyllable || lyric.lyricType === _Exsurge2.LyricType.SingleSyllable) passByRef.activeClef.resetAccidentals();\n\t\n\t          notationWithLyrics.lyric = lyric;\n\t        }\n\t\n\t        score.notations = score.notations.concat(items);\n\t\n\t        currSyllable++;\n\t      }\n\t    }\n\t  },\n\t\n\t  makeLyric: function makeLyric(ctxt, text, lyricType) {\n\t\n\t    if (text.length > 1 && text[text.length - 1] === '-') {\n\t      if (lyricType === _Exsurge2.LyricType.EndingSyllable) lyricType = _Exsurge2.LyricType.MiddleSyllable;else if (lyricType === _Exsurge2.LyricType.SingleSyllable) lyricType = _Exsurge2.LyricType.BeginningSyllable;\n\t\n\t      text = text.substring(0, text.length - 1);\n\t    }\n\t\n\t    var elides = false;\n\t    if (text.length > 1 && text[text.length - 1] === '_') {\n\t      // must be an elision\n\t      elides = true;\n\t      text = text.substring(0, text.length - 1);\n\t    }\n\t\n\t    if (text === \"*\" || text === \"\") lyricType = _Exsurge2.LyricType.Directive;\n\t\n\t    var s = new _Exsurge2.Lyric(ctxt, text, lyricType);\n\t    s.elidesToNext = elides;\n\t\n\t    return s;\n\t  },\n\t\n\t  createNotations: function createNotations(ctxt, score, data, passByRef) {\n\t\n\t    var notations = [];\n\t\n\t    // if there is no data, then this must be a text only object\n\t    if (data === undefined || data === null || data === \"\") {\n\t      notations.push(new Neumes.TextOnly());\n\t      return notations;\n\t    }\n\t\n\t    var notes = [];\n\t    var out = { trailingSpace: -1 };\n\t\n\t    var that = this;\n\t    var addNotation = function addNotation(notation) {\n\t\n\t      // first, if we have any notes left over, we create a neume out of them\n\t      if (notes.length > 0) {\n\t        // create neume(s)\n\t\n\t        var neumes = that.createNeumesFromNotes(ctxt, score, notes, out.trailingSpace);\n\t        for (var i = 0; i < neumes.length; i++) {\n\t          notations.push(neumes[i]);\n\t        } // reset the trailing space\n\t        out.trailingSpace = -1;\n\t\n\t        notes = [];\n\t      }\n\t\n\t      // then, if we're passed a notation, let's add it\n\t      // also, perform chant logic here\n\t      if (notation !== null) {\n\t\n\t        if (notation.isClef) {\n\t          if (score.startingClef === null) {\n\t            score.startingClef = notation;\n\t            return;\n\t          }\n\t        } else if (notation.isAccidental) passByRef.activeClef.activeAccidental = notation;else if (notation.resetsAccidentals) passByRef.activeClef.resetAccidentals();\n\t\n\t        notations.push(notation);\n\t      }\n\t    };\n\t\n\t    var atoms = data.match(__notationsRegex);\n\t\n\t    for (var i = 0; i < atoms.length; i++) {\n\t\n\t      var atom = atoms[i],\n\t          lineBreak = null;\n\t\n\t      // handle the clefs and dividers here\n\t      switch (atom) {\n\t        case \",\":\n\t          addNotation(new Signs.QuarterBar());\n\t          break;\n\t        case \"`\":\n\t          addNotation(new Signs.Virgula());\n\t          break;\n\t        case \";\":\n\t          addNotation(new Signs.HalfBar());\n\t          break;\n\t        case \":\":\n\t          addNotation(new Signs.FullBar());\n\t          break;\n\t        case \"::\":\n\t          addNotation(new Signs.DoubleBar());\n\t          break;\n\t        // other gregorio dividers are not supported\n\t\n\t        case \"c1\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(-3, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"c2\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(-1, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"c3\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(1, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"c4\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(3, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"f3\":\n\t          passByRef.activeClef = new _Exsurge3.FaClef(1, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"f4\":\n\t          passByRef.activeClef = new _Exsurge3.FaClef(3, 2);\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"cb3\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(1, 2, new Signs.Accidental(0, Signs.AccidentalType.Flat));\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"cb4\":\n\t          passByRef.activeClef = new _Exsurge3.DoClef(3, 2, new Signs.Accidental(2, Signs.AccidentalType.Flat));\n\t          addNotation(passByRef.activeClef);\n\t          break;\n\t\n\t        case \"z\":\n\t          lineBreak = new _Exsurge3.ChantLineBreak(true);\n\t          addNotation(lineBreak);\n\t          break;\n\t        case \"Z\":\n\t          lineBreak = new _Exsurge3.ChantLineBreak(false);\n\t          addNotation(lineBreak);\n\t          break;\n\t        case \"z0\":\n\t          // unsupported for now...\n\t          break;\n\t\n\t        // spacing indicators\n\t        case \"!\":\n\t          out.trailingSpace = 0;\n\t          addNotation(null);\n\t          break;\n\t        case \"/\":\n\t          out.trailingSpace = ctxt.intraNeumeSpacing;\n\t          addNotation(null);\n\t          break;\n\t        case \"//\":\n\t          out.trailingSpace = ctxt.intraNeumeSpacing * 2;\n\t          addNotation(null);\n\t          break;\n\t\n\t        default:\n\t          // might be a custod, might be an accidental, or might be a note\n\t          if (atom.length > 1 && atom[1] === '+') {\n\t            // custod\n\t            var custod = new Custod();\n\t\n\t            custod.note = new _Exsurge3.Note(this.convertGabcStaffPositionToScribamPitch(passByRef.activeClef, data[0]));\n\t\n\t            addNotation(custod);\n\t          } else if (atom.length > 1 && (atom[1] === 'x' || atom[1] === 'y' || atom[1] === '#')) {\n\t\n\t            var accidentalType;\n\t\n\t            switch (atom[1]) {\n\t              case 'y':\n\t                accidentalType = Signs.AccidentalType.Natural;\n\t                break;\n\t              case '#':\n\t                accidentalType = Signs.AccidentalType.Sharp;\n\t                break;\n\t              default:\n\t                accidentalType = Signs.AccidentalType.Flat;\n\t                break;\n\t            }\n\t\n\t            var note = this.createNoteFromData(ctxt, passByRef.activeClef, atom);\n\t            var accidental = new Signs.Accidental(note.staffPosition, accidentalType);\n\t            accidental.trailingSpace = ctxt.intraNeumeSpacing * 2;\n\t\n\t            passByRef.activeClef.activeAccidental = accidental;\n\t\n\t            addNotation(accidental);\n\t          } else {\n\t\n\t            // to make our interpreter more robust, make sure we have a clef to work with\n\t            if (passByRef.activeClef === null) passByRef.activeClef = new _Exsurge3.DoClef(1, 2);\n\t\n\t            // looks like it's a note\n\t            notes.push(this.createNoteFromData(ctxt, passByRef.activeClef, atom));\n\t          }\n\t          break;\n\t      }\n\t    }\n\t\n\t    // finish up any remaining notes we have left\n\t    addNotation(null);\n\t\n\t    return notations;\n\t  },\n\t\n\t  createNeumesFromNotes: function createNeumesFromNotes(ctxt, score, notes, finalTrailingSpace) {\n\t\n\t    var neumes = [];\n\t    var intraNeumeSpacing = ctxt.intraNeumeSpacing;\n\t\n\t    var prevNote = null,\n\t        currNote = null;\n\t    var firstNoteIndex = 0;\n\t    var currNoteIndex = 0;\n\t\n\t    // here we use a simple finite state machine to create the neumes from the notes\n\t    // createNeume is helper function which returns the next state after a neume is created\n\t    // (unknownState). Each state object has a neume() function and a handle() function.\n\t    // neume() allows us to create the neume of the state in the event that we run out\n\t    // of notes. handle() gives the state an opportunity to examine the currNote and\n\t    // determine what to do...either transition to a different neume/state, or\n\t    // continue building the neume of that state. handle() returns the next state\n\t\n\t    var createNeume = function createNeume(neume, includeCurrNote) {\n\t\n\t      // add the notes to the neume\n\t      var lastNoteIndex = includeCurrNote ? currNoteIndex : currNoteIndex - 1;\n\t      while (firstNoteIndex <= lastNoteIndex) {\n\t        neume.notes.push(notes[firstNoteIndex++]);\n\t      }neumes.push(neume);\n\t\n\t      if (includeCurrNote === false) {\n\t        currNoteIndex--;\n\t        neume.keepWithNext = true;\n\t        neume.trailingSpace = intraNeumeSpacing;\n\t      }\n\t\n\t      return unknownState;\n\t    };\n\t\n\t    var unknownState = {\n\t      neume: function neume() {\n\t        return new Neumes.Punctum();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Virga) return virgaState;else if (currNote.shape === _Exsurge3.NoteShape.Stropha) return apostrophaState;else if (currNote.shape === _Exsurge3.NoteShape.Oriscus) return oriscusState;else if (currNote.shapeModifiers & _Exsurge3.NoteShapeModifiers.Cavum) return createNeume(new Neumes.Punctum(), true);else return punctumState;\n\t      }\n\t    };\n\t\n\t    var punctumState = {\n\t      neume: function neume() {\n\t        return new Neumes.Punctum();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.staffPosition > prevNote.staffPosition) return podatusState;else if (currNote.staffPosition < prevNote.staffPosition) {\n\t          if (currNote.shape === _Exsurge3.NoteShape.Inclinatum) return climacusState;else return clivisState;\n\t        } else return distrophaState;\n\t      }\n\t    };\n\t\n\t    var oriscusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Oriscus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default) {\n\t\n\t          if (currNote.staffPosition > prevNote.staffPosition) {\n\t            prevNote.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Ascending;\n\t            return createNeume(new Neumes.PesQuassus(), true);\n\t          } else if (currNote.staffPosition < prevNote.staffPosition) {\n\t            prevNote.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Descending;\n\t            return createNeume(new Neumes.Clivis(), true);\n\t          }\n\t        } else\n\t          // stand alone oriscus\n\t          return createNeume(new Neumes.Oriscus(), true);\n\t      }\n\t    };\n\t\n\t    var podatusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Podatus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.staffPosition > prevNote.staffPosition) {\n\t\n\t          if (prevNote.shape === _Exsurge3.NoteShape.Oriscus) return salicusState;else return scandicusState;\n\t        } else if (currNote.staffPosition < prevNote.staffPosition) {\n\t          if (currNote.shape === _Exsurge3.NoteShape.Inclinatum) return pesSubpunctisState;else return torculusState;\n\t        } else return createNeume(new Neumes.Podatus(), false);\n\t      }\n\t    };\n\t\n\t    var clivisState = {\n\t      neume: function neume() {\n\t        return new Neumes.Clivis();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default && currNote.staffPosition > prevNote.staffPosition) return porrectusState;else return createNeume(new Neumes.Clivis(), false);\n\t      }\n\t    };\n\t\n\t    var climacusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Climacus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        if (currNote.shape !== _Exsurge3.NoteShape.Inclinatum) return createNeume(new Neumes.Climacus(), false);else return state;\n\t      }\n\t    };\n\t\n\t    var porrectusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Porrectus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default && currNote.staffPosition < prevNote.staffPosition) return createNeume(new Neumes.PorrectusFlexus(), true);else return createNeume(new Neumes.Porrectus(), false);\n\t      }\n\t    };\n\t\n\t    var pesSubpunctisState = {\n\t      neume: function neume() {\n\t        return new Neumes.PesSubpunctis();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape !== _Exsurge3.NoteShape.Inclinatum) return createNeume(new Neumes.PesSubpunctis(), false);else return state;\n\t      }\n\t    };\n\t\n\t    var salicusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Salicus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.staffPosition < prevNote.staffPosition) return salicusFlexusState;else return createNeume(new Neumes.Salicus(), false);\n\t      }\n\t    };\n\t\n\t    var salicusFlexusState = {\n\t      neume: function neume() {\n\t        return new Neumes.SalicusFlexus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        return createNeume(new Neumes.SalicusFlexus(), false);\n\t      }\n\t    };\n\t\n\t    var scandicusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Scandicus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default && currNote.staffPosition < prevNote.staffPosition) return scandicusFlexusState;else return createNeume(new Neumes.Scandicus(), false);\n\t      }\n\t    };\n\t\n\t    var scandicusFlexusState = {\n\t      neume: function neume() {\n\t        return new Neumes.ScandicusFlexus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        return createNeume(new Neumes.ScandicusFlexus(), false);\n\t      }\n\t    };\n\t\n\t    var virgaState = {\n\t      neume: function neume() {\n\t        return new Neumes.Virga();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Inclinatum && currNote.staffPosition < prevNote.staffPosition) return climacusState;else if (currNote.shape === _Exsurge3.NoteShape.Virga && currNote.staffPosition === prevNote.staffPosition) return bivirgaState;else return createNeume(new Neumes.Virga(), false);\n\t      }\n\t    };\n\t\n\t    var bivirgaState = {\n\t      neume: function neume() {\n\t        return new Neumes.Bivirga();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t\n\t        if (currNote.shape === _Exsurge3.NoteShape.Virga && currNote.staffPosition === prevNote.staffPosition) return createNeume(new Neumes.Trivirga(), false);else return createNeume(new Neumes.Bivirga(), false);\n\t      }\n\t    };\n\t\n\t    var apostrophaState = {\n\t      neume: function neume() {\n\t        return new Neumes.Apostropha();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        if (currNote.staffPosition === prevNote.staffPosition && currNote.shape === _Exsurge3.NoteShape.Stropha) return distrophaState;else return createNeume(new Neumes.Apostropha(), false);\n\t      }\n\t    };\n\t\n\t    var distrophaState = {\n\t      neume: function neume() {\n\t        return new Neumes.Distropha();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        if (currNote.staffPosition === prevNote.staffPosition && currNote.shape === _Exsurge3.NoteShape.Stropha) return createNeume(new Neumes.Tristropha(), true);else return createNeume(new Neumes.Distropha(), false);\n\t      }\n\t    };\n\t\n\t    var torculusState = {\n\t      neume: function neume() {\n\t        return new Neumes.Torculus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default && currNote.staffPosition > prevNote.staffPosition) return torculusResupinusState;else return createNeume(new Neumes.Torculus(), false);\n\t      }\n\t    };\n\t\n\t    var torculusResupinusState = {\n\t      neume: function neume() {\n\t        return new Neumes.TorculusResupinus();\n\t      },\n\t      handle: function handle(currNote, prevNote) {\n\t        if (currNote.shape === _Exsurge3.NoteShape.Default && currNote.staffPosition < prevNote.staffPosition) return createNeume(new Neumes.TorculusResupinusFlexus(), true);else return createNeume(new Neumes.TorculusResupinus(), false);\n\t      }\n\t    };\n\t\n\t    var state = unknownState;\n\t\n\t    while (currNoteIndex < notes.length) {\n\t\n\t      prevNote = currNote;\n\t      currNote = notes[currNoteIndex];\n\t\n\t      state = state.handle(currNote, prevNote);\n\t\n\t      // if we are on the last note, then try to create a neume if we need to.\n\t      if (currNoteIndex === notes.length - 1 && state !== unknownState) createNeume(state.neume(), true);\n\t\n\t      currNoteIndex++;\n\t    }\n\t\n\t    if (neumes.length > 0) {\n\t      if (finalTrailingSpace >= 0) {\n\t        neumes[neumes.length - 1].keepWithNext = true;\n\t        neumes[neumes.length - 1].trailingSpace = finalTrailingSpace;\n\t      }\n\t    }\n\t\n\t    return neumes;\n\t  },\n\t\n\t  createNoteFromData: function createNoteFromData(ctxt, clef, data) {\n\t\n\t    var note = new _Exsurge3.Note();\n\t\n\t    if (data.length < 1) throw 'Invalid note data: ' + data;\n\t\n\t    if (data[0] === '-') {\n\t      // liquescent initio debilis\n\t      note.liquescent = _Exsurge3.LiquescentType.InitioDebilis;\n\t      data = data.substring(1);\n\t    }\n\t\n\t    if (data.length < 1) throw 'Invalid note data: ' + data;\n\t\n\t    // the next char is always the pitch\n\t    var pitch = this.convertGabcStaffPositionToScribamPitch(clef, data[0]);\n\t\n\t    if (data[0] === data[0].toUpperCase()) note.shape = _Exsurge3.NoteShape.Inclinatum;\n\t\n\t    note.staffPosition = this.convertGabcStaffPositionToScribamStaffPosition(clef, data[0]);\n\t    note.pitch = pitch;\n\t\n\t    var mark;\n\t\n\t    // process the modifiers\n\t    for (var i = 1; i < data.length; i++) {\n\t\n\t      var c = data[i];\n\t      var lookahead = '\\0';\n\t\n\t      var haveLookahead = i + 1 < data.length;\n\t      if (haveLookahead) lookahead = data[i + 1];\n\t\n\t      switch (c) {\n\t\n\t        // rhythmic markings\n\t        case '.':\n\t          mark = new Markings.Mora(note, ctxt.staffInterval / 4.0);\n\t          if (haveLookahead && lookahead === '1') mark.positionHint = _Exsurge.MarkingPositionHint.Above;else if (haveLookahead && lookahead === '0') mark.positionHint = _Exsurge.MarkingPositionHint.Below;\n\t\n\t          note.markings.push(mark);\n\t          break;\n\t\n\t        case '_':\n\t          mark = new Markings.HorizontalEpisema(note);\n\t          if (haveLookahead) {\n\t            if (lookahead === '0') mark.positionHint = _Exsurge.MarkingPositionHint.Below;else if (lookahead === '1') mark.positionHint = _Exsurge.MarkingPositionHint.Above;else if (lookahead === '2') mark.terminating = true;\n\t\n\t            // check for another lookahead...\n\t            if (++i + 1 < data.length && data[i + 1] === '2') {\n\t              mark.terminating = true;\n\t              i++;\n\t            }\n\t          }\n\t          note.markings.push(mark);\n\t          break;\n\t\n\t        case '\\'':\n\t          mark = new Markings.Ictus(note);\n\t          if (haveLookahead && lookahead === '1') mark.positionHint = _Exsurge.MarkingPositionHint.Above;else if (haveLookahead && lookahead === '0') mark.positionHint = _Exsurge.MarkingPositionHint.Below;\n\t\n\t          note.markings.push(mark);\n\t          break;\n\t\n\t        //note shapes\n\t        case 'r':\n\t          if (haveLookahead && lookahead === '1') {\n\t            note.markings.push(new Markings.AcuteAccent(note));\n\t            i++;\n\t          } else note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Cavum;\n\t          break;\n\t\n\t        case 's':\n\t          note.shape = _Exsurge3.NoteShape.Stropha;\n\t          break;\n\t\n\t        case 'v':\n\t          note.shape = _Exsurge3.NoteShape.Virga;\n\t          break;\n\t\n\t        case 'w':\n\t          note.shape = _Exsurge3.NoteShape.Quilisma;\n\t          break;\n\t\n\t        case 'o':\n\t          note.shape = _Exsurge3.NoteShape.Oriscus;\n\t          if (haveLookahead && lookahead === '<') {\n\t            note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Ascending;\n\t            i++;\n\t          } else if (haveLookahead && lookahead === '>') {\n\t            note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Descending;\n\t            i++;\n\t          } else note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Ascending;\n\t          break;\n\t\n\t        case 'O':\n\t          note.shape = _Exsurge3.NoteShape.Oriscus;\n\t          if (haveLookahead && lookahead === '<') {\n\t            note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Ascending | _Exsurge3.NoteShapeModifiers.Stemmed;\n\t            i++;\n\t          } else if (haveLookahead && lookahead === '>') {\n\t            note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Descending | _Exsurge3.NoteShapeModifiers.Stemmed;\n\t            i++;\n\t          } else note.shapeModifiers |= _Exsurge3.NoteShapeModifiers.Ascending | _Exsurge3.NoteShapeModifiers.Stemmed;\n\t          break;\n\t\n\t        // liquescents\n\t        case '~':\n\t          if (note.shape === _Exsurge3.NoteShape.Inclinatum) note.liquescent |= _Exsurge3.LiquescentType.Small;else if (note.shape === _Exsurge3.NoteShape.Oriscus) note.liquescent |= _Exsurge3.LiquescentType.Large;else note.liquescent |= _Exsurge3.LiquescentType.Small;\n\t          break;\n\t        case '<':\n\t          note.liquescent |= _Exsurge3.LiquescentType.Ascending;\n\t          break;\n\t        case '>':\n\t          note.liquescent |= _Exsurge3.LiquescentType.Descending;\n\t          break;\n\t\n\t        // accidentals\n\t        case 'x':\n\t          if (note.pitch.step === _Exsurge.Step.Mi) note.pitch.step = _Exsurge.Step.Me;else if (note.pitch.step === _Exsurge.Step.Ti) note.pitch.step = _Exsurge.Step.Te;\n\t          break;\n\t        case 'y':\n\t          if (note.pitch.step === _Exsurge.Step.Te) note.pitch.step = _Exsurge.Step.Ti;else if (note.pitch.step === _Exsurge.Step.Me) note.pitch.step = _Exsurge.Step.Mi;else if (note.pitch.step === _Exsurge.Step.Du) note.pitch.step = _Exsurge.Step.Do;else if (note.pitch.step === _Exsurge.Step.Fu) note.pitch.step = _Exsurge.Step.Fa;\n\t          break;\n\t        case '#':\n\t          if (note.pitch.step === _Exsurge.Step.Do) note.pitch.step = _Exsurge.Step.Du;else if (note.pitch.step === _Exsurge.Step.Fa) note.pitch.step = _Exsurge.Step.Fu;\n\t          break;\n\t      }\n\t    }\n\t\n\t    return note;\n\t  },\n\t\n\t  // returns pitch\n\t  convertGabcStaffPositionToScribamStaffPosition: function convertGabcStaffPositionToScribamStaffPosition(clef, gabcStaffPos) {\n\t    return gabcStaffPos.toLowerCase().charCodeAt(0) - 'a'.charCodeAt(0) - 6;\n\t  },\n\t\n\t  // returns pitch\n\t  convertGabcStaffPositionToScribamPitch: function convertGabcStaffPositionToScribamPitch(clef, gabcStaffPos) {\n\t    var scribamStaffPosition = this.convertGabcStaffPositionToScribamStaffPosition(clef, gabcStaffPos);\n\t\n\t    var pitch = clef.staffPositionToPitch(scribamStaffPosition);\n\t\n\t    if (clef.activeAccidental !== null) clef.activeAccidental.applyToPitch(pitch);\n\t\n\t    return pitch;\n\t  }\n\t};\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Mora = exports.Ictus = exports.HorizontalEpisema = exports.AcuteAccent = exports.Marking = undefined;\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar Exsurge = _interopRequireWildcard(_Exsurge);\n\t\n\tvar _Exsurge2 = __webpack_require__(4);\n\t\n\tvar _Exsurge3 = __webpack_require__(6);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\tvar Marking = exports.Marking = function (_ChantLayoutElement) {\n\t  _inherits(Marking, _ChantLayoutElement);\n\t\n\t  function Marking(note) {\n\t    _classCallCheck(this, Marking);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Marking).call(this));\n\t\n\t    _this.note = note;\n\t    _this.horizontalOffset = 0;\n\t    _this.verticalOffset = 0;\n\t    _this.positionHint = Exsurge.MarkingPositionHint.Default;\n\t\n\t    // each marking has its own visualizer\n\t    _this.visualizer = null;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(Marking, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {}\n\t  }]);\n\t\n\t  return Marking;\n\t}(_Exsurge2.ChantLayoutElement);\n\t\n\tvar AcuteAccent = exports.AcuteAccent = function (_Marking) {\n\t  _inherits(AcuteAccent, _Marking);\n\t\n\t  function AcuteAccent(note) {\n\t    _classCallCheck(this, AcuteAccent);\n\t\n\t    var _this2 = _possibleConstructorReturn(this, Object.getPrototypeOf(AcuteAccent).call(this, note));\n\t\n\t    _this2.positionHint = Exsurge.MarkingPositionHint.Above;\n\t    return _this2;\n\t  }\n\t\n\t  _createClass(AcuteAccent, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      this.visualizer = new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.AcuteAccent);\n\t\n\t      // fixme: acute markings might need to be positioned vertically over\n\t      // the notation bounds of the chantline after everything has already\n\t      // been laid out on the line...for now we just place them a\n\t      // reasonable height above the staff line.\n\t      this.verticalOffset = -ctxt.staffInterval * 5;\n\t      this.horizontalOffset = -this.visualizer.bounds.x; // center on the note itself\n\t\n\t      this.bounds = this.visualizer.bounds.clone();\n\t      this.bounds.x += this.horizontalOffset;\n\t      this.bounds.y += this.verticalOffset;\n\t\n\t      // position the visualizer too...\n\t      this.visualizer.bounds.x = this.bounds.x;\n\t      this.visualizer.bounds.y = this.bounds.y;\n\t\n\t      _get(Object.getPrototypeOf(AcuteAccent.prototype), 'performLayout', this).call(this, ctxt);\n\t    }\n\t  }]);\n\t\n\t  return AcuteAccent;\n\t}(Marking);\n\t\n\t/*\r\n\t * HorizontalEpisema\r\n\t */\n\t\n\t\n\tvar HorizontalEpisema = exports.HorizontalEpisema = function (_Marking2) {\n\t  _inherits(HorizontalEpisema, _Marking2);\n\t\n\t  function HorizontalEpisema(note) {\n\t    _classCallCheck(this, HorizontalEpisema);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(HorizontalEpisema).call(this, note));\n\t  }\n\t\n\t  _createClass(HorizontalEpisema, [{\n\t    key: 'updateY',\n\t    value: function updateY(y) {\n\t      this.bounds.y = y;\n\t      this.visualizer.bounds.y = y;\n\t      this.terminating = false; // indicates if this episema should terminate itself or not\n\t    }\n\t  }, {\n\t    key: 'updateWidth',\n\t    value: function updateWidth(width) {\n\t      this.bounds.width = width;\n\t      this.visualizer.bounds.width = width;\n\t    }\n\t  }, {\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t      _get(Object.getPrototypeOf(HorizontalEpisema.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t      // following logic helps to keep the episemae away from staff lines if they get too close\n\t      // The idea is this: since the staff lines are odd numbered multiples of ctxt.staffInterval,\n\t      // Math.round(y / ctxt.staffInterval) % 2 tells us if we're closer to a space or a line.\n\t      // If it's an odd number then we shift away from line by adding .5 to the step, which puts\n\t      // us the closest we want to be to a line.\n\t\n\t      var y = 0,\n\t          step;\n\t      var minDistanceAway = ctxt.staffInterval * 0.4; // min distance from neume\n\t\n\t      if (this.positionHint === Exsurge.MarkingPositionHint.Below) {\n\t        y = this.note.bounds.bottom() + minDistanceAway; // the highest the line could be at\n\t        step = Math.round(y / ctxt.staffInterval);\n\t\n\t        // if it's an odd step, that means we're near a line, and therefore\n\t        // need to shift down\n\t        if (Math.abs(step % 2) === 1) y = (step + 0.5) * ctxt.staffInterval;\n\t      } else {\n\t        y = this.note.bounds.y - minDistanceAway; // the lowest the line could be at\n\t        step = Math.round(y / ctxt.staffInterval);\n\t\n\t        // if it's an odd step, that means we're near a line, and therefore\n\t        // need to shift up\n\t        if (Math.abs(step % 2) === 1) y = (step - 0.5) * ctxt.staffInterval;\n\t      }\n\t\n\t      var glyphCode = this.note.glyphVisualizer.glyphCode;\n\t      var width;\n\t\n\t      // The porrectus requires special handling of the note width,\n\t      // otherwise the width is just that of the note itself\n\t      if (glyphCode === _Exsurge2.GlyphCode.Porrectus1 || glyphCode === _Exsurge2.GlyphCode.Porrectus2 || glyphCode === _Exsurge2.GlyphCode.Porrectus3 || glyphCode === _Exsurge2.GlyphCode.Porrectus4) width = ctxt.staffInterval;else width = this.note.bounds.width;\n\t\n\t      this.bounds.x = this.note.bounds.x;\n\t      this.bounds.y = y;\n\t      this.bounds.width = width;\n\t      this.bounds.height = ctxt.episemaLineWeight;\n\t\n\t      this.origin.x = 0;\n\t      this.origin.y = 0;\n\t\n\t      this.visualizer = new _Exsurge2.HorizontalEpisemaVisualizer(ctxt, this.note.bounds.x, y, width);\n\t    }\n\t  }]);\n\t\n\t  return HorizontalEpisema;\n\t}(Marking);\n\t\n\t/*\r\n\t * Ictus\r\n\t */\n\t\n\t\n\tvar Ictus = exports.Ictus = function (_Marking3) {\n\t  _inherits(Ictus, _Marking3);\n\t\n\t  function Ictus(note) {\n\t    _classCallCheck(this, Ictus);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(Ictus).call(this, note));\n\t  }\n\t\n\t  _createClass(Ictus, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      var glyphCode;\n\t\n\t      // fixme: this positioning logic doesn't work for the ictus on a virga apparently...?\n\t\n\t      if (this.positionHint === Exsurge.MarkingPositionHint.Above) {\n\t        glyphCode = _Exsurge2.GlyphCode.VerticalEpisemaAbove;\n\t      } else {\n\t        glyphCode = _Exsurge2.GlyphCode.VerticalEpisemaBelow;\n\t      }\n\t\n\t      var staffPosition = this.note.staffPosition;\n\t\n\t      this.horizontalOffset = this.note.bounds.width / 2;\n\t      this.verticalOffset = 0;\n\t\n\t      switch (glyphCode) {\n\t        case _Exsurge2.GlyphCode.VerticalEpisemaAbove:\n\t          if (staffPosition % 2 === 0) this.verticalOffset -= ctxt.staffInterval * 1.5;else this.verticalOffset -= ctxt.staffInterval * .9;\n\t          break;\n\t\n\t        case _Exsurge2.GlyphCode.VerticalEpisemaBelow:\n\t        default:\n\t          if (staffPosition % 2 === 0) this.verticalOffset += ctxt.staffInterval * 1.5;else this.verticalOffset += ctxt.staffInterval * .8;\n\t          break;\n\t      }\n\t\n\t      this.visualizer = new _Exsurge2.GlyphVisualizer(ctxt, glyphCode);\n\t      this.visualizer.setStaffPosition(ctxt, staffPosition);\n\t\n\t      this.bounds = this.visualizer.bounds.clone();\n\t      this.bounds.x = this.note.bounds.x + this.horizontalOffset - this.visualizer.origin.x;\n\t      this.bounds.y += this.verticalOffset;\n\t\n\t      this.visualizer.bounds.x = this.bounds.x;\n\t      this.visualizer.bounds.y = this.bounds.y;\n\t\n\t      _get(Object.getPrototypeOf(Ictus.prototype), 'performLayout', this).call(this, ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Ictus;\n\t}(Marking);\n\t\n\t/*\r\n\t * Mora\r\n\t */\n\t\n\t\n\tvar Mora = exports.Mora = function (_Marking4) {\n\t  _inherits(Mora, _Marking4);\n\t\n\t  function Mora(note, horizontalOffset) {\n\t    _classCallCheck(this, Mora);\n\t\n\t    var _this5 = _possibleConstructorReturn(this, Object.getPrototypeOf(Mora).call(this, note));\n\t\n\t    _this5.horizontalOffset = horizontalOffset;\n\t    return _this5;\n\t  }\n\t\n\t  _createClass(Mora, [{\n\t    key: 'performLayout',\n\t    value: function performLayout(ctxt) {\n\t\n\t      var staffPosition = this.note.staffPosition;\n\t\n\t      this.visualizer = new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.Mora);\n\t      this.visualizer.setStaffPosition(ctxt, staffPosition);\n\t\n\t      this.verticalOffset = 0;\n\t      switch (this.positionHint) {\n\t        case Exsurge.MarkingPositionHint.Below:\n\t          if (staffPosition % 2 === 0) this.verticalOffset += ctxt.staffInterval / 3.0;else this.verticalOffset += ctxt.staffInterval * 2 / 3.0;\n\t          break;\n\t\n\t        case Exsurge.MarkingPositionHint.Default:\n\t        case Exsurge.MarkingPositionHint.Above:\n\t        default:\n\t          if (staffPosition % 2 === 0) this.verticalOffset -= ctxt.staffInterval / 3.0;else this.verticalOffset -= ctxt.staffInterval * 2 / 3.0;\n\t          break;\n\t      }\n\t\n\t      this.bounds = this.visualizer.bounds.clone();\n\t      this.bounds.x += this.note.bounds.right() + this.horizontalOffset;\n\t      this.bounds.y += this.verticalOffset;\n\t\n\t      this.visualizer.bounds.x = this.bounds.x;\n\t      this.visualizer.bounds.y = this.bounds.y;\n\t\n\t      _get(Object.getPrototypeOf(Mora.prototype), 'performLayout', this).call(this, ctxt);\n\t    }\n\t  }]);\n\t\n\t  return Mora;\n\t}(Marking);\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.Virga = exports.Tristropha = exports.TorculusResupinusFlexus = exports.TorculusResupinus = exports.Torculus = exports.TextOnly = exports.ScandicusFlexus = exports.Scandicus = exports.SalicusFlexus = exports.Salicus = exports.Punctum = exports.PorrectusFlexus = exports.Porrectus = exports.Podatus = exports.PesSubpunctis = exports.PesQuassus = exports.Oriscus = exports.Distropha = exports.Clivis = exports.Climacus = exports.Trivirga = exports.Bivirga = exports.Apostropha = exports.Neume = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\t\n\tvar _Exsurge = __webpack_require__(1);\n\t\n\tvar Exsurge = _interopRequireWildcard(_Exsurge);\n\t\n\tvar _Exsurge2 = __webpack_require__(4);\n\t\n\tvar _Exsurge3 = __webpack_require__(6);\n\t\n\tvar _Exsurge4 = __webpack_require__(3);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } //\n\t// Author(s):\n\t// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\n\t//\n\t// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\n\t//\n\t// Permission is hereby granted, free of charge, to any person obtaining a copy\n\t// of this software and associated documentation files (the \"Software\"), to deal\n\t// in the Software without restriction, including without limitation the rights\n\t// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\t// copies of the Software, and to permit persons to whom the Software is\n\t// furnished to do so, subject to the following conditions:\n\t//\n\t// The above copyright notice and this permission notice shall be included in\n\t// all copies or substantial portions of the Software.\n\t//\n\t// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\t// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\t// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\t// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\t// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\t// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\t// THE SOFTWARE.\n\t//\n\t\n\t/*\r\n\t * Neumes base class\r\n\t */\n\t\n\tvar Neume = exports.Neume = function (_ChantNotationElement) {\n\t    _inherits(Neume, _ChantNotationElement);\n\t\n\t    function Neume() {\n\t        _classCallCheck(this, Neume);\n\t\n\t        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Neume).call(this));\n\t\n\t        _this.notes = [];\n\t        return _this;\n\t    }\n\t\n\t    _createClass(Neume, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Neume.prototype), 'performLayout', this).call(this, ctxt);\n\t        }\n\t    }, {\n\t        key: 'finishLayout',\n\t        value: function finishLayout(ctxt) {\n\t\n\t            // allow subclasses an opportunity position their own markings...\n\t            this.positionMarkings();\n\t\n\t            // layout the markings of the notes\n\t            for (var i = 0; i < this.notes.length; i++) {\n\t                var note = this.notes[i];\n\t\n\t                for (var j = 0; j < note.markings.length; j++) {\n\t                    var marking = note.markings[j];\n\t\n\t                    marking.performLayout(ctxt);\n\t                    this.addVisualizer(marking.visualizer);\n\t                }\n\t            }\n\t\n\t            _get(Object.getPrototypeOf(Neume.prototype), 'finishLayout', this).call(this, ctxt);\n\t        }\n\t\n\t        // subclasses can override this in order to correctly place markings in a neume specific way\n\t\n\t    }, {\n\t        key: 'positionMarkings',\n\t        value: function positionMarkings() {}\n\t    }, {\n\t        key: 'layoutNotesAsPodatus',\n\t        value: function layoutNotesAsPodatus(ctxt, lowerNote, upperNote, startingX) {\n\t\n\t            startingX = startingX || 0;\n\t\n\t            var overhangUpperNote = true;\n\t\n\t            if (lowerNote.liquescent === _Exsurge3.LiquescentType.InitioDebilis) {\n\t\n\t                // liquescent upper note or not?\n\t                if (upperNote.liquescent === _Exsurge3.LiquescentType.None) upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);else upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);\n\t\n\t                lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingDesLiquescent);\n\t                overhangUpperNote = false;\n\t            } else if (upperNote.liquescent === _Exsurge3.LiquescentType.LargeAscending) {\n\t                lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t                upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);\n\t                overhangUpperNote = false;\n\t            } else if (upperNote.liquescent === _Exsurge3.LiquescentType.LargeDescending) {\n\t                lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t                upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);\n\t                overhangUpperNote = false;\n\t            } else if (upperNote.liquescent === _Exsurge3.LiquescentType.SmallAscending) {\n\t                lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.BeginningAscLiquescent);\n\t                upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);\n\t            } else {\n\t                // standard shape\n\t                lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusLower);\n\t                upperNote.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusUpper);\n\t            }\n\t\n\t            // allow a quilisma pes\n\t            if (lowerNote.shape === _Exsurge3.NoteShape.Quilisma) lowerNote.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);\n\t\n\t            lowerNote.bounds.x = startingX;\n\t\n\t            var line = new _Exsurge2.NeumeLineVisualizer(ctxt, lowerNote, upperNote, false);\n\t            line.bounds.x = lowerNote.bounds.right() - line.bounds.width;\n\t            this.addVisualizer(line);\n\t\n\t            // if it's overhanging, then right align the glyph\n\t            if (overhangUpperNote === true) upperNote.bounds.x += line.bounds.right() - upperNote.bounds.width;else upperNote.bounds.x += line.bounds.x;\n\t\n\t            // add the elements\n\t            this.addVisualizer(lowerNote);\n\t            this.addVisualizer(upperNote);\n\t        }\n\t\n\t        // lays out a sequence of notes that are inclinati (e.g., climacus, pes subpunctis)\n\t\n\t    }, {\n\t        key: 'layoutNotesAsInclinati',\n\t        value: function layoutNotesAsInclinati(ctxt, notes, startingX) {\n\t\n\t            var staffPosition = notes[0].staffPosition,\n\t                prevStaffPosition = notes[0].staffPosition;\n\t\n\t            // it is important to advance by the width of the inclinatum glyph itself\n\t            // rather than by individual note widths, so that any liquescents are spaced\n\t            // the same as non-liquscents\n\t            var advanceWidth = _Exsurge4.Glyphs.PunctumInclinatum.bounds.width * ctxt.glyphScaling;\n\t\n\t            // now add all the punctum inclinati\n\t            for (var i = 0; i < notes.length; i++, prevStaffPosition = staffPosition) {\n\t                var note = notes[i];\n\t\n\t                if (note.liquescent === _Exsurge3.LiquescentType.LargeAscending || note.liquescent === _Exsurge3.LiquescentType.LargeDescending)\n\t                    // fixme: is the large inclinatum liquescent the same as the apostropha?\n\t                    note.setGlyph(ctxt, _Exsurge2.GlyphCode.Apostropha);else if (note.liquescent === _Exsurge3.LiquescentType.SmallAscending || note.liquescent === _Exsurge3.LiquescentType.SmallDescending) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumInclinatumLiquescent);else\n\t                    // fixme: some climaci in the new chant books end with a punctum cuadratum\n\t                    // (see, for example, the antiphon \"Sancta Maria\" for October 7).\n\t                    note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumInclinatum);\n\t\n\t                staffPosition = note.staffPosition;\n\t\n\t                // fixme: how do these calculations look for puncti inclinati based on staff position offsets?\n\t                var multiple;\n\t                switch (Math.abs(prevStaffPosition - staffPosition)) {\n\t                    case 0:\n\t                        multiple = 0;\n\t                        break;\n\t                    case 1:\n\t                        multiple = 0.8;\n\t                        break;\n\t                    default:\n\t                        multiple = 1.2;\n\t                        break;\n\t                }\n\t\n\t                startingX += advanceWidth * multiple;\n\t                note.bounds.x += startingX;\n\t\n\t                this.addVisualizer(note);\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return Neume;\n\t}(_Exsurge2.ChantNotationElement);\n\t\n\t/*\r\n\t * Apostropha\r\n\t */\n\t\n\t\n\tvar Apostropha = exports.Apostropha = function (_Neume) {\n\t    _inherits(Apostropha, _Neume);\n\t\n\t    function Apostropha() {\n\t        _classCallCheck(this, Apostropha);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Apostropha).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Apostropha, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Apostropha.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // determine the glyph to use\n\t            var note = this.notes[0];\n\t\n\t            if (note.liquescent !== _Exsurge3.LiquescentType.None) note.setGlyph(ctxt, _Exsurge2.GlyphCode.StrophaLiquescent);else note.setGlyph(ctxt, _Exsurge2.GlyphCode.Stropha);\n\t\n\t            this.addVisualizer(note);\n\t\n\t            this.origin.x = note.origin.x;\n\t            this.origin.y = note.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }], [{\n\t        key: 'determineNoteGlyphCode',\n\t        value: function determineNoteGlyphCode(note) {\n\t\n\t            if (note.shape === _Exsurge3.NoteShape.Stropha) return _Exsurge2.GlyphCode.Stropha;\n\t\n\t            if (note.shapeModifiers & _Exsurge3.NoteShapeModifiers.Cavum) return _Exsurge2.GlyphCode.PunctumCavum;\n\t\n\t            return _Exsurge2.GlyphCode.PunctumCuadratum;\n\t        }\n\t    }]);\n\t\n\t    return Apostropha;\n\t}(Neume);\n\t\n\t/*\r\n\t * Bivirga\r\n\t *\r\n\t * For simplicity in implementation, Bivirga's have two notes in the object\r\n\t * structure. These technically must be the same pitch though.\r\n\t */\n\t\n\t\n\tvar Bivirga = exports.Bivirga = function (_Neume2) {\n\t    _inherits(Bivirga, _Neume2);\n\t\n\t    function Bivirga() {\n\t        _classCallCheck(this, Bivirga);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Bivirga).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Bivirga, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Bivirga.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note1 = this.notes[0];\n\t            var note2 = this.notes[1];\n\t\n\t            note1.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\n\t            note2.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\n\t\n\t            note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\n\t\n\t            this.addVisualizer(note1);\n\t            this.addVisualizer(note2);\n\t\n\t            this.origin.x = note1.origin.x;\n\t            this.origin.y = note1.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Bivirga;\n\t}(Neume);\n\t\n\t/*\r\n\t * Trivirga\r\n\t *\r\n\t * For simplicity in implementation, Trivirga's have three notes in the object\r\n\t * structure. These technically must be the same pitch though.\r\n\t */\n\t\n\t\n\tvar Trivirga = exports.Trivirga = function (_Neume3) {\n\t    _inherits(Trivirga, _Neume3);\n\t\n\t    function Trivirga() {\n\t        _classCallCheck(this, Trivirga);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Trivirga).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Trivirga, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Trivirga.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note1 = this.notes[0];\n\t            var note2 = this.notes[1];\n\t            var note3 = this.notes[2];\n\t\n\t            note1.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\n\t            note2.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\n\t            note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\n\t\n\t            note3.setGlyph(ctxt, Virga.getGlyphCode(staffPosition));\n\t            note3.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing + note2.bounds.width + ctxt.intraNeumeSpacing;\n\t\n\t            this.addVisualizer(note1);\n\t            this.addVisualizer(note2);\n\t            this.addVisualizer(note3);\n\t\n\t            this.origin.x = note1.origin.x;\n\t            this.origin.y = note1.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Trivirga;\n\t}(Neume);\n\t\n\t/*\r\n\t * Climacus\r\n\t */\n\t\n\t\n\tvar Climacus = exports.Climacus = function (_Neume4) {\n\t    _inherits(Climacus, _Neume4);\n\t\n\t    function Climacus() {\n\t        _classCallCheck(this, Climacus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Climacus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Climacus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Climacus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // the first note is always a virga...\n\t            var virga = this.notes[0];\n\t            virga.setGlyph(ctxt, Virga.getGlyphCode(virga.staffPosition));\n\t\n\t            this.addVisualizer(virga);\n\t\n\t            this.layoutNotesAsInclinati(ctxt, this.notes.slice(1), virga.bounds.right() + ctxt.intraNeumeSpacing / 2);\n\t\n\t            this.origin.x = virga.origin.x;\n\t            this.origin.y = virga.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Climacus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Clivis\r\n\t */\n\t\n\t\n\tvar Clivis = exports.Clivis = function (_Neume5) {\n\t    _inherits(Clivis, _Neume5);\n\t\n\t    function Clivis() {\n\t        _classCallCheck(this, Clivis);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Clivis).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Clivis, [{\n\t        key: 'positionMarkings',\n\t        value: function positionMarkings() {\n\t\n\t            var hasLowerMora = false;\n\t            var marking, i;\n\t\n\t            // 1. morae need to be lined up if both notes have morae\n\t            // 2. like the podatus, mora on lower note needs to below\n\t            //    under certain circumstances\n\t            for (i = 0; i < this.notes[1].markings.length; i++) {\n\t                marking = this.notes[1].markings[i];\n\t\n\t                if (marking.constructor.name === 'Mora') {\n\t\n\t                    hasLowerMora = true;\n\t\n\t                    if (this.notes[0].staffPosition - this.notes[1].staffPosition === 1 && Math.abs(this.notes[1].staffPosition % 2) === 1) marking.positionHint = Exsurge.MarkingPositionHint.Below;\n\t                }\n\t            }\n\t\n\t            for (i = 0; i < this.notes[0].markings.length; i++) {\n\t                marking = this.notes[0].markings[i];\n\t\n\t                if (marking.constructor.name === 'Mora' && hasLowerMora) {\n\t                    marking.positionHint = Exsurge.MarkingPositionHint.Above;\n\t                    marking.horizontalOffset += this.notes[1].bounds.right() - this.notes[0].bounds.right();\n\t                }\n\t            }\n\t        }\n\t    }, {\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Clivis.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var line;\n\t\n\t            var upper = this.notes[0];\n\t            var lower = this.notes[1];\n\t\n\t            if (upper.shape === _Exsurge3.NoteShape.Oriscus) upper.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusDes);else {\n\t                upper.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t                // add an ascending line\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, lower, upper, true);\n\t                line.bounds.x = upper.bounds.x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            if (lower.liquescent & _Exsurge3.LiquescentType.Small) {\n\t                lower.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingDesLiquescent);\n\t                lower.bounds.x -= lower.bounds.width; // right aligned\n\t            } else if (lower.liquescent === _Exsurge3.LiquescentType.Ascending) lower.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);else if (lower.liquescent === _Exsurge3.LiquescentType.Descending) lower.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else lower.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            var x = upper.bounds.right();\n\t\n\t            // do we need to draw a descending line?\n\t            if (upper.staffPosition - lower.staffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, upper, lower, false);\n\t                line.bounds.x = x - line.bounds.width;\n\t                this.addVisualizer(line);\n\t\n\t                if (!(lower.liquescent & _Exsurge3.LiquescentType.Small)) x -= line.bounds.width;\n\t            }\n\t\n\t            lower.bounds.x += x;\n\t\n\t            this.addVisualizer(upper);\n\t            this.addVisualizer(lower);\n\t\n\t            this.origin.x = upper.origin.x;\n\t            this.origin.y = upper.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Clivis;\n\t}(Neume);\n\t\n\t/*\r\n\t * Distropha\r\n\t *\r\n\t * For simplicity in implementation, Distropha's have two notes in the object\r\n\t * structure. These technically must be the same pitch though (like Bivirga).\r\n\t */\n\t\n\t\n\tvar Distropha = exports.Distropha = function (_Neume6) {\n\t    _inherits(Distropha, _Neume6);\n\t\n\t    function Distropha() {\n\t        _classCallCheck(this, Distropha);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Distropha).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Distropha, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Distropha.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note1 = this.notes[0];\n\t            var note2 = this.notes[1];\n\t\n\t            note1.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note1));\n\t            note2.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note2));\n\t            note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\n\t\n\t            this.addVisualizer(note1);\n\t            this.addVisualizer(note2);\n\t\n\t            this.origin.x = note1.origin.x;\n\t            this.origin.y = note1.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Distropha;\n\t}(Neume);\n\t\n\t/*\r\n\t * Oriscus\r\n\t */\n\t\n\t\n\tvar Oriscus = exports.Oriscus = function (_Neume7) {\n\t    _inherits(Oriscus, _Neume7);\n\t\n\t    function Oriscus() {\n\t        _classCallCheck(this, Oriscus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Oriscus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Oriscus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Oriscus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // determine the glyph to use\n\t            var note = this.notes[0];\n\t\n\t            if (note.liquescent !== _Exsurge3.LiquescentType.None) {\n\t                note.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusLiquescent);\n\t            } else {\n\t                if (note.shapeModifiers & _Exsurge3.NoteShapeModifiers.Ascending) note.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusAsc);else note.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusDes);\n\t            }\n\t\n\t            this.addVisualizer(note);\n\t\n\t            this.origin.x = note.origin.x;\n\t            this.origin.y = note.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Oriscus;\n\t}(Neume);\n\t\n\t/*\r\n\t * PesQuassus\r\n\t */\n\t\n\t\n\tvar PesQuassus = exports.PesQuassus = function (_Neume8) {\n\t    _inherits(PesQuassus, _Neume8);\n\t\n\t    function PesQuassus() {\n\t        _classCallCheck(this, PesQuassus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(PesQuassus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(PesQuassus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(PesQuassus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var x = 0;\n\t\n\t            var lower = this.notes[0];\n\t            var upper = this.notes[1];\n\t            var line;\n\t\n\t            var lowerStaffPos = lower.staffPosition;\n\t            var upperStaffPos = upper.staffPosition;\n\t\n\t            if (lower.shape === _Exsurge3.NoteShape.Oriscus) lower.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusAsc);else lower.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            if (upper.liquescent === _Exsurge3.LiquescentType.LargeDescending) upper.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else upper.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            lower.bounds.x = x;\n\t            this.addVisualizer(lower);\n\t\n\t            x += lower.bounds.right();\n\t\n\t            var needsLines = upperStaffPos - lowerStaffPos > 1;\n\t            if (needsLines) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, lower, upper, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            upper.bounds.x = x;\n\t\n\t            upper.bounds.x = x;\n\t            this.addVisualizer(upper);\n\t\n\t            x += upper.bounds.width;\n\t\n\t            // add a hanging line if we need it\n\t            if (needsLines) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, upper, lower, true);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            this.origin.x = lower.origin.x;\n\t            this.origin.y = lower.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return PesQuassus;\n\t}(Neume);\n\t\n\t/*\r\n\t * PesSubpunctis\r\n\t */\n\t\n\t\n\tvar PesSubpunctis = exports.PesSubpunctis = function (_Neume9) {\n\t    _inherits(PesSubpunctis, _Neume9);\n\t\n\t    function PesSubpunctis() {\n\t        _classCallCheck(this, PesSubpunctis);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(PesSubpunctis).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(PesSubpunctis, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(PesSubpunctis.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // layout is a podatus followed by inclinati\n\t            this.layoutNotesAsPodatus(ctxt, this.notes[0], this.notes[1]);\n\t            this.layoutNotesAsInclinati(ctxt, this.notes.slice(2), this.notes[0].bounds.right() + ctxt.intraNeumeSpacing / 2);\n\t\n\t            this.origin.x = this.notes[0].origin.x;\n\t            this.origin.y = this.notes[0].origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return PesSubpunctis;\n\t}(Neume);\n\t\n\t/*\r\n\t * Podatus\r\n\t *\r\n\t * This podatus class handles a few neume types actually, depending on the note\r\n\t * data: Podatus (including various liquescent types on the upper note),\r\n\t * Podatus initio debilis, and Quilisma-Pes\r\n\t */\n\t\n\t\n\tvar Podatus = exports.Podatus = function (_Neume10) {\n\t    _inherits(Podatus, _Neume10);\n\t\n\t    function Podatus() {\n\t        _classCallCheck(this, Podatus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Podatus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Podatus, [{\n\t        key: 'positionMarkings',\n\t        value: function positionMarkings() {\n\t            var marking, i;\n\t\n\t            // 1. episema on lower note should always be below, upper note above\n\t            // 2. morae:\n\t            //   a. if podatus difference is 1 and lower note is on a line,\n\t            //      the lower mora should be below\n\t            for (i = 0; i < this.notes[0].markings.length; i++) {\n\t                marking = this.notes[0].markings[i];\n\t\n\t                if (marking.constructor.name === 'HorizontalEpisema') marking.positionHint = Exsurge.MarkingPositionHint.Below;else if (marking.constructor.name === 'Mora' && this.notes[1].staffPosition - this.notes[0].staffPosition === 1 && Math.abs(this.notes[0].staffPosition % 2) === 1) marking.positionHint = Exsurge.MarkingPositionHint.Below;\n\t            }\n\t\n\t            for (i = 0; i < this.notes[1].markings.length; i++) {\n\t                marking = this.notes[1].markings[i];\n\t\n\t                if (marking.constructor.name === 'HorizontalEpisema') marking.positionHint = Exsurge.MarkingPositionHint.Above;\n\t            }\n\t        }\n\t    }, {\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Podatus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            this.layoutNotesAsPodatus(ctxt, this.notes[0], this.notes[1]);\n\t\n\t            this.origin.x = this.notes[0].origin.x;\n\t            this.origin.y = this.notes[0].origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Podatus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Porrectus\r\n\t */\n\t\n\t\n\tvar Porrectus = exports.Porrectus = function (_Neume11) {\n\t    _inherits(Porrectus, _Neume11);\n\t\n\t    function Porrectus() {\n\t        _classCallCheck(this, Porrectus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Porrectus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Porrectus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Porrectus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var line;\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var x = 0.0;\n\t\n\t            var firstStaffPosition = first.staffPosition;\n\t            var secondStaffPosition = second.staffPosition;\n\t            var thirdStaffPosition = third.staffPosition;\n\t\n\t            switch (firstStaffPosition - secondStaffPosition) {\n\t                case 1:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus1);\n\t                    break;\n\t                case 2:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus2);\n\t                    break;\n\t                case 3:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus3);\n\t                    break;\n\t                case 4:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus4);\n\t                    break;\n\t                default:\n\t                    // fixme: should we generate an error here?\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t                    break;\n\t            }\n\t\n\t            // the second glyph does not draw anything, but it still has logical importance for the editing\n\t            // environment...it can respond to changes which will then change the swash glyph of the first.\n\t            second.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t\n\t            // add the first line and the swash\n\t            line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, true);\n\t\n\t            line.bounds.x = first.bounds.x;\n\t            x = first.bounds.right();\n\t            second.bounds.x = x - second.bounds.width;\n\t            x = second.bounds.right();\n\t\n\t            this.addVisualizer(line);\n\t            this.addVisualizer(first);\n\t            this.addVisualizer(second);\n\t\n\t            // add the connecting line\n\t            if (thirdStaffPosition - secondStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            var overhangThirdNote = true;\n\t\n\t            if (third.liquescent === _Exsurge3.LiquescentType.SmallAscending) third.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);else if (third.liquescent === _Exsurge3.LiquescentType.LargeDescending) {\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);\n\t                overhangThirdNote = false;\n\t            } else third.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusUpper);\n\t\n\t            if (overhangThirdNote) third.bounds.x = second.bounds.right() - third.bounds.width;else third.bounds.x = x;\n\t\n\t            this.addVisualizer(third);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Porrectus;\n\t}(Neume);\n\t\n\t/*\r\n\t * PorrectusFlexus\r\n\t */\n\t\n\t\n\tvar PorrectusFlexus = exports.PorrectusFlexus = function (_Neume12) {\n\t    _inherits(PorrectusFlexus, _Neume12);\n\t\n\t    function PorrectusFlexus() {\n\t        _classCallCheck(this, PorrectusFlexus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(PorrectusFlexus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(PorrectusFlexus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(PorrectusFlexus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var line;\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var fourth = this.notes[3];\n\t            var x = 0;\n\t\n\t            var firstStaffPosition = first.staffPosition;\n\t            var secondStaffPosition = second.staffPosition;\n\t            var thirdStaffPosition = third.staffPosition;\n\t            var fourthStaffPosition = fourth.staffPosition;\n\t\n\t            switch (firstStaffPosition - secondStaffPosition) {\n\t                case 1:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus1);\n\t                    break;\n\t                case 2:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus2);\n\t                    break;\n\t                case 3:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus3);\n\t                    break;\n\t                case 4:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus4);\n\t                    break;\n\t                default:\n\t                    // fixme: should we generate an error here?\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t                    break;\n\t            }\n\t\n\t            // add the first line and the swash\n\t            line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, true);\n\t\n\t            x = line.bounds.x = first.bounds.x;\n\t            x = first.bounds.right();\n\t            this.addVisualizer(line);\n\t            this.addVisualizer(first);\n\t\n\t            // the second glyph does not draw anything, but it still has logical importance for the editing\n\t            // environment...it can respond to changes which will then change the swash glyph of the first.\n\t            second.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t            second.bounds.x = x;\n\t            x = second.bounds.right();\n\t            this.addVisualizer(second);\n\t\n\t            // add a connecting line\n\t            if (thirdStaffPosition - secondStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x += x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            third.bounds.x = x;\n\t            x = third.bounds.right();\n\t            this.addVisualizer(third);\n\t\n\t            // add a connecting line\n\t            if (thirdStaffPosition - fourthStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, third, fourth, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x += x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            fourth.bounds.x = x;\n\t            this.addVisualizer(fourth);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return PorrectusFlexus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Punctum\r\n\t */\n\t\n\t\n\tvar Punctum = exports.Punctum = function (_Neume13) {\n\t    _inherits(Punctum, _Neume13);\n\t\n\t    function Punctum() {\n\t        _classCallCheck(this, Punctum);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Punctum).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Punctum, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Punctum.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // determine the glyph to use\n\t\n\t            var note = this.notes[0];\n\t\n\t            if (note.liquescent !== _Exsurge3.LiquescentType.None) {\n\t                if (note.shape === _Exsurge3.NoteShape.Inclinatum) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumInclinatumLiquescent);else if (note.shape === _Exsurge3.NoteShape.Oriscus) note.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusLiquescent);else if (note.liquescent === _Exsurge3.LiquescentType.LargeAscending) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);else if (note.liquescent === _Exsurge3.LiquescentType.LargeDescending) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);\n\t            } else {\n\t\n\t                if (note.shapeModifiers & _Exsurge3.NoteShapeModifiers.Cavum) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCavum);else if (note.shape === _Exsurge3.NoteShape.Inclinatum) note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumInclinatum);else if (note.shape === _Exsurge3.NoteShape.Quilisma) note.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);else note.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            }\n\t\n\t            this.addVisualizer(note);\n\t\n\t            this.origin.x = note.origin.x;\n\t            this.origin.y = note.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Punctum;\n\t}(Neume);\n\t\n\t/*\r\n\t * Scandicus\r\n\t */\n\t\n\t\n\tvar Salicus = exports.Salicus = function (_Neume14) {\n\t    _inherits(Salicus, _Neume14);\n\t\n\t    function Salicus() {\n\t        _classCallCheck(this, Salicus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Salicus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Salicus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Salicus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t\n\t            var x = 0;\n\t\n\t            // first note of a salicus is always a punctum cuadratum\n\t            first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            x += first.bounds.width;\n\t\n\t            // if the next note doesn't require a stem connector, then add a tad bit\n\t            // of spacing here\n\t            if (!(second.shapeModifiers & _Exsurge3.NoteShapeModifiers.Stemmed)) x += ctxt.intraNeumeSpacing;\n\t\n\t            // second note is always an oriscus, which may or may not be stemmed\n\t            // to the first\n\t            second.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusAsc);\n\t\n\t            // do we need a line between first and second notes?\n\t            if (second.shapeModifiers & _Exsurge3.NoteShapeModifiers.Stemmed && second.staffPosition - first.staffPosition > 1) {\n\t                // need stem when notes are greater than 1 space apart\n\t\n\t                var line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            second.bounds.x = x;\n\t            x += second.bounds.width;\n\t\n\t            // third note can be a punctum cuadratum or various liquescent forms\n\t            if (third.liquescent === _Exsurge3.LiquescentType.LargeAscending) third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);else if (third.liquescent === _Exsurge3.LiquescentType.LargeDescending) third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else if (third.liquescent & _Exsurge3.LiquescentType.Small) {\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);\n\t                third.bounds.x -= third.bounds.width; // right aligned\n\t            } else {\n\t                    // virga terminator\n\t                    third.setGlyph(ctxt, Virga.getGlyphCode(third.staffPosition));\n\t                }\n\t\n\t            // do we need a line between second and third notes?\n\t            if (third.staffPosition - second.staffPosition > 1) {\n\t\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t                line.bounds.x = second.bounds.right() - line.bounds.width;\n\t                this.addVisualizer(line);\n\t\n\t                if (!(third.liquescent & _Exsurge3.LiquescentType.Small)) x -= line.bounds.width;\n\t            }\n\t\n\t            third.bounds.x += x;\n\t\n\t            // add the note elements\n\t            this.addVisualizer(first);\n\t            this.addVisualizer(second);\n\t            this.addVisualizer(third);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Salicus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Scandicus\r\n\t */\n\t\n\t\n\tvar SalicusFlexus = exports.SalicusFlexus = function (_Neume15) {\n\t    _inherits(SalicusFlexus, _Neume15);\n\t\n\t    function SalicusFlexus() {\n\t        _classCallCheck(this, SalicusFlexus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(SalicusFlexus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(SalicusFlexus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(SalicusFlexus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var fourth = this.notes[3];\n\t\n\t            var x = 0;\n\t\n\t            // first note of a salicus is always a punctum cuadratum\n\t            first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            x += first.bounds.width;\n\t\n\t            // if the next note doesn't require a stem connector, then add a tad bit\n\t            // of spacing here\n\t            if (!(second.shapeModifiers & _Exsurge3.NoteShapeModifiers.Stemmed)) x += ctxt.intraNeumeSpacing;\n\t\n\t            // second note is always an oriscus, which may or may not be stemmed\n\t            // to the first\n\t            second.setGlyph(ctxt, _Exsurge2.GlyphCode.OriscusAsc);\n\t\n\t            // do we need a line between first and second notes?\n\t            if (second.shapeModifiers & _Exsurge3.NoteShapeModifiers.Stemmed && second.staffPosition - first.staffPosition > 1) {\n\t                // need stem when notes are greater than 1 space apart\n\t\n\t                var line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            second.bounds.x = x;\n\t            x += second.bounds.width;\n\t\n\t            // third note can be a punctum cuadratum or various liquescent forms,\n\t            // ...based on note four though!\n\t            if (fourth.liquescent & _Exsurge3.LiquescentType.Small) third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else third.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            // do we need a line between second and third notes?\n\t            if (third.staffPosition - second.staffPosition > 1) {\n\t\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t                line.bounds.x = second.bounds.right() - line.bounds.width;\n\t                this.addVisualizer(line);\n\t\n\t                x -= line.bounds.width;\n\t            }\n\t\n\t            third.bounds.x += x;\n\t            x += third.bounds.width;\n\t\n\t            // finally, do the fourth note\n\t            if (fourth.liquescent === _Exsurge3.LiquescentType.LargeAscending) fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);else if (fourth.liquescent === _Exsurge3.LiquescentType.LargeDescending) fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else if (fourth.liquescent & _Exsurge3.LiquescentType.Small) {\n\t                fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingDesLiquescent);\n\t                fourth.bounds.x -= fourth.bounds.width; // right-aligned\n\t            } else fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            // do we need a line between second and third notes?\n\t            if (third.staffPosition - fourth.staffPosition > 1) {\n\t\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, third, fourth, false);\n\t                line.bounds.x = third.bounds.right() - line.bounds.width;\n\t                this.addVisualizer(line);\n\t\n\t                if (!(fourth.liquescent & _Exsurge3.LiquescentType.Small)) x -= line.bounds.width;\n\t            }\n\t\n\t            fourth.bounds.x += x;\n\t\n\t            // add the note elements\n\t            this.addVisualizer(first);\n\t            this.addVisualizer(second);\n\t            this.addVisualizer(third);\n\t            this.addVisualizer(fourth);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return SalicusFlexus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Scandicus\r\n\t */\n\t\n\t\n\tvar Scandicus = exports.Scandicus = function (_Neume16) {\n\t    _inherits(Scandicus, _Neume16);\n\t\n\t    function Scandicus() {\n\t        _classCallCheck(this, Scandicus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Scandicus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Scandicus, [{\n\t        key: 'performLayout',\n\t\n\t\n\t        // fixme: for now, we render the scandicus as a punctum followed by a podatus. however,\n\t        // it could also be a podatus followed by a virga...see LU, \"Preface,\" xj.\n\t        //\n\t        // perhaps the best way to indicate the virga form is to check if the note shape of\n\t        // the third note is a virga!\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Scandicus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t\n\t            first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            if (second.isLiquescent || third.isLiquescent) {\n\t                second.setGlyph(ctxt, _Exsurge2.GlyphCode.BeginningAscLiquescent);\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);\n\t            } else {\n\t                second.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusLower);\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusUpper);\n\t            }\n\t\n\t            // fixme: can a scandicus have a quilisma like this?\n\t            if (second.shape === _Exsurge3.NoteShape.Quilisma) second.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);\n\t\n\t            var line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t\n\t            second.bounds.x = first.bounds.right();\n\t            line.bounds.x = second.bounds.right() - line.bounds.width;\n\t            third.bounds.x = second.bounds.right() - third.bounds.width;\n\t\n\t            // add the elements\n\t            this.addVisualizer(first);\n\t            this.addVisualizer(second);\n\t            this.addVisualizer(line);\n\t            this.addVisualizer(third);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Scandicus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Scandicus Flexus\r\n\t */\n\t\n\t\n\tvar ScandicusFlexus = exports.ScandicusFlexus = function (_Neume17) {\n\t    _inherits(ScandicusFlexus, _Neume17);\n\t\n\t    function ScandicusFlexus() {\n\t        _classCallCheck(this, ScandicusFlexus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(ScandicusFlexus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(ScandicusFlexus, [{\n\t        key: 'performLayout',\n\t\n\t\n\t        // see notes in Scandicus about determining the first three notes.\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(ScandicusFlexus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var fourth = this.notes[3];\n\t\n\t            first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            if (second.isLiquescent || third.isLiquescent) {\n\t                second.setGlyph(ctxt, _Exsurge2.GlyphCode.BeginningAscLiquescent);\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);\n\t            } else {\n\t                second.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusLower);\n\t                third.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusUpper);\n\t            }\n\t\n\t            // fixme: can a scandicus have a quilisma like this?\n\t            if (second.shape === _Exsurge3.NoteShape.Quilisma) second.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);\n\t\n\t            var line = new _Exsurge2.NeumeLineVisualizer(ctxt, second, third, false);\n\t\n\t            second.bounds.x = first.bounds.right();\n\t            line.bounds.x = second.bounds.right() - line.bounds.width;\n\t            third.bounds.x = second.bounds.right() - third.bounds.width;\n\t            fourth.bounds.x = third.bounds.right();\n\t\n\t            // do we need to draw a descending line?\n\t            var staffPos3 = third.staffPosition;\n\t            var staffPos4 = fourth.staffPosition;\n\t            if (staffPos3 - staffPos4 > 1) {\n\t                var extraLine = new _Exsurge2.NeumeLineVisualizer(ctxt, third, fourth, false);\n\t                fourth.bounds.x -= extraLine.bounds.width;\n\t                extraLine.bounds.x -= extraLine.bounds.width;\n\t                this.addVisualizer(extraLine);\n\t            }\n\t\n\t            // add the elements\n\t            this.addVisualizer(first);\n\t            this.addVisualizer(second);\n\t            this.addVisualizer(line);\n\t            this.addVisualizer(third);\n\t            this.addVisualizer(fourth);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return ScandicusFlexus;\n\t}(Neume);\n\t\n\t/*\r\n\t * TextOnly\r\n\t */\n\t\n\t\n\tvar TextOnly = exports.TextOnly = function (_Neume18) {\n\t    _inherits(TextOnly, _Neume18);\n\t\n\t    function TextOnly() {\n\t        _classCallCheck(this, TextOnly);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(TextOnly).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(TextOnly, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(TextOnly.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            // add an empty glyph as a placeholder\n\t            this.addVisualizer(new _Exsurge2.GlyphVisualizer(ctxt, _Exsurge2.GlyphCode.None));\n\t\n\t            this.origin.x = 0;\n\t            this.origin.y = 0;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return TextOnly;\n\t}(Neume);\n\t\n\t/*\r\n\t * Torculus\r\n\t */\n\t\n\t\n\tvar Torculus = exports.Torculus = function (_Neume19) {\n\t    _inherits(Torculus, _Neume19);\n\t\n\t    function Torculus() {\n\t        _classCallCheck(this, Torculus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Torculus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Torculus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Torculus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note1 = this.notes[0];\n\t            var note2 = this.notes[1];\n\t            var note3 = this.notes[2];\n\t            var drawFirstLine = note2.staffPosition - note1.staffPosition > 1;\n\t            var line;\n\t\n\t            if (note1.liquescent === _Exsurge3.LiquescentType.InitioDebilis) {\n\t                note1.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingDesLiquescent);\n\t                drawFirstLine = true; // always draw first line with an initio debilis\n\t            } else note1.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            note2.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            if (note3.liquescent & _Exsurge3.LiquescentType.Small) {\n\t                note3.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingDesLiquescent);\n\t                note3.bounds.x -= note3.bounds.width; // right aligned\n\t            } else if (note3.liquescent & _Exsurge3.LiquescentType.Ascending) note3.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumAscLiquescent);else if (note3.liquescent & _Exsurge3.LiquescentType.Descending) note3.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratumDesLiquescent);else note3.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t\n\t            var x = note1.bounds.right();\n\t\n\t            // do we need to draw the first (ascending) line?\n\t            if (drawFirstLine) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, note1, note2, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            note2.bounds.x += x;\n\t            x += note2.bounds.width;\n\t\n\t            // do we need to draw a descending line?\n\t            if (note2.staffPosition - note3.staffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, note2, note3, false);\n\t                line.bounds.x = x - line.bounds.width;\n\t                this.addVisualizer(line);\n\t\n\t                if (!(note3.liquescent & _Exsurge3.LiquescentType.Small)) x -= line.bounds.width;\n\t            }\n\t\n\t            note3.bounds.x += x;\n\t\n\t            this.addVisualizer(note1);\n\t            this.addVisualizer(note2);\n\t            this.addVisualizer(note3);\n\t\n\t            this.origin.x = note1.origin.x;\n\t            this.origin.y = note1.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Torculus;\n\t}(Neume);\n\t\n\t/*\r\n\t * TorculusResupinus\r\n\t */\n\t\n\t\n\tvar TorculusResupinus = exports.TorculusResupinus = function (_Neume20) {\n\t    _inherits(TorculusResupinus, _Neume20);\n\t\n\t    function TorculusResupinus() {\n\t        _classCallCheck(this, TorculusResupinus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(TorculusResupinus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(TorculusResupinus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(TorculusResupinus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var line;\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var fourth = this.notes[3];\n\t            var x = 0;\n\t\n\t            // first, figure out the porrectus swash\n\t            var firstStaffPosition = first.staffPosition;\n\t            var secondStaffPosition = second.staffPosition;\n\t            var thirdStaffPosition = third.staffPosition;\n\t            var fourthStaffPosition = fourth.staffPosition;\n\t\n\t            switch (first.shape) {\n\t                case _Exsurge3.NoteShape.Quilisma:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);\n\t                    break;\n\t\n\t                default:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t                    break;\n\t            }\n\t\n\t            x = first.bounds.right();\n\t            this.addVisualizer(first);\n\t\n\t            // if we need a line between the first punctum and the porrectus swash, add it now\n\t            if (secondStaffPosition - firstStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            switch (Math.abs(secondStaffPosition - thirdStaffPosition)) {\n\t                case 1:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus1);\n\t                    break;\n\t                case 2:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus2);\n\t                    break;\n\t                case 3:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus3);\n\t                    break;\n\t                case 4:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus4);\n\t                    break;\n\t                default:\n\t                    // fixme: this should be an error!\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus1);\n\t                    break;\n\t            }\n\t\n\t            second.bounds.x = x;\n\t            x = second.bounds.right();\n\t            this.addVisualizer(second);\n\t\n\t            // the third glyph does not draw anything, but it still has logical importance for the editing\n\t            // environment...it can respond to changes which will then change the swash glyph of the first.\n\t            third.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t\n\t            // do we need an ascending line after the porrectus swash?\n\t            if (fourthStaffPosition - thirdStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, third, fourth, false);\n\t                line.bounds.x = x - line.bounds.width;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            if (fourth.isLiquescent) fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.TerminatingAscLiquescent);else fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PodatusUpper);\n\t\n\t            fourth.bounds.x += x;\n\t            this.addVisualizer(fourth);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return TorculusResupinus;\n\t}(Neume);\n\t\n\t/*\r\n\t * TorculusResupinusFlexus\r\n\t */\n\t\n\t\n\tvar TorculusResupinusFlexus = exports.TorculusResupinusFlexus = function (_Neume21) {\n\t    _inherits(TorculusResupinusFlexus, _Neume21);\n\t\n\t    function TorculusResupinusFlexus() {\n\t        _classCallCheck(this, TorculusResupinusFlexus);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(TorculusResupinusFlexus).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(TorculusResupinusFlexus, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(TorculusResupinusFlexus.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var line;\n\t            var first = this.notes[0];\n\t            var second = this.notes[1];\n\t            var third = this.notes[2];\n\t            var fourth = this.notes[3];\n\t            var fifth = this.notes[4];\n\t            var x = 0;\n\t\n\t            var firstStaffPosition = first.staffPosition;\n\t            var secondStaffPosition = second.staffPosition;\n\t            var thirdStaffPosition = third.staffPosition;\n\t            var fourthStaffPosition = fourth.staffPosition;\n\t            var fifthStaffPosition = fifth.staffPosition;\n\t\n\t            switch (first.shape) {\n\t                case _Exsurge3.NoteShape.Quilisma:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.Quilisma);\n\t                    break;\n\t\n\t                default:\n\t                    first.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t                    break;\n\t            }\n\t\n\t            x = first.bounds.right();\n\t            this.addVisualizer(first);\n\t\n\t            // if we need a line between the first punctum and the porrectus swash, add it now\n\t            if (secondStaffPosition - firstStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, first, second, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x = x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            switch (secondStaffPosition - thirdStaffPosition) {\n\t                case 1:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus1);\n\t                    break;\n\t                case 2:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus2);\n\t                    break;\n\t                case 3:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus3);\n\t                    break;\n\t                case 4:\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.Porrectus4);\n\t                    break;\n\t                default:\n\t                    // fixme: should we generate an error here?\n\t                    second.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t                    break;\n\t            }\n\t\n\t            second.bounds.x = x;\n\t            x = second.bounds.right();\n\t            this.addVisualizer(second);\n\t\n\t            // the second glyph does not draw anything, but it still has logical importance for the editing\n\t            // environment...it can respond to changes which will then change the swash glyph of the first.\n\t            third.setGlyph(ctxt, _Exsurge2.GlyphCode.None);\n\t            third.bounds.x = x;\n\t            x = third.bounds.right();\n\t            this.addVisualizer(third);\n\t\n\t            // add a connecting line\n\t            if (fourthStaffPosition - thirdStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, third, fourth, false);\n\t                x -= line.bounds.width;\n\t                line.bounds.x += x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            fourth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            fourth.bounds.x = x;\n\t            x = fourth.bounds.right();\n\t            this.addVisualizer(fourth);\n\t\n\t            // add a connecting line\n\t            if (fourthStaffPosition - fifthStaffPosition > 1) {\n\t                line = new _Exsurge2.NeumeLineVisualizer(ctxt, fourth, fifth, false);\n\t                x -= line.bounds.width * 1.5;\n\t                line.bounds.x += x;\n\t                this.addVisualizer(line);\n\t            }\n\t\n\t            fifth.setGlyph(ctxt, _Exsurge2.GlyphCode.PunctumCuadratum);\n\t            fifth.bounds.x = x;\n\t            this.addVisualizer(fifth);\n\t\n\t            this.origin.x = first.origin.x;\n\t            this.origin.y = first.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return TorculusResupinusFlexus;\n\t}(Neume);\n\t\n\t/*\r\n\t * Tristropha\r\n\t *\r\n\t * For simplicity in implementation, Tristropha's have three notes in the object\r\n\t * structure. These technically must be the same pitch though (like the\r\n\t * Distropha and Bivirga).\r\n\t */\n\t\n\t\n\tvar Tristropha = exports.Tristropha = function (_Neume22) {\n\t    _inherits(Tristropha, _Neume22);\n\t\n\t    function Tristropha() {\n\t        _classCallCheck(this, Tristropha);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Tristropha).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Tristropha, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Tristropha.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note1 = this.notes[0];\n\t            var note2 = this.notes[1];\n\t            var note3 = this.notes[2];\n\t\n\t            var staffPosition = note1.staffPosition;\n\t\n\t            note1.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note1));\n\t\n\t            note2.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note2));\n\t            note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\n\t\n\t            note3.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note3));\n\t            note3.bounds.x += note1.bounds.width + note2.bounds.width + ctxt.intraNeumeSpacing * 2;\n\t\n\t            this.addVisualizer(note1);\n\t            this.addVisualizer(note2);\n\t            this.addVisualizer(note3);\n\t\n\t            this.origin.x = note1.origin.x;\n\t            this.origin.y = note1.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t    }]);\n\t\n\t    return Tristropha;\n\t}(Neume);\n\t\n\t/*\r\n\t * Virga\r\n\t */\n\t\n\t\n\tvar Virga = exports.Virga = function (_Neume23) {\n\t    _inherits(Virga, _Neume23);\n\t\n\t    function Virga() {\n\t        _classCallCheck(this, Virga);\n\t\n\t        return _possibleConstructorReturn(this, Object.getPrototypeOf(Virga).apply(this, arguments));\n\t    }\n\t\n\t    _createClass(Virga, [{\n\t        key: 'performLayout',\n\t        value: function performLayout(ctxt) {\n\t            _get(Object.getPrototypeOf(Virga.prototype), 'performLayout', this).call(this, ctxt);\n\t\n\t            var note = this.notes[0];\n\t\n\t            var staffPosition = note.staffPosition;\n\t\n\t            var glyphCode = Virga.getGlyphCode(staffPosition);\n\t            note.setGlyph(ctxt, glyphCode);\n\t\n\t            this.addVisualizer(note);\n\t\n\t            this.origin.x = note.origin.x;\n\t            this.origin.y = note.origin.y;\n\t\n\t            this.finishLayout(ctxt);\n\t        }\n\t\n\t        // The virga's glyph depends on its staff position. This is a helper function\n\t        // that can be used by other neumes that use the virga glyphs...\n\t\n\t    }], [{\n\t        key: 'getGlyphCode',\n\t        value: function getGlyphCode(staffPosition) {\n\t            if (Math.abs(staffPosition) % 2 === 1) return _Exsurge2.GlyphCode.VirgaLong;else return _Exsurge2.GlyphCode.VirgaShort;\n\t\n\t            // fixme: add logic for virgas low on the staff that are probably short also...\n\t        }\n\t    }]);\n\t\n\t    return Virga;\n\t}(Neume);\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** exsurge.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a58e9ba5f0ed0846ac85\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\n'use strict';\r\n\r\nimport { Annotation, ChantContext } from 'Exsurge.Drawing'\r\nimport { Gabc } from 'Exsurge.Gabc'\r\n\r\n// client side support\r\nvar ChantVisualElementPrototype = Object.create(HTMLElement.prototype);\r\n\r\nChantVisualElementPrototype.createdCallback = function() {\r\n  var ctxt = new ChantContext();\r\n  \r\n  ctxt.lyricTextFont = \"'Crimson Text', serif\";\r\n  ctxt.lyricTextSize *= 1.2;\r\n  ctxt.dropCapTextFont = ctxt.lyricTextFont;\r\n  ctxt.annotationTextFont = ctxt.lyricTextFont;\r\n\r\n  var useDropCap = true;\r\n  var useDropCapAttr = this.getAttribute(\"use-drop-cap\");\r\n  if (useDropCapAttr === 'false')\r\n    useDropCap = false;\r\n\r\n  var score = Gabc.loadChantScore(ctxt, this.innerText, useDropCap);\r\n\r\n  var annotationAttr = this.getAttribute(\"annotation\");\r\n  if (annotationAttr) {\r\n    // add an annotation\r\n    score.annotation = new Annotation(ctxt, annotationAttr);\r\n  }\r\n\r\n  var _element = this;\r\n\r\n  var width = 0;\r\n  var doLayout = function() {\r\n    var newWidth = _element.parentElement.clientWidth;\r\n    if(width === newWidth) return;\r\n    width = newWidth;\r\n    // perform layout on the chant\r\n    score.performLayout(ctxt, function() {\r\n      score.layoutChantLines(ctxt, width, function() {\r\n        // render the score to svg code\r\n        _element.innerHTML = score.createDrawable(ctxt);\r\n      });\r\n    });\r\n  }\r\n  doLayout();\r\n  if (window.addEventListener)\r\n    window.addEventListener('resize',doLayout,false);\r\n  else if (window.attachEvent)\r\n    window.attachEvent('onresize',doLayout);\r\n}\r\n\r\nChantVisualElementPrototype.attachedCallback = function() {\r\n  \r\n}\r\n\r\ndocument.registerElement = document.registerElement || function() {};\r\n// register the custom element\r\nexport var ChantVisualElement = document.registerElement('chant-visual', {\r\n  prototype: ChantVisualElementPrototype\r\n});\r\n\r\n\r\nexport * from 'Exsurge.Core'\r\nexport * from 'Exsurge.Text'\r\nexport * from 'Exsurge.Glyphs'\r\nexport * from 'Exsurge.Drawing'\r\nexport * from 'Exsurge.Chant'\r\nexport * from 'Exsurge.Chant.Markings'\r\nexport * from 'Exsurge.Chant.Signs'\r\nexport * from 'Exsurge.Chant.Neumes'\r\nexport * from 'Exsurge.Gabc'\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nexport var Units = {\r\n  // enums\r\n  DeviceIndepenedent: 0, // device independent units: 96/inch\r\n  Centimeters: 1,\r\n  Millimeters: 2,\r\n  Inches: 3,\r\n\r\n  // constants for device independent units (diu)\r\n  DIU_PER_INCH: 96,\r\n  DIU_PER_CENTIMETER: 96 / 2.54,\r\n\r\n  ToDeviceIndependent: function (n, inputUnits) {\r\n    switch (inputUnits) {\r\n      case Centimeters:\r\n        return n * DIU_PER_CENTIMETER;\r\n      case Millimeters:\r\n        return n * DIU_PER_CENTIMETER / 10;\r\n      case Inches:\r\n        return n * DIU_PER_INCH;\r\n      default:\r\n        return n;\r\n    }\r\n  },\r\n\r\n  FromDeviceIndependent: function (n, outputUnits) {\r\n    switch (outputUnits) {\r\n      case Centimeters:\r\n        return n / DIU_PER_CENTIMETER;\r\n      case Millimeters:\r\n        return n / DIU_PER_CENTIMETER * 10;\r\n      case Inches:\r\n        return n / DIU_PER_INCH;\r\n      default:\r\n        return n;\r\n    }\r\n  },\r\n\r\n\r\n  StringToUnitsType: function(s) {\r\n    switch (s.ToLower()) {\r\n      case \"in\":\r\n      case \"inches\":\r\n        return Inches;\r\n\r\n      case \"cm\":\r\n      case \"centimeters\":\r\n        return Centimeters;\r\n\r\n      case \"mm\":\r\n      case \"millimeters\":\r\n        return Millimeters;\r\n\r\n      case \"di\":\r\n      case \"device-independent\":\r\n        return DeviceIndepenedent;\r\n\r\n      default:\r\n        return DeviceIndepenedent;\r\n    }\r\n  },\r\n\r\n  UnitsTypeToString: function(units) {\r\n    switch (units) {\r\n      case Inches: return \"in\";\r\n      case Centimeters: return \"cm\";\r\n      case Millimeters: return \"mm\";\r\n      case DeviceIndepenedent: return \"device-independent\";\r\n      default: return \"device-independent\";\r\n    }\r\n  }\r\n}\r\n\r\nexport function DeviceIndependent(n) {\r\n  return n;\r\n}\r\n\r\nexport function Centimeters(n) {\r\n  return Units.ToDeviceIndependent(n, Units.Centimeters);\r\n}\r\n\r\nexport function Millimeters(n) {\r\n  return Units.ToDeviceIndependent(n, Units.Millimeters);\r\n}\r\n\r\nexport function Inches(n) {\r\n  return Units.ToDeviceIndependent(n, Units.Inches);\r\n}\r\n\r\nexport function ToCentimeters(n) {\r\n  return Units.FromDeviceIndependent(n, Units.Centimeters);\r\n}\r\n\r\nexport function ToMillimeters(n) {\r\n  return Units.FromDeviceIndependent(n, Units.Millimeters);\r\n}\r\n\r\nexport function ToInches(n) {\r\n  return Units.FromDeviceIndependent(n, Units.Inches);\r\n}\r\n\r\n\r\n/*\r\n * Point\r\n */\r\nexport class Point {\r\n  constructor(x, y) {\r\n    this.x = (typeof x !== 'undefined') ? x : 0;\r\n    this.y = (typeof y !== 'undefined') ? y : 0;\r\n  }\r\n\r\n  clone() {\r\n    return new Point(this.x, this.y);\r\n  }\r\n\r\n  equals(point) {\r\n    return this.x === point.x && this.y === point.y;\r\n  }\r\n}\r\n\r\n/*\r\n * Rect\r\n */\r\nexport class Rect {\r\n  constructor(x, y, width, height) {\r\n    this.x = (typeof x !== 'undefined') ? x : Infinity;\r\n    this.y = (typeof y !== 'undefined') ? y : Infinity;\r\n    this.width = (typeof width !== 'undefined') ? width : -Infinity;\r\n    this.height = (typeof height !== 'undefined') ? height : -Infinity;\r\n  }\r\n\r\n  clone() {\r\n    return new Rect(this.x, this.y, this.width, this.height);\r\n  }\r\n\r\n  isEmpty() {\r\n    return (this.x === Infinity &&\r\n            this.y === Infinity &&\r\n            this.width === -Infinity &&\r\n            this.height === -Infinity);\r\n  }\r\n\r\n  // convenience method\r\n  right() {\r\n    return this.x + this.width;\r\n  }\r\n\r\n  bottom() {\r\n    return this.y + this.height;\r\n  }\r\n\r\n  equals(rect) {\r\n    return this.x === rect.x && this.y === rect.y &&\r\n           this.width === rect.width && this.height === rect.height;\r\n  }\r\n\r\n  // other can be a Point or a Rect\r\n  contains(other) {\r\n    if (other instanceof Point) {\r\n      return other.x >= this.x &&\r\n              other.x <= this.x + this.width &&\r\n              other.y >= this.y &&\r\n              other.y <= this.y + this.height;\r\n    } else { // better be instance of Rect\r\n      return this.x <= other.x &&\r\n              this.x + this.width >= other.x + other.width &&\r\n              this.y <= other.y &&\r\n              this.y + this.height >= other.y + other.height;\r\n    }\r\n  }\r\n\r\n  union(rect) {\r\n\r\n    var right = Math.max(this.x + this.width, rect.x + rect.width);\r\n    var bottom = Math.max(this.y + this.height, rect.y + rect.height);\r\n\r\n    this.x = Math.min(this.x, rect.x);\r\n    this.y = Math.min(this.y, rect.y);\r\n\r\n    this.width = right - this.x;\r\n    this.height = bottom - this.y;\r\n  }\r\n}\r\n\r\n/**\r\n * Margins\r\n *\r\n * @class\r\n */\r\nexport class Margins {\r\n  constructor(left, top, right, bottom) {\r\n    this.left = (typeof left !== 'undefined') ? left : 0;\r\n    this.top = (typeof top !== 'undefined') ? top : 0;\r\n    this.right = (typeof right !== 'undefined') ? right : 0;\r\n    this.bottom = (typeof bottom !== 'undefined') ? bottom : 0;\r\n  }\r\n\r\n  clone() {\r\n    return new Margins(this.left, this.top, this.right, this.bottom);\r\n  }\r\n\r\n  equals(margins) {\r\n    return this.left === margins.left &&\r\n        this.top === margins.top &&\r\n        this.right === margins.right &&\r\n        this.bottom === margins.bottom;\r\n  }\r\n}\r\n\r\n/**\r\n * Size\r\n *\r\n * @class\r\n */\r\nexport class Size {\r\n  constructor(width, height) {\r\n    this.width = (typeof width !== 'undefined') ? width : 0;\r\n    this.height = (typeof height !== 'undefined') ? height : 0;\r\n  }\r\n\r\n  clone() {\r\n    return new Size(this.width, this.height);\r\n  }\r\n\r\n  equals(size) {\r\n    return this.width === size.width && this.height === size.height;\r\n  }\r\n}\r\n\r\n\r\n/*\r\n * Pitches, notes\r\n */\r\nexport var Step = {\r\n  Do: 0,\r\n  Du: 1,\r\n  Re: 2,\r\n  Me: 3,\r\n  Mi: 4,\r\n  Fa: 5,\r\n  Fu: 6,\r\n  So: 7,\r\n  La: 9,\r\n  Te: 10,\r\n  Ti: 11\r\n};\r\n\r\n  // this little array helps map step values to staff positions. The numeric values of steps\r\n  // correspond to whole step increments (2) or half step increments (1). This gives us the ability\r\n  // to compare pitches precisely, but makes it challenging to place steps on the staff. this little\r\n  // array maps the steps to an incremental position the steps take on the staff line. This works\r\n  // so simply because chant only uses do and fa clefs, and only has a flatted ti (te), making\r\n  // for relatively easy mapping to staff line locations.\r\n  //                         Do Du Re Me Mi Fa Fu So    La Te Ti\r\nvar __StepToStaffPosition = [0, 0, 1, 1, 2, 3, 3, 4, 4, 5, 6, 6];\r\nvar __StaffOffsetToStep = [Step.Do, Step.Re, Step.Mi, Step.Fa, Step.So, Step.La, Step.Ti]; // no accidentals in this one\r\n\r\n\r\nexport class Pitch {\r\n  constructor(step, octave) {\r\n    this.step = step;\r\n    this.octave = octave;\r\n  }\r\n  \r\n  toInt() {\r\n    return this.octave * 12 + this.step;\r\n  }\r\n\r\n  isHigherThan(pitch) {\r\n    return this.toInt() > pitch.toInt();\r\n  }\r\n\r\n  isLowerThan(pitch) {\r\n    return this.toInt() < pitch.toInt();\r\n  }\r\n\r\n  equals(pitch) {\r\n    return this.toInt() === pitch.toInt();\r\n  }\r\n\r\n  static stepToStaffOffset(step) {\r\n    return __StepToStaffPosition[step];\r\n  }\r\n\r\n  static staffOffsetToStep(offset) {\r\n    while (offset < 0)\r\n      offset = __StaffOffsetToStep.length + offset;\r\n\r\n    return __StaffOffsetToStep[offset % __StaffOffsetToStep.length];\r\n  }\r\n}\r\n\r\n// for positioning markings on notes\r\nexport var MarkingPositionHint = {\r\n  Default: 0,\r\n  Above: 1,\r\n  Below: 2\r\n};\r\n\r\nexport function generateRandomGuid() {\r\n  function s4() {\r\n    return Math.floor((1 + Math.random()) * 0x10000)\r\n      .toString(16)\r\n      .substring(1);\r\n  }\r\n  return s4() + s4();\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Core.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport * as Exsurge from 'Exsurge.Core'\r\n\r\n/**\r\n * @class\r\n */\r\nexport class Language {\r\n  constructor(name) {\r\n    this.name = (typeof name !== 'undefined') ? name : \"<unknown>\";\r\n  }\r\n\r\n  /**\r\n   * @param {String} text The string to parsed into words.\r\n   * @return {Word[]} the resulting parsed words from syllabification\r\n   */\r\n  syllabify(text) {\r\n\r\n    var parsedWords = [];\r\n\r\n    if (typeof text === 'undefined' || text === \"\")\r\n      return parsedWords;\r\n\r\n    // Divide the text into words separated by whitespace\r\n    var words = text.split(/[\\s]+/);\r\n\r\n    for (var i = 0, end = words.length; i < end; i++)\r\n      parsedWords.push(this.syllabifyWord(words[i]));\r\n\r\n    return parsedWords;\r\n  }\r\n}\r\n\r\n/**\r\n * @class\r\n */\r\nexport class Latin extends Language {\r\n\r\n  /**\r\n   * @constructs\r\n   */\r\n  constructor() {\r\n    super(\"Latin\");\r\n\r\n    // fixme: should we include 'diphthongs' with accented vowels, e.g., e?\r\n    // fixme: ui is only diphthong in the exceptional cases below (according to Wheelock's Latin)\r\n    this.diphthongs = [\"ae\", \"au\", \"oe\"];\r\n\r\n    // some words that are simply exceptions to standard syllabification rules!\r\n    var wordExceptions = new Object();\r\n\r\n    // ui combos pronounced as diphthongs\r\n    wordExceptions[\"huius\"] = [\"hui\", \"us\"];\r\n    wordExceptions[\"cuius\"] = [\"cui\", \"us\"];\r\n    wordExceptions[\"huic\"] = [\"huic\"];\r\n    wordExceptions[\"cui\"] = [\"cui\"];\r\n    wordExceptions[\"hui\"] = [\"hui\"];\r\n\r\n    this.vowels = ['a', 'e', 'i', 'o', 'u',\r\n                   '', '', '', '', '',\r\n                   '', '',\r\n                   '',  // no accented  in unicode?\r\n                   'y']; // y is treated as a vowel; not native to Latin but useful for words borrowed from Greek\r\n\r\n    this.muteConsonantsAndF = ['b', 'c', 'd', 'g', 'p', 't', 'f'];\r\n\r\n    this.liquidConsonants = ['l', 'r'];\r\n  }\r\n\r\n  // c must be lowercase!\r\n  isVowel(c) {\r\n    for (var i = 0, end = this.vowels.length; i < end; i++)\r\n      if (this.vowels[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * f is not a mute consonant, but we lump it together for syllabification\r\n   * since it is syntactically treated the same way\r\n   *\r\n   * @param {String} c The character to test; must be lowercase\r\n   * @return {boolean} true if c is an f or a mute consonant\r\n   */\r\n  isMuteConsonantOrF(c) {\r\n    for (var i = 0, end = this.muteConsonantsAndF.length; i < end; i++)\r\n      if (this.muteConsonantsAndF[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} c The character to test; must be lowercase\r\n   * @return {boolean} true if c is a liquid consonant\r\n   */\r\n  isLiquidConsonant(c) {\r\n    for (var i = 0, end = this.liquidConsonants.length; i < end; i++)\r\n      if (this.liquidConsonants[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} s The string to test; must be lowercase\r\n   * @return {boolean} true if s is a diphthong\r\n   */\r\n  isDiphthong(s) {\r\n    for (var i = 0, end = this.diphthongs.length; i < end; i++)\r\n      if (this.diphthongs[i] === s)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Rules for Latin syllabification (from Collins, \"A Primer on Ecclesiastical Latin\")\r\n   *\r\n   * Divisions occur when:\r\n   *   1. After open vowels (those not followed by a consonant) (e.g., \"pi-us\" and \"De-us\")\r\n   *   2. After vowels followed by a single consonant (e.g., \"vi-ta\" and \"ho-ra\")\r\n   *   3. After the first consonant when two or more consonants follow a vowel\r\n   *      (e.g., \"mis-sa\", \"minis-ter\", and \"san-ctus\").\r\n   *\r\n   * Exceptions:\r\n   *   1. In compound words the consonants stay together (e.g., \"de-scribo\").\r\n   *   2. A mute consonant (b, c, d, g, p, t) or f followed by a liquid consonant (l, r)\r\n   *      go with the succeeding vowel: \"la-crima\", \"pa-tris\"\r\n   *\r\n   * In addition to these rules, Wheelock's Latin provides this sound exception:\r\n   *   -  Also counted as single consonants are qu and the aspirates ch, ph,\r\n   *      th, which should never be separated in syllabification:\r\n   *      architectus, ar-chi-tec-tus; loquacem, lo-qua-cem.\r\n   *\r\n   */\r\n  syllabifyWord(word) {\r\n    var syllables = [];\r\n    var haveCompleteSyllable = false;\r\n    var previousWasVowel = false;\r\n    var workingString = word.toLowerCase();\r\n    var startSyllable = 0;\r\n\r\n    var c, lookahead, haveLookahead;\r\n\r\n    // a helper function to create syllables\r\n    var makeSyllable = function (length) {\r\n      if (haveCompleteSyllable) {\r\n        syllables.push(word.substr(startSyllable, length));\r\n        startSyllable += length;\r\n      }\r\n\r\n      haveCompleteSyllable = false;\r\n    }\r\n\r\n    for (var i = 0, wordLength = workingString.length; i < wordLength; i++) {\r\n\r\n      c = workingString[i];\r\n\r\n      // get our lookahead in case we need them...\r\n      lookahead = '*';\r\n      haveLookahead = (i + 1) < wordLength;\r\n\r\n      if (haveLookahead)\r\n        lookahead = workingString[i + 1];\r\n\r\n      var cIsVowel = this.isVowel(c);\r\n\r\n      // i is a special case for a vowel. when i is at the beginning\r\n      // of the word (Iesu) or i is between vowels (alleluia),\r\n      // then the i is treated as a consonant (y)\r\n      if (c === 'i') {\r\n        if (i === 0 && haveLookahead && this.isVowel(lookahead))\r\n          cIsVowel = false;\r\n        else if (previousWasVowel && haveLookahead && this.isVowel(lookahead)) {\r\n          cIsVowel = false;\r\n        }\r\n      }\r\n\r\n      if (c === '-') {\r\n\r\n        // a hyphen forces a syllable break, which effectively resets\r\n        // the logic...\r\n\r\n        haveCompleteSyllable = true;\r\n        previousWasVowel = false;\r\n        makeSyllable(i - startSyllable);\r\n        startSyllable++;\r\n\r\n      } else if (cIsVowel) {\r\n\r\n        // once we get a vowel, we have a complete syllable\r\n        haveCompleteSyllable = true;\r\n\r\n        if (previousWasVowel && !this.isDiphthong(workingString[i - 1] + \"\" + c)) {\r\n          makeSyllable(i - startSyllable);\r\n          haveCompleteSyllable = true;\r\n        }\r\n\r\n        previousWasVowel = true;\r\n\r\n      } else if (haveLookahead) {\r\n\r\n        if ((c === 'q' && lookahead === 'u') ||\r\n            (lookahead === 'h' && (c === 'c' || c === 'p' || c === 't'))) {\r\n          // handle wheelock's exceptions for qu, ch, ph and th\r\n          makeSyllable(i - startSyllable);\r\n          i++; // skip over the 'h' or 'u'\r\n        } else if (previousWasVowel && this.isVowel(lookahead)) {\r\n          // handle division rule 2\r\n          makeSyllable(i - startSyllable);\r\n        } else if (this.isMuteConsonantOrF(c) && this.isLiquidConsonant(lookahead)) {\r\n          // handle exception 2\r\n          makeSyllable(i - startSyllable);\r\n        } else if (haveCompleteSyllable) {\r\n          // handle division rule 3\r\n          makeSyllable(i + 1 - startSyllable);\r\n        }\r\n\r\n        previousWasVowel = false;\r\n      }\r\n    }\r\n\r\n    // if we have a complete syllable, we can add it as a new one. Otherwise\r\n    // we tack the remaining characters onto the last syllable.\r\n    if (haveCompleteSyllable)\r\n      syllables.push(word.substr(startSyllable));\r\n    else if (startSyllable > 0)\r\n      syllables[syllables.length - 1] += word.substr(startSyllable);\r\n\r\n    return syllables;\r\n  }\r\n\r\n  /**\r\n   * @param {String} s the string to search\r\n   * @param {Number} startIndex The index at which to start searching for a vowel in the string\r\n   * @retuns a custom class with three properties: {found: (true/false) startIndex: (start index in s of vowel segment) length ()}\r\n   */\r\n  findVowelSegment(s, startIndex) {\r\n\r\n    var i, end, index;\r\n    var workingString = s.toLowerCase();\r\n\r\n    // do we have a diphthongs?\r\n    for (i = 0, end = this.diphthongs.length; i < end; i++) {\r\n      var d = this.diphthongs[i];\r\n      index = workingString.indexOf(d, startIndex);\r\n\r\n      if (index >= 0)\r\n        return { found: true, startIndex: index, length: d.length };\r\n    }\r\n\r\n    // no diphthongs. Let's look for single vowels then...\r\n    for (i = 0, end = this.vowels.length; i < end; i++) {\r\n      index = workingString.indexOf(this.vowels[i], startIndex);\r\n\r\n      if (index >= 0) {\r\n        // if the first vowel found is a U, and it is immediately followed by another vowel, (e.g., sanguis, quis), the first u counts as a consonant:\r\n        // (in practice, this only affects words such as equus that contain a uu, since the alphabetically earlier vowel would be found before the U)\r\n        if(this.vowels[i] === 'u' && this.isVowel(workingString[index + 1])) {\r\n          ++index;\r\n        }\r\n        return { found: true, startIndex: index, length: 1 };\r\n      }\r\n    }\r\n\r\n    // no vowels sets found after startIndex!\r\n    return { found: false, startIndex: -1, length: -1 };\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n */\r\nexport class Spanish extends Language {\r\n\r\n  constructor() {\r\n    super(\"Spanish\");\r\n\r\n    this.vowels = ['a', 'e', 'i', 'o', 'u', 'y',\r\n                    '', '', '', '', '', ''];\r\n\r\n    this.weakVowels = ['i', 'u', '', 'y'];\r\n\r\n    this.strongVowels = ['a', 'e', 'o', '', '', '', '', ''];\r\n\r\n\r\n    this.diphthongs = [\"ai\", \"ei\", \"oi\", \"ui\", \"ia\", \"ie\", \"io\", \"iu\", \"au\", \"eu\", \"ou\", \"ua\", \"ue\", \"uo\",\r\n                       \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"i\", \"u\", \"u\", \"u\", \"u\", \"u\", \"u\",\r\n                       \"e\", \"i\"];\r\n\r\n    this.uDiphthongExceptions = [\"gue\", \"gui\", \"qua\", \"que\", \"qui\", \"quo\"];\r\n  }\r\n\r\n  // c must be lowercase!\r\n  isVowel(c) {\r\n    for (var i = 0, end = this.vowels.length; i < end; i++)\r\n      if (this.vowels[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {String} c The character to test; must be lowercase\r\n   * @return {boolean} true if c is an f or a mute consonant\r\n   */\r\n  isWeakVowel(c) {\r\n    for (var i = 0, end = this.weakVowels.length; i < end; i++)\r\n      if (this.weakVowels[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {String} c The character to test; must be lowercase\r\n   * @return {boolean} true if c is an f or a mute consonant\r\n   */\r\n  isStrongVowel(c) {\r\n    for (var i = 0, end = this.strongVowels.length; i < end; i++)\r\n      if (this.strongVowels[i] === c)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {String} s The string to test; must be lowercase\r\n   * @return {boolean} true if s is a diphthong\r\n   */\r\n  isDiphthong(s) {\r\n    for (var i = 0, end = this.diphthongs.length; i < end; i++)\r\n      if (this.diphthongs[i] === s)\r\n        return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  createSyllable(text) {\r\n\r\n/*\r\n    var accented = false;\r\n    var ellidesToNext = false;\r\n\r\n    if (text.length > 0) {\r\n        \r\n        if (text[0] == '`') {\r\n            accented = true;\r\n            text = text.substr(1);\r\n        }\r\n\r\n        if (text[text.length - 1] == '_') {\r\n            ellidesToNext = true;\r\n            text = text.substr(0, text.length - 1);\r\n        }\r\n    }\r\n\r\n    var s = new Syllable(text);\r\n\r\n    s.isMusicalAccent = accented;\r\n    s.elidesToNext = ellidesToNext;*/\r\n\r\n    return text;\r\n  }\r\n\r\n  /**\r\n   */\r\n  syllabifyWord(word) {\r\n\r\n    var syllables = [];\r\n\r\n    var haveCompleteSyllable = false;\r\n    var previousIsVowel = false;\r\n    var previousIsStrongVowel = false; // only valid if previousIsVowel == true\r\n    var startSyllable = 0;\r\n\r\n    // fixme: first check for prefixes\r\n\r\n    for (i = 0; i < word.length; i++) {\r\n\r\n      var c = word[i].toLowerCase();\r\n\r\n      if (this.isVowel(c)) {\r\n\r\n        // we have a complete syllable as soon as we have a vowel\r\n        haveCompleteSyllable = true;\r\n\r\n        var cIsStrongVowel = this.isStrongVowel(c);\r\n\r\n        if (previousIsVowel) {\r\n          // if we're at a strong vowel, then we finish out the last syllable\r\n          if (cIsStrongVowel) {\r\n            if (previousIsStrongVowel) {\r\n              syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\r\n              startSyllable = i;\r\n            }\r\n          }\r\n        }\r\n\r\n        previousIsVowel = true;\r\n        previousIsStrongVowel = cIsStrongVowel;\r\n\r\n      } else {\r\n        if (!haveCompleteSyllable) {\r\n          // do nothing since we don't have a complete syllable yet...\r\n        } else {\r\n\r\n          // handle explicit syllable breaks\r\n          if (word[i] === '-') {\r\n            // start new syllable\r\n            syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\r\n            startSyllable = ++i;\r\n          } else {\r\n\r\n            var numberOfConsonants = 1, consonant2;\r\n\r\n            // count how many more consonants there are\r\n            for (j = i + 1; j < word.length; j++) {\r\n              if (this.isVowel(word[j]))\r\n                break;\r\n              numberOfConsonants++;\r\n            }\r\n\r\n            if (numberOfConsonants === 1) {\r\n              // start new syllable\r\n              syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\r\n              startSyllable = i;\r\n\r\n            } else if (numberOfConsonants === 2) {\r\n              consonant2 = word[i + 1].toLowerCase();\r\n              if (consonant2 === 'l' || consonant2 === 'r' || (c === 'c' && consonant2 === 'h')) {\r\n                // split before the consonant pair\r\n                syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\r\n                startSyllable = i++;\r\n              } else {\r\n                //split the consonants\r\n                syllables.push(this.createSyllable(word.substr(startSyllable, ++i - startSyllable)));\r\n                startSyllable = i;\r\n              }\r\n\r\n            } else if (numberOfConsonants === 3) {\r\n              consonant2 = word[i + 1].toLowerCase();\r\n\r\n              // if second consonant is s, divide cc-c, otherwise divide c-cc\r\n              if (consonant2 === 's') {\r\n                i += 2;\r\n                syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable)));\r\n              } else\r\n                syllables.push(this.createSyllable(word.substr(startSyllable, ++i - startSyllable)));\r\n\r\n              startSyllable = i;\r\n\r\n            } else if (numberOfConsonants === 4) {\r\n              // four always get split cc-cc\r\n              syllables.push(this.createSyllable(word.substr(startSyllable, i - startSyllable + 2)));\r\n              startSyllable = i + 2;\r\n              i += 3;\r\n            }\r\n          }\r\n\r\n          haveCompleteSyllable = false;\r\n        }\r\n\r\n        previousIsVowel = false;\r\n      }\r\n    }\r\n\r\n\r\n    // if we have a complete syllable, we can add it as a new one. Otherwise\r\n    // we tack the remaining characters onto the last syllable.\r\n    if (haveCompleteSyllable)\r\n      syllables.push(word.substr(startSyllable));\r\n    else if (startSyllable > 0)\r\n      syllables[syllables.length - 1] += word.substr(startSyllable);\r\n    else if (syllables.length === 0)\r\n      syllables.push(this.createSyllable(word))\r\n\r\n    return syllables;\r\n  }\r\n\r\n  /**\r\n   * @param {String} s the string to search\r\n   * @param {Number} startIndex The index at which to start searching for a vowel in the string\r\n   * @retuns a custom class with three properties: {found: (true/false) startIndex: (start index in s of vowel segment) length ()}\r\n   */\r\n  findVowelSegment(s, startIndex) {\r\n\r\n    var i, end, index;\r\n    var workingString = s.toLowerCase();\r\n\r\n    // do we have a diphthongs?\r\n    for (i = 0, end = this.diphthongs.length; i < end; i++) {\r\n      var d = this.diphthongs[i];\r\n      index = workingString.indexOf(d, startIndex);\r\n\r\n      if (index >= 0) {\r\n\r\n        // check the exceptions...\r\n        if (d[0] === 'u' && index > 0) {\r\n          var tripthong = s.substr(index - 1, 3).toLowerCase();\r\n\r\n          for (j = 0, endj = this.uDiphthongExceptions.length; i < endj; j++) {\r\n            if (tripthong === this.uDiphthongExceptions[j]) {\r\n              // search from after the u...\r\n              return this.findVowelSegment(s, index + 1);\r\n            }\r\n          }\r\n        }\r\n\r\n        return { found: true, startIndex: index, length: d.length };\r\n      }\r\n    }\r\n\r\n    // no diphthongs. Let's look for single vowels then...\r\n    for (i = 0, end = this.vowels.length; i < end; i++) {\r\n      index = workingString.indexOf(this.vowels[i], startIndex);\r\n\r\n      if (index >= 0)\r\n        return { found: true, startIndex: index, length: 1 };\r\n    }\r\n\r\n    // no vowels sets found after startIndex!\r\n    return { found: false, startIndex: -1, length: -1 };\r\n  }\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Text.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\n\r\n// generated based on the svg data\r\nexport let Glyphs = {\r\n  \"None\": {\r\n    \"svgSrc\": \"<g></g>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 0,\r\n      \"height\": 0\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 0\r\n    }\r\n  },\r\n  \"AcuteAccent\": {\r\n    \"svgSrc\": \"<path d=\\\"M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 110.99200439453125,\r\n      \"height\": 125.79399108886719\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0.8030000329017639,\r\n      \"y\": 125.27399444580078\r\n    }\r\n  },\r\n  \"Stropha\": {\r\n    \"svgSrc\": \"<path d=\\\"M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 97.65699768066406,\r\n      \"height\": 151.56201171875\r\n    },\r\n    \"origin\": {\r\n      \"x\": 48,\r\n      \"y\": 73.43800354003906\r\n    }\r\n  },\r\n  \"BeginningAscLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 152.343994140625\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 88.34400177001953\r\n    }\r\n  },\r\n  \"BeginningDesLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 151.56199645996094\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 75.56199645996094\r\n    }\r\n  },\r\n  \"CustodDescLong\": {\r\n    \"svgSrc\": \"<path d=\\\"M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 46.35300064086914,\r\n      \"height\": 339.58197021484375\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 65.58999633789062\r\n    }\r\n  },\r\n  \"CustodDescShort\": {\r\n    \"svgSrc\": \"<path d=\\\"M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 43.75,\r\n      \"height\": 270.0530090332031\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 65.88999938964844\r\n    }\r\n  },\r\n  \"CustodLong\": {\r\n    \"svgSrc\": \"<path d=\\\"M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 46.35300064086914,\r\n      \"height\": 339.5820007324219\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 270.0820007324219\r\n    }\r\n  },\r\n  \"CustodShort\": {\r\n    \"svgSrc\": \"<path d=\\\"M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 43.75,\r\n      \"height\": 270.052001953125\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 200.36500549316406\r\n    }\r\n  },\r\n  \"DoClef\": {\r\n    \"svgSrc\": \"<path d=\\\"M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 331.2510070800781\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0,\r\n      \"y\": 164.87600708007812\r\n    }\r\n  },\r\n  \"FaClef\": {\r\n    \"svgSrc\": \"<path d=\\\"M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 193.75201416015625,\r\n      \"height\": 333.5950012207031\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0.001003265380859375,\r\n      \"y\": 157.00100708007812\r\n    }\r\n  },\r\n  \"Flat\": {\r\n    \"svgSrc\": \"<path d=\\\"M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 97.91699981689453,\r\n      \"height\": 267.968994140625\r\n    },\r\n    \"origin\": {\r\n      \"x\": 1.0420000553131104,\r\n      \"y\": 204.406005859375\r\n    }\r\n  },\r\n  \"Mora\": {\r\n    \"svgSrc\": \"<path d=\\\"M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 48,\r\n      \"height\": 48\r\n    },\r\n    \"origin\": {\r\n      \"x\": -24,\r\n      \"y\": 24\r\n    }\r\n  },\r\n  \"Natural\": {\r\n    \"svgSrc\": \"<path d=\\\"M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 70.31100463867188,\r\n      \"height\": 330.468994140625\r\n    },\r\n    \"origin\": {\r\n      \"x\": 0.3120002746582031,\r\n      \"y\": 166.56300354003906\r\n    }\r\n  },\r\n  \"OriscusAsc\": {\r\n    \"svgSrc\": \"<path d=\\\"M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 147.656005859375\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 76\r\n    }\r\n  },\r\n  \"OriscusDes\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 147.656005859375\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 75.40599822998047\r\n    }\r\n  },\r\n  \"OriscusLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 147.656005859375\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 75.40599822998047\r\n    }\r\n  },  \r\n  \"PodatusLower\": {\r\n    \"svgSrc\": \"<path d=\\\"M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 103.12399291992188\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 42\r\n    }\r\n  },\r\n  \"PodatusUpper\": {\r\n    \"svgSrc\": \"<path d=\\\"M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 91.406005859375,\r\n      \"height\": 125.78099822998047\r\n    },\r\n    \"origin\": {\r\n      \"x\": 91.406005859375,\r\n      \"y\": 63.78099822998047\r\n    }\r\n  },\r\n  \"Porrectus1\": {\r\n    \"svgSrc\": \"<path d=\\\"M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 302.343994140625,\r\n      \"height\": 215.6269989013672\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 52.75\r\n    }\r\n  },\r\n  \"Porrectus2\": {\r\n    \"svgSrc\": \"<path d=\\\"M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 377.3429870605469,\r\n      \"height\": 328.1260070800781\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 68.75\r\n    }\r\n  },\r\n  \"Porrectus3\": {\r\n    \"svgSrc\": \"<path d=\\\"M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 377.343994140625,\r\n      \"height\": 427.3450012207031\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 70\r\n    }\r\n  },\r\n  \"Porrectus4\": {\r\n    \"svgSrc\": \"<path d=\\\"M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 420,\r\n      \"height\": 525.780029296875\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 70\r\n    }\r\n  },\r\n  \"PunctumCavum\": {\r\n    \"svgSrc\": \"<path d=\\\"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\\\"/><path fill=\\\"#fff\\\" d=\\\"M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\"\r\n    },\r\n    {\r\n      \"type\": \"negative\",\r\n      \"data\": \"M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 123.43799591064453\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 60.90599822998047\r\n    }\r\n  },\r\n  \"PunctumCuadratum\": {\r\n    \"svgSrc\": \"<path d=\\\"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 123.43799591064453\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 60.90599822998047\r\n    }\r\n  },\r\n  \"PunctumCuadratumAscLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 152.343994140625\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 88.34400177001953\r\n    }\r\n  },\r\n  \"PunctumCuadratumDesLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 151.56199645996094\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 75.56199645996094\r\n    }\r\n  },\r\n  \"PunctumInclinatum\": {\r\n    \"svgSrc\": \"<path d=\\\"M0-75.78L50 0 0 75-50 0 0-75.78z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M0-75.78L50 0 0 75-50 0 0-75.78z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 150.77999877929688\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 75.77999877929688\r\n    }\r\n  },\r\n  \"PunctumInclinatumLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 70,\r\n      \"height\": 105.546\r\n    },\r\n    \"origin\": {\r\n      \"x\": 35,\r\n      \"y\": 53.164062\r\n    }\r\n  },\r\n  \"Quilisma\": {\r\n    \"svgSrc\": \"<path d=\\\"M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 150\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 89.28199768066406\r\n    }\r\n  },\r\n  \"TerminatingAscLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 49.999000549316406,\r\n      \"height\": 121.87299346923828\r\n    },\r\n    \"origin\": {\r\n      \"x\": 49.999000549316406,\r\n      \"y\": 48.842994689941406\r\n    }\r\n  },\r\n  \"TerminatingDesLiquescent\": {\r\n    \"svgSrc\": \"<path d=\\\"M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 50,\r\n      \"height\": 122.65800476074219\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 80.97000122070312\r\n    }\r\n  },\r\n  \"VerticalEpisemaAbove\": {\r\n    \"svgSrc\": \"<path d=\\\"M-8-80H8L4 0h-8l-4-80z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-8-80H8L4 0h-8l-4-80z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 16,\r\n      \"height\": 80\r\n    },\r\n    \"origin\": {\r\n      \"x\": 8,\r\n      \"y\": 80\r\n    }\r\n  },\r\n  \"VerticalEpisemaBelow\": {\r\n    \"svgSrc\": \"<path d=\\\"M-8 80H8L4 0h-8l-4 80z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M-8 80H8L4 0h-8l-4 80z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 16,\r\n      \"height\": 80\r\n    },\r\n    \"origin\": {\r\n      \"x\": 8,\r\n      \"y\": 0\r\n    }\r\n  },\r\n  \"VirgaLong\": {\r\n    \"svgSrc\": \"<path d=\\\"M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 326.56201171875\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 66.90599822998047\r\n    }\r\n  },\r\n  \"VirgaShort\": {\r\n    \"svgSrc\": \"<path d=\\\"M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 100,\r\n      \"height\": 253.12600708007812\r\n    },\r\n    \"origin\": {\r\n      \"x\": 50,\r\n      \"y\": 66.90599822998047\r\n    }\r\n  },\r\n  \"Virgula\": {\r\n    \"svgSrc\": \"<path d=\\\"M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z\\\"/>\",\r\n    \"paths\": [{\r\n      \"type\": \"positive\",\r\n      \"data\": \"M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z\"\r\n    }],\r\n    \"bounds\": {\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 98.01399993896484,\r\n      \"height\": 175.2209930419922\r\n    },\r\n    \"origin\": {\r\n      \"x\": 1.0739939212799072,\r\n      \"y\": 88.86000061035156\r\n    }\r\n  }\r\n};\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Glyphs.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport { Units, Pitch, Point, Rect, Margins, Size, Step, MarkingPositionHint } from 'Exsurge.Core'\r\nimport { Glyphs } from 'Exsurge.Glyphs'\r\nimport { Latin } from 'Exsurge.Text'\r\n\r\n\r\n// load in the web font for special chant characters here:\r\nvar __exsurgeCharactersFont = require(\"url?limit=30000!../assets/fonts/ExsurgeChar.otf\");\r\n\r\n\r\nexport let GlyphCode = {\r\n\r\n  None: \"None\",\r\n\r\n  AcuteAccent: \"AcuteAccent\",\r\n  Stropha: \"Stropha\",\r\n  //  StrophaLiquescent: \"StrophaLiquescent\",\r\n\r\n  BeginningAscLiquescent: \"BeginningAscLiquescent\",\r\n  BeginningDesLiquescent: \"BeginningDesLiquescent\",\r\n\r\n  CustodDescLong: \"CustodDescLong\",\r\n  CustodDescShort: \"CustodDescShort\",\r\n  CustodLong: \"CustodLong\",\r\n  CustodShort: \"CustodShort\",\r\n\r\n  // clefs and other markings\r\n  DoClef: \"DoClef\",\r\n  FaClef: \"FaClef\",\r\n  Flat: \"Flat\",\r\n  Mora: \"Mora\",\r\n  Natural: \"Natural\",\r\n  OriscusAsc: \"OriscusAsc\",\r\n  OriscusDes: \"OriscusDes\",\r\n  OriscusLiquescent: \"OriscusLiquescent\",\r\n\r\n  PodatusLower: \"PodatusLower\",\r\n  PodatusUpper: \"PodatusUpper\",\r\n\r\n  Porrectus1: \"Porrectus1\", // 1 staff line difference,\r\n  Porrectus2: \"Porrectus2\", // 2 lines difference, etc...\r\n  Porrectus3: \"Porrectus3\",\r\n  Porrectus4: \"Porrectus4\",\r\n\r\n  PunctumCavum: \"PunctumCavum\",\r\n  PunctumCuadratum: \"PunctumCuadratum\",\r\n  PunctumCuadratumAscLiquescent: \"PunctumCuadratumAscLiquescent\",\r\n  PunctumCuadratumDesLiquescent: \"PunctumCuadratumDesLiquescent\",\r\n  PunctumInclinatum: \"PunctumInclinatum\",\r\n  PunctumInclinatumLiquescent: \"PunctumInclinatumLiquescent\",\r\n  Quilisma: \"Quilisma\",\r\n\r\n  TerminatingAscLiquescent: \"TerminatingAscLiquescent\",\r\n  TerminatingDesLiquescent: \"TerminatingDesLiquescent\",\r\n  VerticalEpisemaAbove: \"VerticalEpisemaAbove\",\r\n  VerticalEpisemaBelow: \"VerticalEpisemaBelow\",\r\n  VirgaLong: \"VirgaLong\",\r\n  VirgaShort: \"VirgaShort\",\r\n  Virgula: \"Virgula\"\r\n}; // GlyphCode\r\n\r\nexport var QuickSvg = {\r\n\r\n  // namespaces  \r\n  ns: 'http://www.w3.org/2000/svg',\r\n  xmlns: 'http://www.w3.org/2000/xmlns/',\r\n  xlink: 'http://www.w3.org/1999/xlink',\r\n\r\n  // create the root level svg object\r\n  svg: function(width, height) {\r\n    var node = document.createElementNS(this.ns,'svg');\r\n\r\n    node.setAttribute('xmlns', this.ns); \r\n    node.setAttribute('version', '1.1');\r\n    node.setAttributeNS(this.xmlns, 'xmlns:xlink', this.xlink);\r\n\r\n    node.setAttribute('width', width);\r\n    node.setAttribute('height', height);\r\n\r\n    // create the defs element\r\n    var defs = document.createElementNS(this.ns, 'defs');\r\n    node.appendChild(defs);\r\n\r\n    node.defs = defs;\r\n\r\n    node.clearNotations = function() {\r\n      // clear out all children except defs\r\n      node.removeChild(defs);\r\n\r\n      while (node.hasChildNodes())\r\n        node.removeChild(node.lastChild);\r\n      \r\n      node.appendChild(defs);\r\n    }\r\n\r\n    return node;\r\n  },\r\n\r\n  defs: function() {\r\n    return node;\r\n  },\r\n\r\n  rect: function(width, height) {\r\n    var node = document.createElementNS(this.ns, 'rect');\r\n\r\n    node.setAttribute('width', width);\r\n    node.setAttribute('height', height);\r\n\r\n    return node;\r\n  },\r\n\r\n  line: function(x1, y1, x2, y2) {\r\n    var node = document.createElementNS(this.ns, 'line');\r\n\r\n    node.setAttribute('x1', x1);\r\n    node.setAttribute('y1', y1);\r\n    node.setAttribute('x2', x2);\r\n    node.setAttribute('y2', y2);\r\n\r\n    return node;\r\n  },\r\n\r\n  g: function() {\r\n    var node = document.createElementNS(this.ns, 'g');\r\n\r\n    return node;\r\n  },\r\n\r\n  text: function() {\r\n    var node = document.createElementNS(this.ns, 'text');\r\n\r\n    return node;\r\n  },\r\n\r\n  tspan: function(str) {\r\n    var node = document.createElementNS(this.ns, 'tspan');\r\n    node.textContent = str;\r\n\r\n    return node;\r\n  },\r\n\r\n  // nodeRef should be the id of the object in defs (without the #)\r\n  use: function(nodeRef) {\r\n    var node = document.createElementNS(this.ns, 'use');\r\n    node.setAttributeNS(this.xlink, \"xlink:href\", '#' + nodeRef);\r\n\r\n    return node;\r\n  },\r\n\r\n  createFragment: function(name, attributes, child) {\r\n    if (child === undefined || child === null)\r\n      child = '';\r\n\r\n    var fragment = '<' + name + ' ';\r\n\r\n    for (var attr in attributes) {\r\n      if (attributes.hasOwnProperty(attr))\r\n        fragment += attr + '=\"' + attributes[attr] + '\" ';\r\n    }\r\n\r\n    fragment += '>' + child + '</' + name + '>';\r\n\r\n    return fragment;\r\n  },\r\n\r\n  parseFragment: function(fragment) {\r\n\r\n    // create temporary holder\r\n    var well = document.createElement('svg');\r\n\r\n    // act as a setter if svg is given\r\n    if (fragment) {\r\n\r\n      var container = this.g();\r\n\r\n      // dump raw svg\r\n      // do this to allow the browser to automatically create svg nodes?\r\n      well.innerHTML = '<svg>' + fragment.replace(/\\n/, '').replace(/<(\\w+)([^<]+?)\\/>/g, '<$1$2></$1>') + '</svg>'\r\n\r\n      // transplant nodes\r\n      for (var i = 0, il = well.firstChild.childNodes.length; i < il; i++)\r\n        container.appendChild(well.firstChild.firstChild)\r\n      \r\n      return container;\r\n    }\r\n  },\r\n\r\n  translate: function(node, x, y) {\r\n    node.setAttribute('transform', 'translate(' + x + ',' + y + ')');\r\n    return node;\r\n  },\r\n\r\n  scale: function(node, sx, sy) {\r\n    node.setAttribute('transform', 'scale(' + sx + ',' + sy + ')');\r\n    return node;\r\n  }\r\n}\r\n\r\n/*\r\n * ChantContext\r\n */\r\nexport class ChantContext {\r\n\r\n  constructor() {\r\n\r\n    this.defs = {};\r\n\r\n    // font styles\r\n    this.lyricTextSize = 16; // in points?\r\n    this.lyricTextFont = \"'Palatino Linotype', 'Book Antiqua', Palatino, serif\";\r\n    this.lyricTextColor = \"#000\";\r\n    \r\n    this.dropCapTextSize = 64;\r\n    this.dropCapTextFont = this.lyricTextFont;\r\n    this.dropCapTextColor = this.lyricTextColor;\r\n    \r\n    this.annotationTextSize = 13;\r\n    this.annotationTextFont = this.lyricTextFont;\r\n    this.annotationTextColor = this.lyricTextColor;\r\n\r\n    // everything depends on the scale of the punctum\r\n    this.glyphPunctumWidth = Glyphs.PunctumCuadratum.bounds.width;\r\n    this.glyphPunctumHeight = Glyphs.PunctumCuadratum.bounds.height;\r\n\r\n    // fixme: for now, we just set these using the glyph scales as noted above, presuming a\r\n    // staff line size of 0.5 in. Really what we should do is scale the punctum size based\r\n    // on the text metrics, right? 1 punctum ~ x height size?\r\n    this.glyphScaling = 1.0 / 16.0; \r\n\r\n    this.staffInterval = this.glyphPunctumWidth * this.glyphScaling;\r\n    this.staffLineWeight = this.glyphPunctumWidth * this.glyphScaling / 8;\r\n    this.neumeLineWeight = this.glyphPunctumWidth * this.glyphScaling / 8; // the weight of connecting lines in the glyphs.\r\n    this.dividerLineWeight = this.neumeLineWeight; // of quarter bar, half bar, etc.\r\n    this.episemaLineWeight = this.neumeLineWeight; // of horizontal episemae\r\n\r\n    // for keeping track of the clef\r\n    this.activeClef = null;\r\n\r\n    this.staffLineColor = \"#000\";\r\n    this.dividerLineColor = \"#000\";\r\n\r\n    this.defaultLanguage = new Latin();\r\n\r\n    this.svgTextMeasurer = QuickSvg.svg(1,1);\r\n    this.svgTextMeasurer.setAttribute('id', \"TextMeasurer\");\r\n    document.querySelector('body').appendChild(this.svgTextMeasurer);\r\n\r\n    // measure the size of a hyphen for the lyrics\r\n    var hyphen = new Lyric(this, \"-\", LyricType.SingleSyllable);\r\n    this.hyphenWidth = hyphen.bounds.width;\r\n\r\n    this.minLyricWordSpacing = this.hyphenWidth;\r\n\r\n    this.intraNeumeSpacing = this.staffInterval / 2.0;\r\n\r\n    // for connecting neume syllables...\r\n    this.syllableConnector = '-';\r\n\r\n    this.drawGuides = false;\r\n    this.drawDebuggingBounds = true;\r\n\r\n    // chant notation elements are normally separated by a minimum fixed amount of space\r\n    // on the staff line. It can happen, however, that two text elements are almost close\r\n    // enough to merge, only to be separated much more by the required hyphen (or other\r\n    // connecting string).\r\n    //\r\n    // This tolerance value allows a little bit of flexibility to merge two close lyrical\r\n    // elements, thus bringing the chant notation elements a bit closer than otherwise\r\n    // would be normally allowed.\r\n    //\r\n    // condensing tolerance is a percentage value (0.0-1.0, inclusive) that indicates\r\n    // how much the default spacing can shrink. E.g., a value of 0.80 allows the layout\r\n    // engine to separate two glyphs by only 80% of the normal inter-neume spacing value.\r\n    //\r\n    // fixme: condensing tolerance is not implemented yet!\r\n    this.condensingTolerance = 0.9;\r\n\r\n    // if auto color is true, then exsurge tries to automatically colorize\r\n    // some elements of the chant (directives become rubric color, etc.)\r\n    this.autoColor = true;\r\n\r\n    this.insertFontsInDoc();\r\n  }\r\n\r\n  calculateHeightFromStaffPosition(staffPosition) {\r\n    return -staffPosition * this.staffInterval;\r\n  }\r\n\r\n  insertFontsInDoc() {\r\n\r\n    var styleElement = document.getElementById('exsurge-fonts');\r\n\r\n    if (styleElement === null) {\r\n      // create it since it doesn't exist yet.\r\n      styleElement = document.createElement('style');\r\n      styleElement.id = 'exsurge-fonts';\r\n\r\n      styleElement.appendChild(document.createTextNode(\"@font-face{font-family: 'Exsurge Characters';font-weight: normal;font-style: normal;src: url(\" + __exsurgeCharactersFont + \") format('opentype');}\"));\r\n\r\n      document.head.appendChild(styleElement);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n/*\r\n * ChantLayoutElement\r\n */\r\nexport class ChantLayoutElement {\r\n\r\n  constructor() {\r\n\r\n    this.bounds = new Rect();\r\n    this.origin = new Point(0, 0);\r\n\r\n    this.selected = false;\r\n    this.highlighted = false;\r\n  }\r\n\r\n  // draws the element an html5 canvas\r\n  draw(ctxt) {\r\n\r\n  }\r\n\r\n  // returns svg code for the element, used for printing support\r\n  createDrawable(ctxt) {\r\n    throw \"ChantLayout Elements must implement createDrawable(ctxt)\";\r\n  }\r\n}\r\n\r\n\r\nexport class DividerLineVisualizer extends ChantLayoutElement {\r\n\r\n  constructor(ctxt, staffPosition0, staffPosition1) {\r\n    super();\r\n\r\n    var y0 = ctxt.calculateHeightFromStaffPosition(staffPosition0);\r\n    var y1 = ctxt.calculateHeightFromStaffPosition(staffPosition1);\r\n\r\n    if (y0 > y1) {\r\n      var temp = y0;\r\n      y0 = y1;\r\n      y1 = temp;\r\n    }\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = y0;\r\n    this.bounds.width = ctxt.dividerLineWeight;\r\n    this.bounds.height = y1 - y0;\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n    this.origin.y = y0;\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    return QuickSvg.createFragment('rect', {\r\n      'x': this.bounds.x,\r\n      'y': this.bounds.y,\r\n      'width': ctxt.dividerLineWeight,\r\n      'height': this.bounds.height,\r\n      'fill': ctxt.dividerLineColor,\r\n      'class': 'dividerLine'\r\n    });\r\n  }\r\n}\r\n\r\nexport class NeumeLineVisualizer extends ChantLayoutElement {\r\n\r\n  constructor(ctxt, note0, note1, hanging) {\r\n    super();\r\n\r\n    var y0 = ctxt.calculateHeightFromStaffPosition(note0.staffPosition);\r\n    var y1 = ctxt.calculateHeightFromStaffPosition(note1.staffPosition);\r\n\r\n    if (y0 > y1) {\r\n      var temp = y0;\r\n      y0 = y1;\r\n      y1 = temp;\r\n    }\r\n\r\n    if (hanging)\r\n      y1 += ctxt.glyphPunctumHeight * ctxt.glyphScaling / 2.2;\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = y0;\r\n    this.bounds.width = ctxt.neumeLineWeight;\r\n    this.bounds.height = y1 - y0;\r\n\r\n    this.origin.x = 0;\r\n    this.origin.y = 0;\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    return QuickSvg.createFragment('rect', {\r\n      'x': this.bounds.x,\r\n      'y': this.bounds.y,\r\n      'width': ctxt.neumeLineWeight,\r\n      'height': this.bounds.height,\r\n      'fill': ctxt.neumeLineColor,\r\n      'class': 'neumeLine'\r\n    });\r\n  }\r\n}\r\n\r\nexport class HorizontalEpisemaVisualizer extends ChantLayoutElement {\r\n\r\n  constructor(ctxt, x, y, width) {\r\n    super();\r\n\r\n    this.bounds.x = x;\r\n    this.bounds.y = y;\r\n    this.bounds.width = width;\r\n    this.bounds.height = ctxt.episemaLineWeight;\r\n\r\n    this.origin.x = 0;\r\n    this.origin.y = 0;\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    return QuickSvg.createFragment('rect', {\r\n      'x': this.bounds.x,\r\n      'y': this.bounds.y,\r\n      'width': this.bounds.width,\r\n      'height': this.bounds.height,\r\n      'fill': ctxt.neumeLineColor,\r\n      'class': 'horizontalEpisema'\r\n    });\r\n  }\r\n}\r\n\r\n\r\nexport class GlyphVisualizer extends ChantLayoutElement {\r\n\r\n  constructor(ctxt, glyphCode) {\r\n    super();\r\n\r\n    this.glyph = null;\r\n\r\n    this.setGlyph(ctxt, glyphCode);\r\n  }\r\n\r\n  setGlyph(ctxt, glyphCode) {\r\n\r\n    if (this.glyphCode === glyphCode)\r\n      return;\r\n\r\n    if (typeof glyphCode === 'undefined' || glyphCode === null || glyphCode === \"\")\r\n      this.glyphCode = GlyphCode.None;\r\n    else\r\n      this.glyphCode = glyphCode;\r\n\r\n    this.glyph = Glyphs[this.glyphCode];\r\n\r\n    // if this glyph hasn't been used yet, then load it up in the defs section for sharing\r\n    if (!ctxt.defs.hasOwnProperty(this.glyphCode)) {\r\n      var glyphSrc = this.glyph.svgSrc;\r\n\r\n      // create the ref\r\n      ctxt.defs[this.glyphCode] = QuickSvg.createFragment('g', {\r\n        id: this.glyphCode,\r\n        'class': 'glyph',\r\n        transform: 'scale(' + ctxt.glyphScaling + ')'\r\n      }, glyphSrc);\r\n    }\r\n\r\n\r\n    this.origin.x = this.glyph.origin.x * ctxt.glyphScaling;\r\n    this.origin.y = this.glyph.origin.y * ctxt.glyphScaling;\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = -this.origin.y;\r\n    this.bounds.width = this.glyph.bounds.width * ctxt.glyphScaling;\r\n    this.bounds.height = this.glyph.bounds.height * ctxt.glyphScaling;\r\n  }\r\n\r\n  setStaffPosition(ctxt, staffPosition) {\r\n    this.bounds.y += ctxt.calculateHeightFromStaffPosition(staffPosition);\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    return QuickSvg.createFragment('use', {\r\n      'xlink:href': '#' + this.glyphCode,\r\n      x: this.bounds.x + this.origin.x,\r\n      y: this.bounds.y + this.origin.y\r\n    });\r\n  }\r\n}\r\n\r\nvar TextSpan = function(text, properties) {\r\n  if (typeof properties === 'undefined' || properties === null)\r\n    properties = \"\";\r\n\r\n  this.text = text;\r\n  this.properties = properties;\r\n};\r\n\r\nvar boldMarkup = \"*\";\r\nvar italicMarkup = \"_\";\r\nvar redMarkup = \"^\";\r\nvar smallCapsMarkup = \"%\";\r\n\r\nfunction MarkupStackFrame(symbol, startIndex, properties) {\r\n  this.symbol = symbol;\r\n  this.startIndex = startIndex;\r\n  this.properties = properties;\r\n}\r\n\r\nMarkupStackFrame.createStackFrame = function(symbol, startIndex) {\r\n\r\n  var properties = \"\";\r\n\r\n  switch(symbol) {\r\n    case boldMarkup:\r\n      properties = 'font-weight:bold;';\r\n      break;\r\n    case italicMarkup:\r\n      properties = 'font-style:italic;';\r\n      break;\r\n    case redMarkup:\r\n      properties = 'fill:#f00;'; // SVG text color is set by the fill property\r\n      break;\r\n    case smallCapsMarkup:\r\n      properties = \"font-variant:small-caps;font-feature-settings:'smcp';-webkit-font-feature-settings:'smcp';\";\r\n      break;\r\n  }\r\n\r\n  return new MarkupStackFrame(symbol, startIndex, properties);\r\n};\r\n\r\n\r\n// for escaping html strings before they go into the svgs\r\n// adapted from http://stackoverflow.com/a/12034334/5720160\r\nvar __subsForTspans = {\r\n  \"&\": \"&amp;\",\r\n  \"<\": \"&lt;\",\r\n  \">\": \"&gt;\"\r\n};\r\n\r\nexport class TextElement extends ChantLayoutElement {\r\n\r\n  constructor(ctxt, text, fontFamily, fontSize, textAnchor) {\r\n    super();\r\n\r\n    // set these to some sane values for now...\r\n    this.bounds.x = 0;\r\n    this.bounds.y = 0;\r\n    this.bounds.width = 0;\r\n    this.bounds.height = 0;\r\n    this.origin.x = 0;\r\n    this.origin.y = 0;\r\n\r\n    this.fontFamily = fontFamily;\r\n    this.fontSize = fontSize;\r\n    this.textAnchor = textAnchor;\r\n    this.dominantBaseline = 'baseline'; // default placement\r\n\r\n    this.generateSpansFromText(ctxt, text);\r\n\r\n    this.recalculateMetrics(ctxt);\r\n  }\r\n\r\n  generateSpansFromText(ctxt, text) {\r\n\r\n    this.unsanitizedText = text;\r\n    this.text = \"\";\r\n    this.spans = [];\r\n\r\n    // save ourselves a lot of grief for a very common text:\r\n    if (text === \"*\" || text === \"\") {\r\n      this.spans.push(new TextSpan(text, \"\"));\r\n      return;\r\n    }\r\n\r\n    var markupStack = [];\r\n    var spanStartIndex = 0;\r\n\r\n    var filterFrames = (frame, symbol) => frame.Symbol === symbol;\r\n\r\n    var that = this;\r\n    var closeSpan = function (spanText, extraProperties) {\r\n      if (spanText === \"\")\r\n        return;\r\n\r\n      that.text += spanText;\r\n\r\n      var properties = \"\";\r\n      for (var i = 0; i < markupStack.length; i++)\r\n        properties += markupStack[i].properties;\r\n\r\n      if (extraProperties)\r\n        properties = properties + extraProperties;\r\n\r\n      that.spans.push(new TextSpan(spanText, properties));\r\n    };\r\n\r\n    var markupRegex = /(\\*|_|\\^|%|[ARVarv]\\/\\.)/g;\r\n\r\n    var match = null;\r\n    while ((match = markupRegex.exec(text))) {\r\n\r\n      var markupSymbol = match[0];\r\n\r\n      // non-matching symbols first\r\n      if (markupSymbol === \"A/.\" || markupSymbol === \"R/.\" || markupSymbol === \"V/.\" ||\r\n          markupSymbol === \"a/.\" || markupSymbol === \"r/.\" || markupSymbol === \"v/.\") {\r\n        closeSpan(text[match.index] + \".\", \"font-family:'Exsurge Characters';fill:#f00;\");\r\n      } else if (markupStack.length === 0) {\r\n        // otherwise we're dealing with matching markup delimeters\r\n        // if this is our first markup frame, then just create an inline for preceding text and push the stack frame\r\n        closeSpan(text.substring(spanStartIndex, match.index));\r\n        markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol, match.index));\r\n      } else {\r\n\r\n        if (markupStack[markupStack.length - 1].symbol === markupSymbol) {\r\n          // group close\r\n          closeSpan(text.substring(spanStartIndex, match.index));\r\n          markupStack.pop();\r\n        } else if (markupStack.filter(filterFrames).length > 0) {\r\n          // trying to open a recursive group (or forgot to close a previous group)\r\n          // in either case, we just unwind to the previous stack frame\r\n          spanStartIndex = markupStack[markupStack.length - 1].startIndex;\r\n          markupStack.pop();\r\n          continue;\r\n        } else {\r\n          // group open\r\n          closeSpan(text.substring(spanStartIndex, match.index));\r\n          markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol, match.index));\r\n        }\r\n      }\r\n\r\n      // advance the start index past the current markup\r\n      spanStartIndex = match.index + markupSymbol.length;\r\n    }\r\n\r\n    // if we finished matches, and there is still some text left, create one final run\r\n    if (spanStartIndex < text.length)\r\n      closeSpan(text.substring(spanStartIndex, text.length));\r\n\r\n    // if after all of that we still didn't create any runs, then just add the entire text\r\n    // string itself as a run\r\n    if (this.spans.length === 0)\r\n      closeSpan(text);\r\n  }\r\n\r\n  recalculateMetrics(ctxt) {\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = 0;\r\n\r\n    var xml = '<svg xmlns=\"http://www.w3.org/2000/svg\">' + this.createDrawable(ctxt) + '</svg>';\r\n    var doc = new DOMParser().parseFromString(xml, 'application/xml');\r\n    while(ctxt.svgTextMeasurer.firstChild) {\r\n      ctxt.svgTextMeasurer.firstChild.remove();\r\n    }\r\n    ctxt.svgTextMeasurer.appendChild( ctxt.svgTextMeasurer.ownerDocument.importNode(doc.documentElement, true).firstChild );\r\n\r\n    var bbox = ctxt.svgTextMeasurer.firstChild.getBBox();\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = 0;\r\n    this.bounds.width = bbox.width;\r\n    this.bounds.height = bbox.height;\r\n    this.origin.x = 0;\r\n    this.origin.y = 0; // baseline?\r\n  }\r\n\r\n  getCssClasses() {\r\n    return \"\";\r\n  }\r\n\r\n  getExtraStyleProperties(ctxt) {\r\n    return \"\";\r\n  }\r\n\r\n  static escapeForTspan(string) {\r\n    return String(string).replace(/[&<>]/g, function (s) {\r\n      return __subsForTspans[s];\r\n    });\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    var spans = \"\";\r\n\r\n    for (var i = 0; i < this.spans.length; i++) {\r\n      var options = {};\r\n\r\n      if (this.spans[i].properties)\r\n        options['style'] = this.spans[i].properties;\r\n\r\n      spans += QuickSvg.createFragment('tspan', options, TextElement.escapeForTspan(this.spans[i].text));\r\n    }\r\n\r\n    var styleProperties = \"font-family:\" + this.fontFamily +\r\n      \";font-size:\" + this.fontSize + \"px\" +\r\n      \";font-kerning:normal;\" +\r\n      this.getExtraStyleProperties(ctxt);\r\n\r\n    return QuickSvg.createFragment('text', {\r\n      'x': this.bounds.x,\r\n      'y': this.bounds.y,\r\n      'class': this.getCssClasses().trim(),\r\n      'text-anchor': this.textAnchor,\r\n      'dominant-baseline': this.dominantBaseline,\r\n      'style': styleProperties\r\n    }, spans);\r\n  }\r\n}\r\n\r\nexport var LyricType = {\r\n  SingleSyllable: 0,\r\n  BeginningSyllable: 1,\r\n  MiddleSyllable: 2,\r\n  EndingSyllable: 3,\r\n\r\n  Directive: 4 // for asterisks, \"ij.\" elements, or other performance notes.\r\n};\r\n\r\nexport class Lyric extends TextElement {\r\n  constructor(ctxt, text, lyricType) {\r\n    super(ctxt, text, ctxt.lyricTextFont, ctxt.lyricTextSize, 'start');\r\n\r\n    this.cssClasses += \" Lyric\";\r\n\r\n    if (typeof lyricType === 'undefined' || lyricType === null || lyricType === \"\")\r\n      this.lyricType = LyricType.SingleSyllable;\r\n    else\r\n      this.lyricType = lyricType;\r\n\r\n    this.needsConnector = false;\r\n  }\r\n\r\n  allowsConnector() {\r\n    return this.lyricType === LyricType.BeginningSyllable ||\r\n            this.lyricType === LyricType.MiddleSyllable;\r\n  }\r\n\r\n  setNeedsConnector(needs) {\r\n    if (needs === true) {\r\n      this.needsConnector = true;\r\n      this.bounds.width = this.widthWithConnector;\r\n\r\n      if (this.spans.length > 0)\r\n        this.spans[this.spans.length - 1].text = this.lastSpanTextWithConnector;\r\n    } else {\r\n      this.needsConnector = false;\r\n      this.bounds.width = this.widthWithoutConnector;\r\n\r\n      if (this.spans.length > 0)\r\n        this.spans[this.spans.length - 1].text = this.lastSpanText;\r\n    }\r\n  }\r\n\r\n  generateSpansFromText(ctxt, text) {\r\n    super.generateSpansFromText(ctxt, text);\r\n\r\n    if (this.spans.length > 0) {\r\n      this.lastSpanText = this.spans[this.spans.length - 1].text;\r\n      this.lastSpanTextWithConnector = this.lastSpanText + ctxt.syllableConnector;\r\n    } else {\r\n      this.lastSpanText = \"\";\r\n      this.lastSpanTextWithConnector = \"\";\r\n    }\r\n  }\r\n\r\n  recalculateMetrics(ctxt) {\r\n    super.recalculateMetrics(ctxt);\r\n\r\n    this.widthWithoutConnector = this.bounds.width;\r\n    this.textWithConnector = this.text + ctxt.syllableConnector;\r\n\r\n    this.widthWithConnector = this.bounds.width + ctxt.hyphenWidth;\r\n\r\n    var activeLanguage = ctxt.defaultLanguage;\r\n\r\n    // calculate the point where the text lines up to the staff notation\r\n    // and offset the rect that much\r\n    var offset = 0;\r\n\r\n    if (this.lyricType !== LyricType.Directive) {\r\n\r\n      // Non-directive elements are lined up to the chant notation based on vowel segments.\r\n      // First we determine the vowel segment of the text, then we calculate the center point\r\n      // of that vowel segment.\r\n      var result = activeLanguage.findVowelSegment(this.text, 0);\r\n      if (result.found === true) {\r\n\r\n        // svgTextMeasurer still has the current lyric in it...\r\n        \r\n\r\n        var x1 = ctxt.svgTextMeasurer.firstChild.getSubStringLength(0, result.startIndex);\r\n        var x2 = ctxt.svgTextMeasurer.firstChild.getSubStringLength(0, result.startIndex + result.length);\r\n\r\n        offset = x1 + (x2 - x1) / 2;\r\n      } else {\r\n        // no vowels found according the text's language. for now we just center the text\r\n        offset = this.widthWithoutConnector / 2;\r\n      }\r\n\r\n    } else {\r\n      // directives are always centered on the chant notation\r\n      offset = this.widthWithoutConnector / 2;\r\n    }\r\n\r\n    this.bounds.x = -offset;\r\n    this.bounds.y = 0;\r\n\r\n    this.origin.x = offset;\r\n\r\n    this.bounds.width = this.widthWithoutConnector;\r\n    this.bounds.height = ctxt.lyricTextSize;\r\n  }\r\n\r\n  getCssClasses() {\r\n\r\n    var classes = \"lyric \";\r\n\r\n    if (this.lyricType === LyricType.Directive)\r\n      classes += \"directive \";\r\n\r\n    return classes + super.getCssClasses();\r\n  }\r\n\r\n  getExtraStyleProperties(ctxt) {\r\n    var props = super.getExtraStyleProperties();\r\n\r\n    if (this.lyricType === LyricType.Directive && ctxt.autoColor === true)\r\n      props += \"fill:#f00;\";\r\n\r\n    return props;\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n    if (this.spans.length > 0) {\r\n      if (this.needsConnector)\r\n        this.spans[this.spans.length - 1].text = this.lastSpanTextWithConnector;\r\n      else\r\n        this.spans[this.spans.length - 1].text = this.lastSpanText;\r\n    }\r\n\r\n    return super.createDrawable(ctxt);\r\n  }\r\n}\r\n\r\nexport class DropCap extends TextElement {\r\n\r\n  /**\r\n   * @param {String} text\r\n   */\r\n  constructor(ctxt, text) {\r\n    super(ctxt, text, ctxt.dropCapTextFont, ctxt.dropCapTextSize, 'middle');\r\n\r\n    this.padding = ctxt.staffInterval * 2;\r\n  }\r\n\r\n  getCssClasses() {\r\n    return \"dropCap \" + super.getCssClasses();\r\n  }\r\n}\r\n\r\nexport class Annotation extends TextElement {\r\n\r\n  /**\r\n   * @param {String} text\r\n   */\r\n  constructor(ctxt, text) {\r\n    super(ctxt, text, ctxt.annotationTextFont, ctxt.annotationTextSize, 'middle');\r\n    this.padding = ctxt.staffInterval;\r\n    this.dominantBaseline = 'hanging'; // so that annotations can be aligned at the top.\r\n  }\r\n\r\n  getCssClasses() {\r\n    return \"annotation \" + super.getCssClasses();\r\n  }\r\n}\r\n\r\n\r\n\r\nexport class ChantNotationElement extends ChantLayoutElement {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    //double\r\n    this.leadingSpace = 0.0;\r\n    this.trailingSpace = -1; // if less than zero, this is automatically calculated at layout time\r\n    this.keepWithNext = false;\r\n\r\n    this.lyric = null;\r\n\r\n    this.score = null; // the ChantScore\r\n    this.line = null; // the ChantLine\r\n\r\n    this.visualizers = [];\r\n  }\r\n\r\n  hasLyric() {\r\n    if (this.lyric !== null)\r\n      return true;\r\n    else\r\n      return false;\r\n  }\r\n\r\n  getLyricLeft() {\r\n    return this.bounds.x + this.lyric.bounds.x;\r\n  }\r\n\r\n  getLyricRight() {\r\n    return this.bounds.x + this.lyric.bounds.x + this.lyric.bounds.width;\r\n  }\r\n\r\n  // used by subclasses while building up the chant notations.\r\n  addVisualizer(chantLayoutElement) {\r\n    if (this.bounds.isEmpty())\r\n      this.bounds = chantLayoutElement.bounds.clone();\r\n    else\r\n      this.bounds.union(chantLayoutElement.bounds);\r\n\r\n    this.visualizers.push(chantLayoutElement);\r\n  }\r\n\r\n  // same as addVisualizer, except the element is unshifted to the front\r\n  // of the visualizer array rather than the end. This way, some\r\n  // visualizers can be placed behind the others...ledge lines for example.\r\n  prependVisualizer(chantLayoutElement) {\r\n    if (this.bounds.isEmpty())\r\n      this.bounds = chantLayoutElement.bounds.clone();\r\n    else\r\n      this.bounds.union(chantLayoutElement.bounds);\r\n\r\n    this.visualizers.unshift(chantLayoutElement);\r\n  }\r\n\r\n  // chant notation elements are given an opportunity to perform their layout via this function.\r\n  // subclasses should call this function first in overrides of this function.\r\n  // on completion, exsurge presumes that the bounds, the origin, and the drawable objects are\r\n  // all valid and prepared for higher level layout.\r\n  performLayout(ctxt) {\r\n\r\n    if (this.trailingSpace < 0)\r\n      this.trailingSpace = ctxt.intraNeumeSpacing * 4;\r\n\r\n    // reset the bounds and the staff notations before doing a layout\r\n    this.visualizers = [];\r\n    this.bounds = new Rect(Infinity, Infinity, -Infinity, -Infinity);\r\n\r\n    if (this.hasLyric())\r\n      this.lyric.recalculateMetrics(ctxt);\r\n  }\r\n\r\n  // a helper function for subclasses to call after they are done performing layout...\r\n  finishLayout(ctxt) {\r\n    //this.origin.x -= -this.bounds.x;\r\n    this.bounds.x = 0;\r\n\r\n    // add the lyric and line it up\r\n    if (this.hasLyric())\r\n      this.lyric.bounds.x = this.origin.x - this.lyric.origin.x;\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n    var inner = \"\";\r\n\r\n    for (var i = 0; i < this.visualizers.length; i++)\r\n      inner += this.visualizers[i].createDrawable(ctxt);\r\n\r\n    if (this.lyric)\r\n      inner += this.lyric.createDrawable(ctxt);\r\n\r\n    return QuickSvg.createFragment('g', {\r\n      'class': 'ChantNotationElement ' + this.constructor.name,\r\n      'transform': 'translate(' + this.bounds.x + ',' + 0 + ')'\r\n    }, inner);\r\n  }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Drawing.js\n **/","module.exports = \"data:font/opentype;base64,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eHN1cmdlIENoYXJhY3RlcnM6VmVyc2lvbiAxLjAwVmVyc2lvbiAxLjAwIEZlYnJ1YXJ5IDE4LCAyMDE2LCBpbml0aWFsIHJlbGVhc2VFeHN1cmdlQ2hhcmFjdGVyc1RoaXMgRm9udCBTb2Z0d2FyZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgU0lMIE9wZW4gRm9udCBMaWNlbnNlLCBWZXJzaW9uIDEuMS4gVGhpcyBsaWNlbnNlIGlzIGNvcGllZCBiZWxvdywgYW5kIGlzIGFsc28gYXZhaWxhYmxlIHdpdGggYSBGQVEgYXQ6IGh0dHA6Ly9zY3JpcHRzLnNpbC5vcmcvT0ZMDQoNCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClNJTCBPUEVOIEZPTlQgTElDRU5TRSBWZXJzaW9uIDEuMSAtIDI2IEZlYnJ1YXJ5IDIwMDcNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNClBSRUFNQkxFDQpUaGUgZ29hbHMgb2YgdGhlIE9wZW4gRm9udCBMaWNlbnNlIChPRkwpIGFyZSB0byBzdGltdWxhdGUgd29ybGR3aWRlIGRldmVsb3BtZW50IG9mIGNvbGxhYm9yYXRpdmUgZm9udCBwcm9qZWN0cywgdG8gc3VwcG9ydCB0aGUgZm9udCBjcmVhdGlvbiBlZmZvcnRzIG9mIGFjYWRlbWljIGFuZCBsaW5ndWlzdGljIGNvbW11bml0aWVzLCBhbmQgdG8gcHJvdmlkZSBhIGZyZWUgYW5kIG9wZW4gZnJhbWV3b3JrIGluIHdoaWNoIGZvbnRzIG1heSBiZSBzaGFyZWQgYW5kIGltcHJvdmVkIGluIHBhcnRuZXJzaGlwIHdpdGggb3RoZXJzLg0KDQpUaGUgT0ZMIGFsbG93cyB0aGUgbGljZW5zZWQgZm9udHMgdG8gYmUgdXNlZCwgc3R1ZGllZCwgbW9kaWZpZWQgYW5kIHJlZGlzdHJpYnV0ZWQgZnJlZWx5IGFzIGxvbmcgYXMgdGhleSBhcmUgbm90IHNvbGQgYnkgdGhlbXNlbHZlcy4gVGhlIGZvbnRzLCBpbmNsdWRpbmcgYW55IGRlcml2YXRpdmUgd29ya3MsIGNhbiBiZSBidW5kbGVkLCBlbWJlZGRlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSBwcm92aWRlZCB0aGF0IGFueSByZXNlcnZlZCBuYW1lcyBhcmUgbm90IHVzZWQgYnkgZGVyaXZhdGl2ZSB3b3Jrcy4gVGhlIGZvbnRzIGFuZCBkZXJpdmF0aXZlcywgaG93ZXZlciwgY2Fubm90IGJlIHJlbGVhc2VkIHVuZGVyIGFueSBvdGhlciB0eXBlIG9mIGxpY2Vuc2UuIFRoZSByZXF1aXJlbWVudCBmb3IgZm9udHMgdG8gcmVtYWluIHVuZGVyIHRoaXMgbGljZW5zZSBkb2VzIG5vdCBhcHBseSB0byBhbnkgZG9jdW1lbnQgY3JlYXRlZCB1c2luZyB0aGUgZm9udHMgb3IgdGhlaXIgZGVyaXZhdGl2ZXMuDQoNCkRFRklOSVRJT05TDQoiRm9udCBTb2Z0d2FyZSIgcmVmZXJzIHRvIHRoZSBzZXQgb2YgZmlsZXMgcmVsZWFzZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykgdW5kZXIgdGhpcyBsaWNlbnNlIGFuZCBjbGVhcmx5IG1hcmtlZCBhcyBzdWNoLiBUaGlzIG1heSBpbmNsdWRlIHNvdXJjZSBmaWxlcywgYnVpbGQgc2NyaXB0cyBhbmQgZG9jdW1lbnRhdGlvbi4NCg0KIlJlc2VydmVkIEZvbnQgTmFtZSIgcmVmZXJzIHRvIGFueSBuYW1lcyBzcGVjaWZpZWQgYXMgc3VjaCBhZnRlciB0aGUgY29weXJpZ2h0IHN0YXRlbWVudChzKS4NCg0KIk9yaWdpbmFsIFZlcnNpb24iIHJlZmVycyB0byB0aGUgY29sbGVjdGlvbiBvZiBGb250IFNvZnR3YXJlIGNvbXBvbmVudHMgYXMgZGlzdHJpYnV0ZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykuDQoNCiJNb2RpZmllZCBWZXJzaW9uIiByZWZlcnMgdG8gYW55IGRlcml2YXRpdmUgbWFkZSBieSBhZGRpbmcgdG8sIGRlbGV0aW5nLCBvciBzdWJzdGl0dXRpbmcgLS0gaW4gcGFydCBvciBpbiB3aG9sZSAtLSBhbnkgb2YgdGhlIGNvbXBvbmVudHMgb2YgdGhlIE9yaWdpbmFsIFZlcnNpb24sIGJ5IGNoYW5naW5nIGZvcm1hdHMgb3IgYnkgcG9ydGluZyB0aGUgRm9udCBTb2Z0d2FyZSB0byBhIG5ldyBlbnZpcm9ubWVudC4NCg0KIkF1dGhvciIgcmVmZXJzIHRvIGFueSBkZXNpZ25lciwgZW5naW5lZXIsIHByb2dyYW1tZXIsIHRlY2huaWNhbCB3cml0ZXIgb3Igb3RoZXIgcGVyc29uIHdobyBjb250cmlidXRlZCB0byB0aGUgRm9udCBTb2Z0d2FyZS4NCg0KUEVSTUlTU0lPTiAmIENPTkRJVElPTlMNClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhlIEZvbnQgU29mdHdhcmUsIHRvIHVzZSwgc3R1ZHksIGNvcHksIG1lcmdlLCBlbWJlZCwgbW9kaWZ5LCByZWRpc3RyaWJ1dGUsIGFuZCBzZWxsIG1vZGlmaWVkIGFuZCB1bm1vZGlmaWVkIGNvcGllcyBvZiB0aGUgRm9udCBTb2Z0d2FyZSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6DQoNCjEpIE5laXRoZXIgdGhlIEZvbnQgU29mdHdhcmUgbm9yIGFueSBvZiBpdHMgaW5kaXZpZHVhbCBjb21wb25lbnRzLCBpbiBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucywgbWF5IGJlIHNvbGQgYnkgaXRzZWxmLg0KDQoyKSBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucyBvZiB0aGUgRm9udCBTb2Z0d2FyZSBtYXkgYmUgYnVuZGxlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSwgcHJvdmlkZWQgdGhhdCBlYWNoIGNvcHkgY29udGFpbnMgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgbGljZW5zZS4gVGhlc2UgY2FuIGJlIGluY2x1ZGVkIGVpdGhlciBhcyBzdGFuZC1hbG9uZSB0ZXh0IGZpbGVzLCBodW1hbi1yZWFkYWJsZSBoZWFkZXJzIG9yIGluIHRoZSBhcHByb3ByaWF0ZSBtYWNoaW5lLXJlYWRhYmxlIG1ldGFkYXRhIGZpZWxkcyB3aXRoaW4gdGV4dCBvciBiaW5hcnkgZmlsZXMgYXMgbG9uZyBhcyB0aG9zZSBmaWVsZHMgY2FuIGJlIGVhc2lseSB2aWV3ZWQgYnkgdGhlIHVzZXIuDQoNCjMpIE5vIE1vZGlmaWVkIFZlcnNpb24gb2YgdGhlIEZvbnQgU29mdHdhcmUgbWF5IHVzZSB0aGUgUmVzZXJ2ZWQgRm9udCBOYW1lKHMpIHVubGVzcyBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24gaXMgZ3JhbnRlZCBieSB0aGUgY29ycmVzcG9uZGluZyBDb3B5cmlnaHQgSG9sZGVyLiBUaGlzIHJlc3RyaWN0aW9uIG9ubHkgYXBwbGllcyB0byB0aGUgcHJpbWFyeSBmb250IG5hbWUgYXMgcHJlc2VudGVkIHRvIHRoZSB1c2Vycy4NCg0KNCkgVGhlIG5hbWUocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgb3IgdGhlIEF1dGhvcihzKSBvZiB0aGUgRm9udCBTb2Z0d2FyZSBzaGFsbCBub3QgYmUgdXNlZCB0byBwcm9tb3RlLCBlbmRvcnNlIG9yIGFkdmVydGlzZSBhbnkgTW9kaWZpZWQgVmVyc2lvbiwgZXhjZXB0IHRvIGFja25vd2xlZGdlIHRoZSBjb250cmlidXRpb24ocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgYW5kIHRoZSBBdXRob3Iocykgb3Igd2l0aCB0aGVpciBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24uDQoNCjUpIFRoZSBGb250IFNvZnR3YXJlLCBtb2RpZmllZCBvciB1bm1vZGlmaWVkLCBpbiBwYXJ0IG9yIGluIHdob2xlLCBtdXN0IGJlIGRpc3RyaWJ1dGVkIGVudGlyZWx5IHVuZGVyIHRoaXMgbGljZW5zZSwgYW5kIG11c3Qgbm90IGJlIGRpc3RyaWJ1dGVkIHVuZGVyIGFueSBvdGhlciBsaWNlbnNlLiBUaGUgcmVxdWlyZW1lbnQgZm9yIGZvbnRzIHRvIHJlbWFpbiB1bmRlciB0aGlzIGxpY2Vuc2UgZG9lcyBub3QgYXBwbHkgdG8gYW55IGRvY3VtZW50IGNyZWF0ZWQgdXNpbmcgdGhlIEZvbnQgU29mdHdhcmUuDQoNClRFUk1JTkFUSU9ODQpUaGlzIGxpY2Vuc2UgYmVjb21lcyBudWxsIGFuZCB2b2lkIGlmIGFueSBvZiB0aGUgYWJvdmUgY29uZGl0aW9ucyBhcmUgbm90IG1ldC4NCg0KRElTQ0xBSU1FUg0KVEhFIEZPTlQgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIEFOWSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVCBPRiBDT1BZUklHSFQsIFBBVEVOVCwgVFJBREVNQVJLLCBPUiBPVEhFUiBSSUdIVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBJTkNMVURJTkcgQU5ZIEdFTkVSQUwsIFNQRUNJQUwsIElORElSRUNULCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgVEhFIFVTRSBPUiBJTkFCSUxJVFkgVE8gVVNFIFRIRSBGT05UIFNPRlRXQVJFIE9SIEZST00gT1RIRVIgREVBTElOR1MgSU4gVEhFIEZPTlQgU09GVFdBUkUuAEMAbwBwAHkAcgBpAGcAaAB0ACAAKABjACkAIAAyADAAMQA2ACAARgByAC4AIABNAGEAdAB0AGgAZQB3ACAAUwBwAGUAbgBjAGUAcgAsACAATwAuAFMALgBKAC4AUgBlAGcAdQBsAGEAcgBFAHgAcwB1AHIAZwBlACAAQwBoAGEAcgBhAGMAdABlAHIAcwA6AFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwAFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwACAARgBlAGIAcgB1AGEAcgB5ACAAMQA4ACwAIAAyADAAMQA2ACwAIABpAG4AaQB0AGkAYQBsACAAcgBlAGwAZQBhAHMAZQBFAHgAcwB1AHIAZwBlAEMAaABhAHIAYQBjAHQAZQByAHMAVABoAGkAcwAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABpAHMAIABsAGkAYwBlAG4AcwBlAGQAIAB1AG4AZABlAHIAIAB0AGgAZQAgAFMASQBMACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACwAIABWAGUAcgBzAGkAbwBuACAAMQAuADEALgAgAFQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAaQBzACAAYwBvAHAAaQBlAGQAIABiAGUAbABvAHcALAAgAGEAbgBkACAAaQBzACAAYQBsAHMAbwAgAGEAdgBhAGkAbABhAGIAbABlACAAdwBpAHQAaAAgAGEAIABGAEEAUQAgAGEAdAA6ACAAaAB0AHQAcAA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAA0ACgANAAoADQAKAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQANAAoAUwBJAEwAIABPAFAARQBOACAARgBPAE4AVAAgAEwASQBDAEUATgBTAEUAIABWAGUAcgBzAGkAbwBuACAAMQAuADEAIAAtACAAMgA2ACAARgBlAGIAcgB1AGEAcgB5ACAAMgAwADAANwANAAoALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAA0ACgANAAoAUABSAEUAQQBNAEIATABFAA0ACgBUAGgAZQAgAGcAbwBhAGwAcwAgAG8AZgAgAHQAaABlACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACAAKABPAEYATAApACAAYQByAGUAIAB0AG8AIABzAHQAaQBtAHUAbABhAHQAZQAgAHcAbwByAGwAZAB3AGkAZABlACAAZABlAHYAZQBsAG8AcABtAGUAbgB0ACAAbwBmACAAYwBvAGwAbABhAGIAbwByAGEAdABpAHYAZQAgAGYAbwBuAHQAIABwAHIAbwBqAGUAYwB0AHMALAAgAHQAbwAgAHMAdQBwAHAAbwByAHQAIAB0AGgAZQAgAGYAbwBuAHQAIABjAHIAZQBhAHQAaQBvAG4AIABlAGYAZgBvAHIAdABzACAAbwBmACAAYQBjAGEAZABlAG0AaQBjACAAYQBuAGQAIABsAGkAbgBnAHUAaQBzAHQAaQBjACAAYwBvAG0AbQB1AG4AaQB0AGkAZQBzACwAIABhAG4AZAAgAHQAbwAgAHAAcgBvAHYAaQBkAGUAIABhACAAZgByAGUAZQAgAGEAbgBkACAAbwBwAGUAbgAgAGYAcgBhAG0AZQB3AG8AcgBrACAAaQBuACAAdwBoAGkAYwBoACAAZgBvAG4AdABzACAAbQBhAHkAIABiAGUAIABzAGgAYQByAGUAZAAgAGEAbgBkACAAaQBtAHAAcgBvAHYAZQBkACAAaQBuACAAcABhAHIAdABuAGUAcgBzAGgAaQBwACAAdwBpAHQAaAAgAG8AdABoAGUAcgBzAC4ADQAKAA0ACgBUAGgAZQAgAE8ARgBMACAAYQBsAGwAbwB3AHMAIAB0AGgAZQAgAGwAaQBjAGUAbgBzAGUAZAAgAGYAbwBuAHQAcwAgAHQAbwAgAGIAZQAgAHUAcwBlAGQALAAgAHMAdAB1AGQAaQBlAGQALAAgAG0AbwBkAGkAZgBpAGUAZAAgAGEAbgBkACAAcgBlAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGYAcgBlAGUAbAB5ACAAYQBzACAAbABvAG4AZwAgAGEAcwAgAHQAaABlAHkAIABhAHIAZQAgAG4AbwB0ACAAcwBvAGwAZAAgAGIAeQAgAHQAaABlAG0AcwBlAGwAdgBlAHMALgAgAFQAaABlACAAZgBvAG4AdABzACwAIABpAG4AYwBsAHUAZABpAG4AZwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAHcAbwByAGsAcwAsACAAYwBhAG4AIABiAGUAIABiAHUAbgBkAGwAZQBkACwAIABlAG0AYgBlAGQAZABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUAIABwAHIAbwB2AGkAZABlAGQAIAB0AGgAYQB0ACAAYQBuAHkAIAByAGUAcwBlAHIAdgBlAGQAIABuAGEAbQBlAHMAIABhAHIAZQAgAG4AbwB0ACAAdQBzAGUAZAAgAGIAeQAgAGQAZQByAGkAdgBhAHQAaQB2AGUAIAB3AG8AcgBrAHMALgAgAFQAaABlACAAZgBvAG4AdABzACAAYQBuAGQAIABkAGUAcgBpAHYAYQB0AGkAdgBlAHMALAAgAGgAbwB3AGUAdgBlAHIALAAgAGMAYQBuAG4AbwB0ACAAYgBlACAAcgBlAGwAZQBhAHMAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIAB0AHkAcABlACAAbwBmACAAbABpAGMAZQBuAHMAZQAuACAAVABoAGUAIAByAGUAcQB1AGkAcgBlAG0AZQBuAHQAIABmAG8AcgAgAGYAbwBuAHQAcwAgAHQAbwAgAHIAZQBtAGEAaQBuACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUAIABkAG8AZQBzACAAbgBvAHQAIABhAHAAcABsAHkAIAB0AG8AIABhAG4AeQAgAGQAbwBjAHUAbQBlAG4AdAAgAGMAcgBlAGEAdABlAGQAIAB1AHMAaQBuAGcAIAB0AGgAZQAgAGYAbwBuAHQAcwAgAG8AcgAgAHQAaABlAGkAcgAgAGQAZQByAGkAdgBhAHQAaQB2AGUAcwAuAA0ACgANAAoARABFAEYASQBOAEkAVABJAE8ATgBTAA0ACgAiAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAdABoAGUAIABzAGUAdAAgAG8AZgAgAGYAaQBsAGUAcwAgAHIAZQBsAGUAYQBzAGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAHUAbgBkAGUAcgAgAHQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAYQBuAGQAIABjAGwAZQBhAHIAbAB5ACAAbQBhAHIAawBlAGQAIABhAHMAIABzAHUAYwBoAC4AIABUAGgAaQBzACAAbQBhAHkAIABpAG4AYwBsAHUAZABlACAAcwBvAHUAcgBjAGUAIABmAGkAbABlAHMALAAgAGIAdQBpAGwAZAAgAHMAYwByAGkAcAB0AHMAIABhAG4AZAAgAGQAbwBjAHUAbQBlAG4AdABhAHQAaQBvAG4ALgANAAoADQAKACIAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABuAGEAbQBlAHMAIABzAHAAZQBjAGkAZgBpAGUAZAAgAGEAcwAgAHMAdQBjAGgAIABhAGYAdABlAHIAIAB0AGgAZQAgAGMAbwBwAHkAcgBpAGcAaAB0ACAAcwB0AGEAdABlAG0AZQBuAHQAKABzACkALgANAAoADQAKACIATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAiACAAcgBlAGYAZQByAHMAIAB0AG8AIAB0AGgAZQAgAGMAbwBsAGwAZQBjAHQAaQBvAG4AIABvAGYAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAGEAcwAgAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAuAA0ACgANAAoAIgBNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuACIAIAByAGUAZgBlAHIAcwAgAHQAbwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAG0AYQBkAGUAIABiAHkAIABhAGQAZABpAG4AZwAgAHQAbwAsACAAZABlAGwAZQB0AGkAbgBnACwAIABvAHIAIABzAHUAYgBzAHQAaQB0AHUAdABpAG4AZwAgAC0ALQAgAGkAbgAgAHAAYQByAHQAIABvAHIAIABpAG4AIAB3AGgAbwBsAGUAIAAtAC0AIABhAG4AeQAgAG8AZgAgAHQAaABlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAG8AZgAgAHQAaABlACAATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAsACAAYgB5ACAAYwBoAGEAbgBnAGkAbgBnACAAZgBvAHIAbQBhAHQAcwAgAG8AcgAgAGIAeQAgAHAAbwByAHQAaQBuAGcAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIAB0AG8AIABhACAAbgBlAHcAIABlAG4AdgBpAHIAbwBuAG0AZQBuAHQALgANAAoADQAKACIAQQB1AHQAaABvAHIAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABkAGUAcwBpAGcAbgBlAHIALAAgAGUAbgBnAGkAbgBlAGUAcgAsACAAcAByAG8AZwByAGEAbQBtAGUAcgAsACAAdABlAGMAaABuAGkAYwBhAGwAIAB3AHIAaQB0AGUAcgAgAG8AcgAgAG8AdABoAGUAcgAgAHAAZQByAHMAbwBuACAAdwBoAG8AIABjAG8AbgB0AHIAaQBiAHUAdABlAGQAIAB0AG8AIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALgANAAoADQAKAFAARQBSAE0ASQBTAFMASQBPAE4AIAAmACAAQwBPAE4ARABJAFQASQBPAE4AUwANAAoAUABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGgAZQByAGUAYgB5ACAAZwByAGEAbgB0AGUAZAAsACAAZgByAGUAZQAgAG8AZgAgAGMAaABhAHIAZwBlACwAIAB0AG8AIABhAG4AeQAgAHAAZQByAHMAbwBuACAAbwBiAHQAYQBpAG4AaQBuAGcAIABhACAAYwBvAHAAeQAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAsACAAdABvACAAdQBzAGUALAAgAHMAdAB1AGQAeQAsACAAYwBvAHAAeQAsACAAbQBlAHIAZwBlACwAIABlAG0AYgBlAGQALAAgAG0AbwBkAGkAZgB5ACwAIAByAGUAZABpAHMAdAByAGkAYgB1AHQAZQAsACAAYQBuAGQAIABzAGUAbABsACAAbQBvAGQAaQBmAGkAZQBkACAAYQBuAGQAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACAAYwBvAHAAaQBlAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALAAgAHMAdQBiAGoAZQBjAHQAIAB0AG8AIAB0AGgAZQAgAGYAbwBsAGwAbwB3AGkAbgBnACAAYwBvAG4AZABpAHQAaQBvAG4AcwA6AA0ACgANAAoAMQApACAATgBlAGkAdABoAGUAcgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG4AbwByACAAYQBuAHkAIABvAGYAIABpAHQAcwAgAGkAbgBkAGkAdgBpAGQAdQBhAGwAIABjAG8AbQBwAG8AbgBlAG4AdABzACwAIABpAG4AIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMALAAgAG0AYQB5ACAAYgBlACAAcwBvAGwAZAAgAGIAeQAgAGkAdABzAGUAbABmAC4ADQAKAA0ACgAyACkAIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABtAGEAeQAgAGIAZQAgAGIAdQBuAGQAbABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUALAAgAHAAcgBvAHYAaQBkAGUAZAAgAHQAaABhAHQAIABlAGEAYwBoACAAYwBvAHAAeQAgAGMAbwBuAHQAYQBpAG4AcwAgAHQAaABlACAAYQBiAG8AdgBlACAAYwBvAHAAeQByAGkAZwBoAHQAIABuAG8AdABpAGMAZQAgAGEAbgBkACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALgAgAFQAaABlAHMAZQAgAGMAYQBuACAAYgBlACAAaQBuAGMAbAB1AGQAZQBkACAAZQBpAHQAaABlAHIAIABhAHMAIABzAHQAYQBuAGQALQBhAGwAbwBuAGUAIAB0AGUAeAB0ACAAZgBpAGwAZQBzACwAIABoAHUAbQBhAG4ALQByAGUAYQBkAGEAYgBsAGUAIABoAGUAYQBkAGUAcgBzACAAbwByACAAaQBuACAAdABoAGUAIABhAHAAcAByAG8AcAByAGkAYQB0AGUAIABtAGEAYwBoAGkAbgBlAC0AcgBlAGEAZABhAGIAbABlACAAbQBlAHQAYQBkAGEAdABhACAAZgBpAGUAbABkAHMAIAB3AGkAdABoAGkAbgAgAHQAZQB4AHQAIABvAHIAIABiAGkAbgBhAHIAeQAgAGYAaQBsAGUAcwAgAGEAcwAgAGwAbwBuAGcAIABhAHMAIAB0AGgAbwBzAGUAIABmAGkAZQBsAGQAcwAgAGMAYQBuACAAYgBlACAAZQBhAHMAaQBsAHkAIAB2AGkAZQB3AGUAZAAgAGIAeQAgAHQAaABlACAAdQBzAGUAcgAuAA0ACgANAAoAMwApACAATgBvACAATQBvAGQAaQBmAGkAZQBkACAAVgBlAHIAcwBpAG8AbgAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG0AYQB5ACAAdQBzAGUAIAB0AGgAZQAgAFIAZQBzAGUAcgB2AGUAZAAgAEYAbwBuAHQAIABOAGEAbQBlACgAcwApACAAdQBuAGwAZQBzAHMAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGcAcgBhAG4AdABlAGQAIABiAHkAIAB0AGgAZQAgAGMAbwByAHIAZQBzAHAAbwBuAGQAaQBuAGcAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByAC4AIABUAGgAaQBzACAAcgBlAHMAdAByAGkAYwB0AGkAbwBuACAAbwBuAGwAeQAgAGEAcABwAGwAaQBlAHMAIAB0AG8AIAB0AGgAZQAgAHAAcgBpAG0AYQByAHkAIABmAG8AbgB0ACAAbgBhAG0AZQAgAGEAcwAgAHAAcgBlAHMAZQBuAHQAZQBkACAAdABvACAAdABoAGUAIAB1AHMAZQByAHMALgANAAoADQAKADQAKQAgAFQAaABlACAAbgBhAG0AZQAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAG8AcgAgAHQAaABlACAAQQB1AHQAaABvAHIAKABzACkAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABzAGgAYQBsAGwAIABuAG8AdAAgAGIAZQAgAHUAcwBlAGQAIAB0AG8AIABwAHIAbwBtAG8AdABlACwAIABlAG4AZABvAHIAcwBlACAAbwByACAAYQBkAHYAZQByAHQAaQBzAGUAIABhAG4AeQAgAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4ALAAgAGUAeABjAGUAcAB0ACAAdABvACAAYQBjAGsAbgBvAHcAbABlAGQAZwBlACAAdABoAGUAIABjAG8AbgB0AHIAaQBiAHUAdABpAG8AbgAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAGEAbgBkACAAdABoAGUAIABBAHUAdABoAG8AcgAoAHMAKQAgAG8AcgAgAHcAaQB0AGgAIAB0AGgAZQBpAHIAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAuAA0ACgANAAoANQApACAAVABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACwAIABtAG8AZABpAGYAaQBlAGQAIABvAHIAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACwAIABpAG4AIABwAGEAcgB0ACAAbwByACAAaQBuACAAdwBoAG8AbABlACwAIABtAHUAcwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAZQBuAHQAaQByAGUAbAB5ACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALAAgAGEAbgBkACAAbQB1AHMAdAAgAG4AbwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIABsAGkAYwBlAG4AcwBlAC4AIABUAGgAZQAgAHIAZQBxAHUAaQByAGUAbQBlAG4AdAAgAGYAbwByACAAZgBvAG4AdABzACAAdABvACAAcgBlAG0AYQBpAG4AIAB1AG4AZABlAHIAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGQAbwBlAHMAIABuAG8AdAAgAGEAcABwAGwAeQAgAHQAbwAgAGEAbgB5ACAAZABvAGMAdQBtAGUAbgB0ACAAYwByAGUAYQB0AGUAZAAgAHUAcwBpAG4AZwAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAuAA0ACgANAAoAVABFAFIATQBJAE4AQQBUAEkATwBOAA0ACgBUAGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGIAZQBjAG8AbQBlAHMAIABuAHUAbABsACAAYQBuAGQAIAB2AG8AaQBkACAAaQBmACAAYQBuAHkAIABvAGYAIAB0AGgAZQAgAGEAYgBvAHYAZQAgAGMAbwBuAGQAaQB0AGkAbwBuAHMAIABhAHIAZQAgAG4AbwB0ACAAbQBlAHQALgANAAoADQAKAEQASQBTAEMATABBAEkATQBFAFIADQAKAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAgAEkAUwAgAFAAUgBPAFYASQBEAEUARAAgACIAQQBTACAASQBTACIALAAgAFcASQBUAEgATwBVAFQAIABXAEEAUgBSAEEATgBUAFkAIABPAEYAIABBAE4AWQAgAEsASQBOAEQALAAgAEUAWABQAFIARQBTAFMAIABPAFIAIABJAE0AUABMAEkARQBEACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEIAVQBUACAATgBPAFQAIABMAEkATQBJAFQARQBEACAAVABPACAAQQBOAFkAIABXAEEAUgBSAEEATgBUAEkARQBTACAATwBGACAATQBFAFIAQwBIAEEATgBUAEEAQgBJAEwASQBUAFkALAAgAEYASQBUAE4ARQBTAFMAIABGAE8AUgAgAEEAIABQAEEAUgBUAEkAQwBVAEwAQQBSACAAUABVAFIAUABPAFMARQAgAEEATgBEACAATgBPAE4ASQBOAEYAUgBJAE4ARwBFAE0ARQBOAFQAIABPAEYAIABDAE8AUABZAFIASQBHAEgAVAAsACAAUABBAFQARQBOAFQALAAgAFQAUgBBAEQARQBNAEEAUgBLACwAIABPAFIAIABPAFQASABFAFIAIABSAEkARwBIAFQALgAgAEkATgAgAE4ATwAgAEUAVgBFAE4AVAAgAFMASABBAEwATAAgAFQASABFACAAQwBPAFAAWQBSAEkARwBIAFQAIABIAE8ATABEAEUAUgAgAEIARQAgAEwASQBBAEIATABFACAARgBPAFIAIABBAE4AWQAgAEMATABBAEkATQAsACAARABBAE0AQQBHAEUAUwAgAE8AUgAgAE8AVABIAEUAUgAgAEwASQBBAEIASQBMAEkAVABZACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEEATgBZACAARwBFAE4ARQBSAEEATAAsACAAUwBQAEUAQwBJAEEATAAsACAASQBOAEQASQBSAEUAQwBUACwAIABJAE4AQwBJAEQARQBOAFQAQQBMACwAIABPAFIAIABDAE8ATgBTAEUAUQBVAEUATgBUAEkAQQBMACAARABBAE0AQQBHAEUAUwAsACAAVwBIAEUAVABIAEUAUgAgAEkATgAgAEEATgAgAEEAQwBUAEkATwBOACAATwBGACAAQwBPAE4AVABSAEEAQwBUACwAIABUAE8AUgBUACAATwBSACAATwBUAEgARQBSAFcASQBTAEUALAAgAEEAUgBJAFMASQBOAEcAIABGAFIATwBNACwAIABPAFUAVAAgAE8ARgAgAFQASABFACAAVQBTAEUAIABPAFIAIABJAE4AQQBCAEkATABJAFQAWQAgAFQATwAgAFUAUwBFACAAVABIAEUAIABGAE8ATgBUACAAUwBPAEYAVABXAEEAUgBFACAATwBSACAARgBSAE8ATQAgAE8AVABIAEUAUgAgAEQARQBBAEwASQBOAEcAUwAgAEkATgAgAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAuAAAAAgAAAAAAAP8GAGQAAAAAAAAAAAAAAAAAAAAAAAAAAABfAAMABAAFAAYABwAIAAkACgALAAwADQAOAA8AEAARABIAEwAUABUAFgAXABgAGQAaABsAHAAdAB4AHwAgACEAIgAjACQAJQAmACcAKAApACoAKwAsAC0ALgAvADAAMQAyADMANAA1ADYANwA4ADkAOgA7ADwAPQA+AD8AQABBAEIAQwBEAEUARgBHAEgASQBKAEsATABNAE4ATwBQAFEAUgBTAFQAVQBWAFcAWABZAFoAWwBcAF0AXgBfAGAAYQAAAAMACAACABAAAf//AAIAAAABAAAAAAABAAAADgAAAAAAAAAAAAIAAQAAAF4AAQABAAAACgBKAGQAAmN5cmwADmxhdG4AGAAEAAAAAP//AAAAEAACSVBBIAAaVklUIAAiAAD//wACAAEAAAAA//8AAQABAAD//wAAAAJrZXJuAA5tYXJrABQAAAABAAEAAAABAAAAAgAGAA4ABAAEAAEAEAACAAAAAQAsAAEADAAQAAAAIAAiAAIAAAABAAYAIQAyADYAQQBSAFYAAAAGAAEAjgAEAAAABgAWADAASgBkAHIAgAAGAA7/nAAhADYAQQA2ADIADQA2//IAUgAXAAYADv+cACEAWABBAFgAMgChADYAvQBSAE8ABgAO/nAAIf6TAEH+kwAy//kANgAOAFL/YQADAA7/nABSABcAVv/VAAMADv+cAFIANgBWAEwAAwAO/nAAUgAJAFYAGQABAAYAIQAyADYAQQBSAFYAAQAAAAoATgBoAAJjeXJsAA5sYXRuABoABAAAAAD//wABAAAAEAACSVBBIAAaVklUIAAiAAD//wACAAAAAQAA//8AAQAAAAD//wABAAAAAmFhbHQADnNtY3AAFAAAAAEAAAAAAAEAAAABAAQAAwAAAAEACAABABgAAwAMABAAFAABAEEAAQBSAAEAVgABAAMAIQAyADYAAA==\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/url-loader?limit=30000!./assets/fonts/ExsurgeChar.otf\n ** module id = 5\n ** module chunks = 0\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport * as Exsurge from './Exsurge.Core'\r\nimport { Step, Pitch, Rect, Point, Margins } from './Exsurge.Core'\r\nimport { ctxt, QuickSvg, ChantLayoutElement, ChantNotationElement, GlyphCode, GlyphVisualizer, Lyric, Annotation, DropCap } from './Exsurge.Drawing'\r\nimport { Glyphs } from './Exsurge.Glyphs'\r\nimport { Custod, AccidentalType } from './Exsurge.Chant.Signs'\r\nimport { Gabc } from './Exsurge.Gabc'\r\n\r\n\r\nexport var LiquescentType = {\r\n  None: 0,\r\n\r\n  // flags that can be combined, though of course it\r\n  // it doesn't make sense to combine some!\r\n  Large: 1 << 0,\r\n  Small: 1 << 1,\r\n  Ascending: 1 << 2,\r\n  Descending: 1 << 3,\r\n  InitioDebilis: 1 << 4,\r\n\r\n  // handy liquescent types\r\n  LargeAscending: 1 << 0 | 1 << 2,\r\n  LargeDescending: 1 << 0 | 1 << 3,\r\n  SmallAscending: 1 << 1 | 1 << 2,\r\n  SmallDescending: 1 << 1 | 1 << 3\r\n};\r\n\r\nexport var NoteShape = {\r\n  // shapes\r\n  Default:    0,\r\n  Virga:      1,\r\n  Inclinatum: 2,\r\n  Quilisma:   3,\r\n  Stropha:    4,\r\n  Oriscus:    5\r\n};\r\n\r\nexport var NoteShapeModifiers = {\r\n\r\n  // flags which modify the shape\r\n  // not all of them apply to every shape of course\r\n  None:       0,\r\n  Ascending:  1 << 0,\r\n  Descending: 1 << 1,\r\n  Cavum:      1 << 2,\r\n  Stemmed:    1 << 3\r\n};\r\n\r\n/**\r\n * @class\r\n */\r\nexport class Note extends ChantLayoutElement {\r\n\r\n  /**\r\n   * @para {Pitch} pitch\r\n   */\r\n  constructor(pitch) {\r\n    super();\r\n\r\n    if (typeof pitch !== 'undefined')\r\n      this.pitch = pitch;\r\n    else\r\n      this.pitch = null;\r\n\r\n    this.glyphVisualizer = null;\r\n\r\n    // The staffPosition on a note is an integer that indicates the vertical position on the staff.\r\n    // 0 is the center space on the staff (equivalent to gabc 'g'). Positive numbers go up\r\n    // the staff, and negative numbers go down, i.e., 1 is gabc 'h', 2 is gabc 'i', -1 is gabc 'f', etc.\r\n    this.staffPosition = 0;\r\n    this.liquescent = LiquescentType.None;\r\n    this.shape = NoteShape.Default;\r\n    this.shapeModifiers = NoteShapeModifiers.None;\r\n    this.markings = [];\r\n  }\r\n\r\n  setGlyph(ctxt, glyphCode) {\r\n    if (this.glyphVisualizer)\r\n      this.glyphVisualizer.setGlyph(ctxt, glyphCode);\r\n    else\r\n      this.glyphVisualizer = new GlyphVisualizer(ctxt, glyphCode);\r\n\r\n    this.glyphVisualizer.setStaffPosition(ctxt, this.staffPosition);\r\n\r\n    // assign glyphvisualizer metrics to this note\r\n    this.bounds.x = this.glyphVisualizer.bounds.x;\r\n    this.bounds.y = this.glyphVisualizer.bounds.y;\r\n    this.bounds.width = this.glyphVisualizer.bounds.width;\r\n    this.bounds.height = this.glyphVisualizer.bounds.height;\r\n\r\n    this.origin.x = this.glyphVisualizer.origin.x;\r\n    this.origin.y = this.glyphVisualizer.origin.y;\r\n  }\r\n\r\n  // a utility function for modifiers\r\n  shapeModifierMatches(shapeModifier) {\r\n    if (shapeModifier === NoteShapeModifiers.None)\r\n      return this.shapeModifier === NoteShapeModifiers.None;\r\n    else\r\n      return this.shapeModifier & shapeModifier !== 0;\r\n  }\r\n\r\n  draw(ctxt) {\r\n\r\n    this.glyphVisualizer.bounds.x = this.bounds.x;\r\n    this.glyphVisualizer.bounds.y = this.bounds.y;\r\n\r\n    this.glyphVisualizer.draw(ctxt);\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    this.glyphVisualizer.bounds.x = this.bounds.x;\r\n    this.glyphVisualizer.bounds.y = this.bounds.y;\r\n    return this.glyphVisualizer.createDrawable(ctxt);\r\n  }\r\n}\r\n\r\nexport class Clef extends ChantNotationElement {\r\n\r\n  constructor(staffPosition, octave, defaultAccidental = null) {\r\n    super();\r\n\r\n    this.isClef = true;\r\n    this.staffPosition = staffPosition;\r\n    this.octave = octave;\r\n    this.defaultAccidental = defaultAccidental;\r\n    this.activeAccidental = defaultAccidental;\r\n  }\r\n\r\n  resetAccidentals() {\r\n    this.activeAccidental = this.defaultAccidental;\r\n  }\r\n\r\n  pitchToStaffPosition(pitch) {\r\n\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    ctxt.activeClef = this;\r\n\r\n    if (this.defaultAccidental)\r\n      this.defaultAccidental.performLayout(ctxt);\r\n\r\n    super.performLayout(ctxt);\r\n  }\r\n\r\n  finishLayout(ctxt) {\r\n\r\n    // if we have a default accidental, then add a glyph for it now\r\n    if (this.defaultAccidental) {\r\n      var accidentalGlyph = this.defaultAccidental.createGlyphVisualizer(ctxt);\r\n      accidentalGlyph.bounds.x += this.visualizers[0].bounds.right() + ctxt.intraNeumeSpacing;\r\n      this.addVisualizer(accidentalGlyph);\r\n    }\r\n\r\n    super.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\nexport class DoClef extends Clef {\r\n\r\n  constructor(staffPosition, octave, defaultAccidental = null) {\r\n    super(staffPosition, octave, defaultAccidental);\r\n\r\n    this.leadingSpace = 0.0;\r\n  }\r\n\r\n  pitchToStaffPosition(pitch) {\r\n    return (pitch.octave - this.octave) * 7 + this.staffPosition +\r\n            Pitch.stepToStaffOffset(pitch.step) -\r\n            Pitch.stepToStaffOffset(Step.Do);\r\n  }\r\n\r\n  staffPositionToPitch(staffPosition) {\r\n    var offset = staffPosition - this.staffPosition;\r\n    var octaveOffset = Math.floor(offset / 7);\r\n\r\n    var step = Pitch.staffOffsetToStep(offset);\r\n\r\n    if (this.defaultAccidental !== null && step === this.defaultAccidental.step)\r\n      step += this.defaultAccidental.accidentalType;\r\n\r\n    return new Pitch(step, this.octave + octaveOffset);\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var glyph = new GlyphVisualizer(ctxt, GlyphCode.DoClef);\r\n    glyph.setStaffPosition(ctxt, this.staffPosition);\r\n    this.addVisualizer(glyph);\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  clone() {\r\n    return new DoClef(this.staffPosition, this.octave, this.defaultAccidental);\r\n  }\r\n}\r\n\r\n\r\nexport class FaClef extends Clef {\r\n\r\n  constructor(staffPosition, octave, defaultAccidental = null) {\r\n    super(staffPosition, octave, defaultAccidental);\r\n\r\n    this.octave = octave;\r\n\r\n    this.leadingSpace = 0;\r\n  }\r\n\r\n  pitchToStaffPosition(pitch) {\r\n    return (pitch.octave - this.octave) * 7 + this.staffPosition +\r\n            Pitch.stepToStaffOffset(pitch.step) -\r\n            Pitch.stepToStaffOffset(Step.Fa);\r\n  }\r\n\r\n  staffPositionToPitch(staffPosition) {\r\n    var offset = staffPosition - this.staffPosition + 3; // + 3 because it's a fa clef (3 == offset from Do)\r\n    var octaveOffset = Math.floor(offset / 7);\r\n\r\n    var step = Pitch.staffOffsetToStep(offset);\r\n\r\n    if (step === Step.Ti && this.defaultAccidental === AccidentalType.Flat)\r\n      step = Step.Te;\r\n\r\n    return new Pitch(step, this.octave + octaveOffset);\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var glyph = new GlyphVisualizer(ctxt, GlyphCode.FaClef);\r\n    glyph.setStaffPosition(ctxt, this.staffPosition);\r\n    this.addVisualizer(glyph);\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  clone() {\r\n    return new FaClef(this.staffPosition, this.octave, this.defaultAccidental);\r\n  }\r\n}\r\n\r\nexport class ChantLineBreak extends ChantNotationElement {\r\n\r\n  constructor(justify) {\r\n    super();\r\n\r\n    this.justify = justify;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n    // reset the bounds before doing a layout\r\n    this.bounds = new Rect(0, 0, 0, 0);\r\n  }\r\n\r\n  clone() {\r\n    var lb = new ChantLineBreak();\r\n    lb.justify = this.justify;\r\n\r\n    return lb;\r\n  }\r\n}\r\n\r\n\r\n// a chant line represents one staff line on the page. ChantLines are created by the score\r\n// and laid out by the page\r\nexport class ChantLine extends ChantLayoutElement {\r\n\r\n  constructor(score) {\r\n    super();\r\n\r\n    this.score = score;\r\n\r\n    this.scoreNotationStart = 0;\r\n    this.scoreNotationCount = 0;\r\n    this.notations = [];\r\n    this.notationBounds = null; // Rect\r\n\r\n    this.lyricBounds = null; // Rect\r\n\r\n    this.staffLeft = 0;\r\n    this.staffRight = 0;\r\n\r\n    this.custod = null;\r\n\r\n    this.justify = true;\r\n\r\n    this.ledgerLines = [];\r\n\r\n    this.startingClef = null; // necessary for the layout process\r\n\r\n    this.nextLine = null;\r\n    this.previousLine = null; // for layout assistance\r\n\r\n    // fixme: make these configurable values from the score\r\n    this.spaceAfterNotations = 30; // the space between the notation bounds and the first text track\r\n    this.spaceBetweenTextTracks = 20; // spacing between each text track\r\n  }\r\n\r\n  setStartingClef(clef) {\r\n    this.startingClef = clef.clone();\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n    // start off with a rectangle that holds at least the four staff lines\r\n    // we fudge the 3 to 3.1 so that the svg doesn't crop off the upper/lower staff lines...\r\n    this.notationBounds = new Rect(this.staffLeft, -3.1 * ctxt.staffInterval,\r\n      this.staffRight - this.staffLeft, 6.2 * ctxt.staffInterval);\r\n\r\n    // run through all the elements of the line and calculate the bounds of the notations,\r\n    // as well as the bounds of each text track we will use\r\n    var i;\r\n    var notation = null;\r\n\r\n    for (i = 0; i < this.notations.length; i++)\r\n      this.notationBounds.union(this.notations[i].bounds);\r\n\r\n    this.lyricVerticalOffset = this.notationBounds.y + this.notationBounds.height + ctxt.lyricTextSize;\r\n\r\n    // finalize the lyrics placement\r\n    for (i = 0; i < this.notations.length; i++) {\r\n      notation = this.notations[i];\r\n\r\n      if (!notation.hasLyric())\r\n        continue;\r\n\r\n      notation.lyric.bounds.y = this.lyricVerticalOffset;\r\n    }\r\n\r\n    // dropCap and the annotations\r\n    if (this.scoreNotationStart === 0) {\r\n\r\n      if (this.score.dropCap !== null) {\r\n\r\n        // drop caps and annotations are drawn from their center, so aligning them\r\n        // horizontally is as easy as this.staffLeft / 2\r\n        this.score.dropCap.bounds.x = this.staffLeft / 2;\r\n        this.score.dropCap.bounds.y = this.lyricVerticalOffset;\r\n      }\r\n\r\n      if (this.score.annotation !== null) {\r\n        // annotations use dominant-baseline to align text to the top\r\n        this.score.annotation.bounds.x += this.staffLeft / 2;\r\n        this.score.annotation.bounds.y +=  - ctxt.staffInterval * 3;\r\n      }\r\n    }\r\n\r\n    this.notationBounds.height += ctxt.lyricTextSize;\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = this.notationBounds.y;\r\n    this.bounds.width = this.notationBounds.right();\r\n    this.bounds.height = this.notationBounds.height;\r\n\r\n    // the origin of the chant line's coordinate space is at the center line of the left extremity of the staff\r\n    this.origin = new Point(this.staffLeft, -this.notationBounds.y);\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n    var inner = \"\";\r\n\r\n    // add the chant lines\r\n    var i, x1 = this.staffLeft, x2 = this.staffRight;\r\n\r\n    // create the staff lines\r\n    for (i = -3; i <= 3; i += 2) {\r\n\r\n      inner += QuickSvg.createFragment('line', {\r\n        'x1': x1,\r\n        'y1': ctxt.staffInterval * i,\r\n        'x2': x2,\r\n        'y2': ctxt.staffInterval * i,\r\n        'stroke': ctxt.staffLineColor,\r\n        'stroke-width': ctxt.staffLineWeight,\r\n        'class': 'staffLine'\r\n      });\r\n    }\r\n\r\n    // create the ledger lines\r\n    for (i = 0; i < this.ledgerLines.length; i++) {\r\n\r\n      var ledgerLine = this.ledgerLines[i];\r\n      var y = ctxt.calculateHeightFromStaffPosition(ledgerLine.staffPosition);\r\n\r\n      inner += QuickSvg.createFragment('line', {\r\n        'x1': ledgerLine.x1,\r\n        'y1': y,\r\n        'x2': ledgerLine.x2,\r\n        'y2': y,\r\n        'stroke': ctxt.staffLineColor,\r\n        'stroke-width': ctxt.staffLineWeight,\r\n        'class': 'ledgerLine'\r\n      });\r\n    }\r\n\r\n    // dropCap and the annotations\r\n    if (this.scoreNotationStart === 0) {\r\n\r\n      if (this.score.dropCap !== null)\r\n        inner += this.score.dropCap.createDrawable(ctxt);\r\n\r\n      if (this.score.annotation !== null)\r\n          inner += this.score.annotation.createDrawable(ctxt);\r\n    }\r\n\r\n    // add all of the notations\r\n    for (i = 0; i < this.notations.length; i++)\r\n      inner += this.notations[i].createDrawable(ctxt);\r\n\r\n    return QuickSvg.createFragment('g', {\r\n      'class': 'chantLine',\r\n      'transform': 'translate(' + this.bounds.x + ',' + this.bounds.y + ')'\r\n    }, inner);\r\n  }\r\n\r\n\r\n  buildFromChantNotationIndex(ctxt, newElementStart, width) {\r\n\r\n    // todo: reset / clear the children we have in case they have data\r\n    this.scoreNotationStart = newElementStart;\r\n    this.scoreNotationCount = 0;\r\n    this.notations = [];\r\n\r\n    this.staffLeft = 0;\r\n\r\n    if (width > 0)\r\n      this.staffRight = this.staffLeft + width;\r\n    else\r\n      this.staffRight = 99999999; // no limit to staff size\r\n\r\n    // If this is the first chant line, then we have to make room for a\r\n    // drop cap and/or annotation, if present\r\n    if (this.scoreNotationStart === 0) {\r\n\r\n      var padding = 0;\r\n\r\n      if (this.score.dropCap !== null)\r\n        padding = this.score.dropCap.bounds.width + this.score.dropCap.padding * 2;\r\n\r\n      if (this.score.annotation !== null)\r\n        padding = Math.max(padding, this.score.annotation.bounds.width + this.score.annotation.padding * 4);\r\n\r\n      this.staffLeft += padding;\r\n    }\r\n\r\n    // set up the clef...\r\n    // Also, add the clef as a child (which will also set the clef in the context)\r\n    this.setStartingClef(ctxt.activeClef);\r\n    this.startingClef.performLayout(ctxt);\r\n    this.startingClef.bounds.x = this.staffLeft;\r\n    this.notations.push(this.startingClef);\r\n\r\n    var current = this.startingClef, previous = null, previousWithLyric = null;\r\n\r\n    // todo: estimate how much space we have available to us\r\n    var rightBoundary = this.staffRight - Glyphs.CustodLong.bounds.width - ctxt.intraNeumeSpacing * 4; // possible custod on the line\r\n\r\n    // todo: iterate through the notations, fittng what we can on this line\r\n    var i, scoreNotations = this.score.notations;\r\n\r\n    for (i = newElementStart; i < scoreNotations.length; i++) {\r\n\r\n      if (current.hasLyric())\r\n        previousWithLyric = current;\r\n\r\n      previous = current;\r\n      current = scoreNotations[i];\r\n\r\n      // try to fit the current element on this line.\r\n      // if it doesn't fit, we finish up here.\r\n      var fitsOnLine = this.positionNotationElement(ctxt, previousWithLyric, previous, current, rightBoundary);\r\n      if (fitsOnLine === false) {\r\n\r\n        // check if the previous elements want to be kept with this one\r\n        for (var k = i - 1; k > this.scoreNotationStart; k--) {\r\n          var cne = this.score.notations[k];\r\n\r\n          if (cne.keepWithNext === true) {\r\n            this.notations.pop(); // remove it from our notations\r\n            this.scoreNotationCount--;\r\n          } else\r\n            break;\r\n        }\r\n\r\n        // we are at the end of the line!\r\n        break;\r\n      }\r\n\r\n      current.chantLine = this;\r\n      this.notations.push(current);\r\n      this.scoreNotationCount++;\r\n\r\n      // line breaks are a special case indicating to stop processing here\r\n      if (current.constructor.name === 'ChantLineBreak' && width > 0) {\r\n        this.justify = current.justify;\r\n        break;\r\n      }\r\n    }\r\n\r\n    var last, extraSpace = 0;\r\n\r\n    if (this.notations.length > 0) {\r\n      last = this.notations[this.notations.length - 1];\r\n\r\n      if (last.hasLyric() && last.getLyricRight() > (last.bounds.right() + last.trailingSpace))\r\n        extraSpace = this.staffRight - last.getLyricRight();\r\n      else\r\n        extraSpace = this.staffRight - (last.bounds.right() + last.trailingSpace);\r\n    }\r\n\r\n    // create the custod at the end of the line (if we need it!)\r\n    // if we find an element following this one that is a neume, we create a custod for it\r\n    for (i = this.scoreNotationStart + this.scoreNotationCount; i < this.score.notations.length; i++) {\r\n      var notation = this.score.notations[i];\r\n\r\n      if ('notes' in notation && notation.notes.length > 0) {\r\n\r\n        var custod = new Custod();\r\n        custod.referringNeume = notation;\r\n\r\n        custod.performLayout(ctxt);\r\n\r\n        if (this.notations.length > 0) {\r\n          last = this.notations[this.notations.length - 1];\r\n          custod.bounds.x = last.bounds.x + last.bounds.width;\r\n        }\r\n\r\n        this.custod = custod;\r\n        this.notations.push(custod);\r\n\r\n        extraSpace -= custod.bounds.width + custod.leadingSpace;\r\n\r\n        // nothing more to see here...\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (width <= 0 && this.notations.length > 0) {\r\n      // set the staff width based on the notations.\r\n      this.staffRight = this.notations[this.notations.length - 1].bounds.right();\r\n    }\r\n\r\n    // Justify the line if we are not the last one\r\n    if (this.justify === true && width > 0 &&\r\n        this.scoreNotationStart + this.scoreNotationCount < this.score.notations.length &&\r\n        extraSpace > 0)\r\n      this.justifyElements(extraSpace);\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  justifyElements(extraSpace) {\r\n\r\n    var indices = [];\r\n\r\n    var i, prev = null, curr = null, prevWithLyrics = null;\r\n\r\n    // if we have a custod, place it at the end of the line\r\n    if (this.custod !== null) \r\n      this.custod.bounds.x = this.staffRight - this.custod.bounds.width - this.custod.leadingSpace;\r\n\r\n    // first pass: determine the neumes we can space apart\r\n    // start at 1 to skip the clef\r\n    for (i = 1; i < this.notations.length - 1; i++) {\r\n\r\n      if (curr !== null && curr.hasLyric())\r\n        prevWithLyrics = curr;\r\n\r\n      prev = curr;\r\n      curr = this.notations[i];\r\n\r\n      if (prev !== null && prev.keepWithNext === true)\r\n        continue;\r\n\r\n      if (prevWithLyrics !== null && prevWithLyrics.lyric.allowsConnector() && !prevWithLyrics.lyric.needsConnector)\r\n        continue;\r\n\r\n      if (curr.constructor.name === 'ChantLineBreak')\r\n        continue;\r\n\r\n      // otherwise, we can add space before this element\r\n      indices.push(i);\r\n    }\r\n\r\n    if (indices.length === 0)\r\n      return;\r\n\r\n    var offset = 0;\r\n    var increment = extraSpace / indices.length;\r\n    var lastIndex = (this.notations[this.notations.length - 1].constructor.name === 'Custod') ? this.notations.length - 1 : this.notations.length;\r\n    for (i = 1; i < lastIndex; i++) {\r\n\r\n      curr = this.notations[i];\r\n\r\n      if (indices.indexOf(i) >= 0) {\r\n        curr.bounds.x += offset + increment;\r\n        offset += increment;\r\n      } else\r\n        curr.bounds.x += offset;\r\n    }\r\n\r\n    offset = offset;\r\n  }\r\n\r\n  finishLayout(ctxt) {\r\n\r\n    this.ledgerLines = []; // clear any existing ledger lines\r\n\r\n    var epismata = []; // keep track of epismata in case we can connect some\r\n\r\n    // make a final pass over all of the notes to add any necessary\r\n    // ledger lines and to smooth out epismata\r\n    for (var i = 0; i < this.notations.length; i++) {\r\n\r\n      // if it's not a neume, then skip over it, right?\r\n      if (typeof this.notations[i].notes === 'undefined')\r\n        continue;\r\n\r\n      var neume = this.notations[i];\r\n\r\n      for (var j = 0; j < neume.notes.length; j++) {\r\n        var note = neume.notes[j];\r\n\r\n        // do we need a ledger line for this note?\r\n        var staffPosition = note.staffPosition;\r\n\r\n        if (staffPosition >= 5 || staffPosition <= -5) {\r\n\r\n          var x1 = neume.bounds.x + note.bounds.x - ctxt.staffInterval;\r\n          var x2 = neume.bounds.x + note.bounds.x + note.bounds.width + ctxt.staffInterval;\r\n\r\n          // round the staffPosition to the nearest line\r\n          if (staffPosition > 0)\r\n            staffPosition = staffPosition - (staffPosition - 1) % 2;\r\n          else\r\n            staffPosition = staffPosition - (staffPosition + 1) % 2;\r\n\r\n          // if we have a ledger line close by, then average out the distance between the two\r\n          var minLedgerSeperation = ctxt.staffInterval * 5;\r\n\r\n          if (this.ledgerLines.length > 0 &&\r\n              this.ledgerLines[this.ledgerLines.length - 1].x2 + minLedgerSeperation >= x1) {\r\n\r\n            // average out the distance\r\n            var half = (x1 - this.ledgerLines[this.ledgerLines.length - 1].x2) / 2;\r\n            this.ledgerLines[this.ledgerLines.length - 1].x2 += half;\r\n            x1 -= half;\r\n          }\r\n\r\n          // finally, add the ledger line\r\n          this.ledgerLines.push({\r\n            x1: x1,\r\n            x2: x2,\r\n            staffPosition: staffPosition\r\n          });\r\n        }\r\n\r\n        var noteHasEpisema = false;\r\n\r\n        // blend epismata as we're able\r\n        for (var k = 0; k < note.markings.length; k++) {\r\n\r\n          if (note.markings[k].constructor.name !== \"HorizontalEpisema\")\r\n            continue;\r\n\r\n          noteHasEpisema = true;\r\n          var episema = note.markings[k];\r\n\r\n          // we try to blend the episema if we're able.\r\n          if (epismata.length === 0 ||\r\n              epismata[0].episema.positionHint !== episema.positionHint ||\r\n              epismata[0].episema.terminating === true) {\r\n\r\n            // start a new set of epismata to potentially blend\r\n            epismata = [];\r\n            epismata.push({\r\n              episema: episema,\r\n              neume: neume\r\n            });\r\n          } else {\r\n            // blend all previous with this one\r\n            var newY;\r\n\r\n            if (episema.positionHint === Exsurge.MarkingPositionHint.Below)\r\n              newY = Math.max(episema.bounds.y, epismata[0].episema.bounds.y);\r\n            else\r\n              newY = Math.min(episema.bounds.y, epismata[0].episema.bounds.y);\r\n\r\n            if (episema.bounds.y !== newY)\r\n              episema.updateY(newY);\r\n            else {\r\n              for (var l = 0; l < epismata.length; l++)\r\n                epismata[l].episema.updateY(newY);\r\n            }\r\n\r\n            // extend the last episema to meet the new one\r\n            var newWidth = (neume.bounds.x + episema.bounds.x) - (epismata[epismata.length - 1].neume.bounds.x + epismata[epismata.length - 1].episema.bounds.x);\r\n            epismata[epismata.length - 1].episema.updateWidth(newWidth);\r\n\r\n            epismata.push({\r\n              episema: episema,\r\n              neume: neume\r\n            });\r\n          }\r\n        }\r\n\r\n        // if the note doesn't have any episema, then make sure and stop blending epismata\r\n        if (noteHasEpisema === false)\r\n          epismata = [];\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  // this is where the real core of positioning neumes takes place\r\n  // returns true if positioning was able to fit the neume before rightBoundary.\r\n  // returns false if cannot fit before given right margin.\r\n  // fixme: if this returns false, shouldn't we set the connectors on prev to be activated?!\r\n  positionNotationElement(ctxt, prevWithLyric, prev, curr, rightBoundary) {\r\n\r\n    // To begin we just place the current notation right after the previous,\r\n    // irrespective of lyrics.\r\n    curr.bounds.x = prev.bounds.right() + prev.trailingSpace;\r\n\r\n    if (prevWithLyric === null) {\r\n\r\n      var maxRight = curr.bounds.right() + curr.trailingSpace;\r\n\r\n      // if the lyric left is negative, then offset the neume appropriately\r\n      if (curr.hasLyric()) {\r\n        curr.lyric.setNeedsConnector(false); // we hope for the best!\r\n\r\n        if (curr.getLyricLeft() < 0)\r\n          curr.bounds.x += -curr.getLyricLeft();\r\n\r\n        maxRight = Math.max(maxRight, curr.getLyricRight());\r\n      }\r\n\r\n      if (maxRight > rightBoundary)\r\n        return false;\r\n      else\r\n        return true;\r\n    }\r\n\r\n    if (curr.hasLyric() === false) {\r\n\r\n      if (prevWithLyric.lyric.allowsConnector())\r\n        prevWithLyric.lyric.setNeedsConnector(true);\r\n\r\n      if (curr.bounds.right() + curr.trailingSpace < rightBoundary)\r\n        return true;\r\n      else {\r\n        //curr.bounds.x = this.startingClef.bounds.right();\r\n        return false;\r\n      }\r\n    }\r\n\r\n    curr.lyric.setNeedsConnector(false); // we hope for the best!\r\n\r\n    var currLyricLeft = curr.getLyricLeft();\r\n    var prevLyricRight = prevWithLyric.getLyricRight();\r\n\r\n    if (prevWithLyric.lyric.allowsConnector() === false) {\r\n\r\n      // No connector needed, but include space between words if necessary!\r\n      if (prevLyricRight + ctxt.minLyricWordSpacing > currLyricLeft) {\r\n        // push the current element over a bit.\r\n        curr.bounds.x += prevLyricRight + ctxt.minLyricWordSpacing - currLyricLeft;\r\n      }\r\n\r\n    } else {\r\n\r\n      // we may need a connector yet...\r\n\r\n      if (prevLyricRight > currLyricLeft) {\r\n        // in this case, the lyric elements actually overlap.\r\n        // so nope, no connector needed. instead, we just place the lyrics together\r\n        // fixme: for better text layout, we could actually use the kerning values\r\n        // between the prev and curr lyric elements!\r\n        curr.bounds.x += prevLyricRight - currLyricLeft;\r\n\r\n      } else {\r\n\r\n        // bummer, looks like we couldn't merge the syllables together. Better add a connector...\r\n        prevWithLyric.lyric.setNeedsConnector(true);\r\n        prevLyricRight = prevWithLyric.getLyricRight();\r\n\r\n        if (prevLyricRight > currLyricLeft)\r\n          curr.bounds.x += prevLyricRight - currLyricLeft;\r\n      }\r\n    }\r\n\r\n    if (curr.bounds.right() + curr.trailingSpace < rightBoundary)\r\n      return true;\r\n\r\n    // if we made it this far, then the element won't fit on this line.\r\n    // set the position of the current element to the beginning of a chant line,\r\n    // and mark the previous lyric as connecting if needed.\r\n    // curr.bounds.x = this.startingClef.bounds.right();\r\n\r\n    if (prevWithLyric.lyric !== null && prevWithLyric.lyric.allowsConnector())\r\n      prevWithLyric.lyric.setNeedsConnector(true);\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\n/*\r\n * Score, document\r\n */\r\nexport class ChantScore {\r\n\r\n  constructor() {\r\n\r\n    this.startingClef = null; // Clef\r\n\r\n    this.notations = [];\r\n    this.lines = [];\r\n    this.notes = [];\r\n\r\n    this.dropCap = null;\r\n    this.annotation = null;\r\n\r\n    this.compiled = false;\r\n\r\n    this.autoColoring = true;\r\n\r\n    // valid after chant lines are created...\r\n    this.bounds = new Rect();\r\n  }\r\n\r\n  performLayout(ctxt, finishedCallback) {\r\n\r\n    // first order of business: let the clef perform layout\r\n    this.startingClef.performLayout(ctxt);\r\n\r\n    if (this.dropCap)\r\n      this.dropCap.recalculateMetrics(ctxt);\r\n\r\n    if (this.annotation)\r\n      this.annotation.recalculateMetrics(ctxt);\r\n\r\n    if (this.compiled) {\r\n      setTimeout(() => {\r\n        if (finishedCallback)\r\n          finishedCallback();\r\n      }, 0);\r\n    } else {\r\n      // boot the compilation process\r\n      setTimeout(() => {\r\n        this.compileElement(ctxt, 0, finishedCallback);\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  compileElement(ctxt, index, finishedCallback) {\r\n\r\n    if (index >= this.notations.length) {\r\n\r\n      if (!this.compiled) {\r\n        this.compiled = true;\r\n        setTimeout(() => {\r\n          if (finishedCallback)\r\n            finishedCallback();\r\n        }, 0);\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    var timeout = new Date().getTime() + 50; // process for fifty milliseconds\r\n    do {\r\n      var notation = this.notations[index++];\r\n      notation.performLayout(ctxt);\r\n    } while (index < this.notations.length && new Date().getTime() < timeout);\r\n\r\n    // schedule the next block of processing\r\n    setTimeout(() => {\r\n      this.compileElement(ctxt, index, finishedCallback);\r\n    }, 0);\r\n  }\r\n\r\n  layoutChantLines(ctxt, width, finishedCallback) {\r\n\r\n    this.lines = [];\r\n\r\n    var y = 0;\r\n    var currIndex = 0;\r\n\r\n    ctxt.activeClef = this.startingClef;\r\n\r\n    do {\r\n\r\n      var line = new ChantLine(this);\r\n\r\n      line.buildFromChantNotationIndex(ctxt, currIndex, width);\r\n      currIndex += line.scoreNotationCount;\r\n      line.performLayout(ctxt);\r\n      this.lines.push(line);\r\n\r\n      line.bounds.y = -line.bounds.y + y;\r\n      y += line.bounds.height + ctxt.staffInterval * 3;\r\n\r\n    } while (currIndex < this.notations.length);\r\n\r\n    var lastLine = this.lines[this.lines.length - 1];\r\n\r\n    this.bounds.x = 0;\r\n    this.bounds.y = 0;\r\n    this.bounds.width = lastLine.bounds.width;\r\n    this.bounds.height = y;\r\n\r\n    if (finishedCallback)\r\n      finishedCallback(this);\r\n  }\r\n\r\n  createDrawable(ctxt) {\r\n\r\n    var i, drawable = \"\";\r\n\r\n    // create defs section\r\n    for (var def in ctxt.defs)\r\n      if (ctxt.defs.hasOwnProperty(def))\r\n        drawable += ctxt.defs[def];\r\n\r\n    drawable = QuickSvg.createFragment('defs', {}, drawable);\r\n\r\n    for (i = 0; i < this.lines.length; i++)\r\n      drawable += this.lines[i].createDrawable(ctxt);\r\n\r\n    drawable = QuickSvg.createFragment('g', {}, drawable);\r\n\r\n    drawable = QuickSvg.createFragment('svg', {\r\n      'xmlns': 'http://www.w3.org/2000/svg',\r\n      'version': '1.1',\r\n      'xmlns:xlink': 'http://www.w3.org/1999/xlink',\r\n      'class': 'ChantScore',\r\n      'width': this.bounds.width,\r\n      'height': this.bounds.height\r\n    }, drawable);\r\n\r\n    return drawable;\r\n  }\r\n\r\n  unserializeFromJson(data) {\r\n    this.autoColoring = data['auto-coloring'];\r\n\r\n    if (data.annotation !== null && data.annotation !== \"\") {\r\n      // create the annotation\r\n      this.annotation = new Annotation(ctxt, data.annotation);\r\n    } else\r\n      this.annotation = null;\r\n\r\n    var createDropCap = data['drop-cap'] === 'auto' ? true : false;\r\n\r\n    Gabc.parseChantNotations(data.notations, this, createDropCap);\r\n  }\r\n\r\n  serializeToJson() {\r\n    var data = {};\r\n\r\n    data['type'] = \"score\";\r\n    data['auto-coloring'] = true;\r\n\r\n    if (this.annotation !== null)\r\n      data.annotation = this.annotation.unsanitizedText;\r\n    else\r\n      data.annotation = \"\";\r\n\r\n    \r\n\r\n    return data;\r\n  }\r\n}\r\n\r\nexport class ChantDocument {\r\n  constructor() {\r\n\r\n    var defaults = {\r\n      layout: {\r\n        units: \"mm\",\r\n        'default-font': {\r\n          'font-family': \"Crimson\",\r\n          'font-size': 14\r\n        },\r\n        page: {\r\n          width: 8.5,\r\n          height: 11,\r\n          'margin-left': 0,\r\n          'margin-top': 0,\r\n          'margin-right': 0,\r\n          'margin-bottom': 0\r\n        }\r\n      },\r\n      scores: []\r\n    };\r\n\r\n    // default layout\r\n    this.copyLayout(this, defaults);\r\n\r\n    this.scores = defaults.scores;\r\n  }\r\n\r\n  copyLayout(to, from) {\r\n\r\n    to.layout = {\r\n      units: from.layout.units,\r\n      'default-font': {\r\n        'font-family': from.layout['default-font']['font-family'],\r\n        'font-size': from.layout['default-font']['font-size']\r\n      },\r\n      page: {\r\n        width: from.layout.page.width,\r\n        height: from.layout.page.height,\r\n        'margin-left': from.layout.page['margin-left'],\r\n        'margin-top': from.layout.page['margin-top'],\r\n        'margin-right': from.layout.page['margin-right'],\r\n        'margin-bottom': from.layout.page['margin-bottom']\r\n      }\r\n    };\r\n  }\r\n\r\n  unserializeFromJson(data) {\r\n\r\n    this.copyLayout(this, data);\r\n\r\n    this.scores = [];\r\n\r\n    // read in the scores\r\n    for (var i = 0; i < data.scores.length; i++) {\r\n      var score = new ChantScore();\r\n\r\n      score.unserializeFromJson(data.scores[i]);\r\n      this.scores.push(score);\r\n    }\r\n  }\r\n\r\n  serializeToJson() {\r\n    var data = {};\r\n\r\n    this.copyLayout(data, this);\r\n\r\n    data.scores = [];\r\n\r\n    // save scores...\r\n    for (var i = 0; i < this.scores.length; i++)\r\n      data.scores.push(this.scores[i].serializeToJson());\r\n\r\n    return data;\r\n  }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Chant.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport * as Exsurge from 'Exsurge.Core'\r\nimport { ctxt, GlyphCode, GlyphVisualizer, DividerLineVisualizer, ChantNotationElement } from 'Exsurge.Drawing'\r\n\r\n/*\r\n *\r\n */\r\nexport class Custod extends ChantNotationElement {\r\n\r\n  constructor() {\r\n    super();\r\n    this.referringNeume = null;\r\n    this.note = null;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var staffPosition = 0; // a default value just to make sure we don't fail rebuilding\r\n    var glyphCode;\r\n\r\n    if (this.referringNeume !== null) {\r\n      if (this.referringNeume.notes.length > 0)\r\n        staffPosition = this.referringNeume.notes[0].staffPosition;\r\n    } else if (note !== null)\r\n      staffPosition = this.note.staffPosition;\r\n\r\n    glyphCode = Custod.getGlyphCode(staffPosition);\r\n\r\n    var glyph = new GlyphVisualizer(ctxt, glyphCode);\r\n    glyph.setStaffPosition(ctxt, staffPosition);\r\n    this.addVisualizer(glyph);\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  static getGlyphCode(staffPosition) {\r\n\r\n    if (staffPosition <= 2) {\r\n\r\n      // ascending custodes\r\n      if (Math.abs(staffPosition) % 2 === 1)\r\n        return GlyphCode.CustodLong;\r\n      else\r\n        return GlyphCode.CustodShort;\r\n    } else {\r\n\r\n      // descending custodes\r\n      if (Math.abs(staffPosition) % 2 === 1)\r\n        return GlyphCode.CustodDescLong;\r\n      else\r\n        return GlyphCode.CustodDescShort;\r\n    }\r\n  }\r\n}\r\n\r\n/*\r\n * DividingLine\r\n */\r\nexport class DividingLine extends ChantNotationElement {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.resetsAccidentals = true;\r\n  }\r\n}\r\n\r\n/*\r\n * QuarterBar\r\n */\r\nexport class QuarterBar extends DividingLine {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n    this.addVisualizer(new DividerLineVisualizer(ctxt, 2, 4));\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * HalfBar\r\n */\r\nexport class HalfBar extends DividingLine {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    this.addVisualizer(new DividerLineVisualizer(ctxt, -2, 2));\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * FullBar\r\n */\r\nexport class FullBar extends DividingLine {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n    \r\n    this.addVisualizer(new DividerLineVisualizer(ctxt, -3, 3));\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * DoubleBar\r\n */\r\nexport class DoubleBar extends DividingLine {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line0 = new DividerLineVisualizer(ctxt, -3, 3);\r\n    line0.bounds.x = 0;\r\n    this.addVisualizer(line0);\r\n\r\n    var line1 = new DividerLineVisualizer(ctxt, -3, 3);\r\n    line1.bounds.x = ctxt.intraNeumeSpacing * 2;\r\n    this.addVisualizer(line1);\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\nexport const AccidentalType = {\r\n  Flat: -1,\r\n  Natural: 0,\r\n  Sharp: 1\r\n};\r\n\r\n/*\r\n * Accidental\r\n */\r\nexport class Accidental extends ChantNotationElement {\r\n\r\n  constructor(staffPosition, accidentalType) {\r\n    super();\r\n    this.isAccidental = true;\r\n    this.keepWithNext = true; // accidentals should always stay connected...\r\n    \r\n    this.staffPosition = staffPosition;\r\n    this.accidentalType = accidentalType;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    this.addVisualizer(this.createGlyphVisualizer(ctxt));\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  // creation of the glyph visualizer is refactored out or performLayout\r\n  // so that clefs can use the same logic for their accidental glyph\r\n  createGlyphVisualizer(ctxt) {\r\n\r\n    var glyphCode = GlyphCode.Flat;\r\n\r\n    switch (this.accidentalType) {\r\n      case AccidentalType.Natural:\r\n        glyphCode = GlyphCode.Natural;\r\n        break;\r\n      case AccidentalType.Sharp:\r\n        glyphCode = GlyphCode.Sharp;\r\n        break;\r\n      default:\r\n        glyphCode = GlyphCode.Flat;\r\n        break;\r\n    }\r\n\r\n    var glyph = new GlyphVisualizer(ctxt, glyphCode);\r\n    glyph.setStaffPosition(ctxt, this.staffPosition);\r\n\r\n    return glyph;\r\n  }\r\n\r\n  adjustStep(step) {\r\n    switch (this.accidentalType) {\r\n      case AccidentalType.Flat:\r\n        if (step === Step.Ti) return Step.Te;\r\n        if (step === Step.Mi) return Step.Me;\r\n        break;\r\n      case AccidentalType.Sharp:\r\n        if (step === Step.Do) return Step.Du;\r\n        if (step === Step.Fa) return Step.Fu;\r\n        break;\r\n      case AccidentalType.Natural:\r\n        if (step === Step.Te) return Step.Ti;\r\n        if (step === Step.Me) return Step.Mi;\r\n        if (step === Step.Du) return Step.Do;\r\n        if (step === Step.Fu) return Step.Fa;\r\n        break;\r\n    }\r\n\r\n    // no adjustment needed\r\n    return step;\r\n  }\r\n\r\n  applyToPitch(pitch) {\r\n\r\n    // fixme: this is broken since we changed to staff positions\r\n\r\n    // no adjusment needed\r\n    if (this.octave !== pitch.octave)\r\n      return;\r\n\r\n    pitch.step = this.adjustStep(pitch.step);\r\n  }\r\n}\r\n\r\n/*\r\n * Virgula\r\n */\r\nexport class Virgula extends ChantNotationElement {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    // fixme: the staff position of the virgula is customizable, so that it\r\n    // can be placed on different lines (top or bottom) depending on the\r\n    // notation tradition of what is being notated (e.g., Benedictine has it\r\n    //  on top line, Norbertine at the bottom)\r\n    this.staffPosition = 3;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var glyph = new GlyphVisualizer(ctxt, GlyphCode.Virgula);\r\n    glyph.setStaffPosition(ctxt, this.staffPosition);\r\n\r\n    this.addVisualizer(glyph);\r\n\r\n    this.origin.x = this.bounds.width / 2;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Chant.Signs.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport { Units, Pitch, Point, Rect, Margins, Size, Step, MarkingPositionHint } from 'Exsurge.Core'\r\nimport { LyricType, Lyric, DropCap } from 'Exsurge.Drawing'\r\nimport { Note, LiquescentType, NoteShape, NoteShapeModifiers, ChantScore, ChantDocument, Clef, DoClef, FaClef, ChantLineBreak } from 'Exsurge.Chant'\r\nimport * as Markings from 'Exsurge.Chant.Markings'\r\nimport * as Signs from 'Exsurge.Chant.Signs'\r\nimport * as Neumes from 'Exsurge.Chant.Neumes'\r\nimport { ctxt } from 'Exsurge.Drawing'\r\n\r\n\r\n\r\n// reusable reg exps\r\nvar __syllablesRegex = /(?=.)((?:[^(])*)(?:\\(?([^)]*)\\)?)?/g;\r\nvar __notationsRegex = /z0|z|Z|::|:|;|,|`|c1|c2|c3|c4|f3|f4|cb3|cb4|\\/\\/|\\/|\\!|-?[a-mA-M][oOwWvVrRsxy#~\\+><_\\.'012345]*/g;\r\n\r\nexport var Gabc = {\r\n\r\n  loadChantScore: function (ctxt, gabcNotations, createDropCap) {\r\n\r\n    var score = new ChantScore();\r\n\r\n    // fixme: no dropcap until the text engine is working again\r\n    this.parseChantNotations(ctxt, gabcNotations, score, createDropCap);\r\n\r\n    return score;\r\n  },\r\n\r\n  parseChantNotations: function (ctxt, gabcNotations, score, createDropCap) {\r\n\r\n    score.notations = [];\r\n\r\n    var passByRef = {\r\n      activeClef: null\r\n    };\r\n\r\n    // split the notations on whitespace boundaries\r\n    var words = gabcNotations.match(/\\S+/g);\r\n\r\n    for (var i = 0; i < words.length; i++) {\r\n      var word = words[i];\r\n\r\n      var currSyllable = 0;\r\n\r\n      if (word === '')\r\n        continue;\r\n\r\n      word = word.trim()\r\n\r\n      var matches = [];\r\n      \r\n      while ((match = __syllablesRegex.exec(word)))\r\n        matches.push(match);\r\n\r\n      for (var j = 0; j < matches.length; j++) {\r\n        var match = matches[j];\r\n\r\n        var lyricText = match[1].trim();\r\n        var notationData = match[2];\r\n\r\n        var items = this.createNotations(ctxt, score, notationData, passByRef);\r\n\r\n        if (items.length === 0)\r\n          continue;\r\n\r\n        // create lyric if we have it...\r\n        if (lyricText !== \"\") {\r\n\r\n          var lyricType;\r\n          if (currSyllable === 0 && matches.length === 1)\r\n            lyricType = LyricType.SingleSyllable;\r\n          else if (currSyllable === 0 && matches.length > 1)\r\n            lyricType = LyricType.BeginningSyllable;\r\n          else if (currSyllable === matches.length - 1)\r\n            lyricType = LyricType.EndingSyllable;\r\n          else\r\n            lyricType = LyricType.MiddleSyllable;\r\n\r\n          // if we are to create a dropCap and we haven't done so yet, do it now\r\n          if (createDropCap && score.dropCap === null) {\r\n            score.dropCap = new DropCap(ctxt, lyricText.substring(0, 1));\r\n\r\n            // if the dropcap is a single character syllable (vowel) that is the\r\n            // beginning of the word, then we use a hyphen in place of the lyric text\r\n            // and treat it as a single syllable.\r\n            if (lyricText.length === 1 && lyricType === LyricType.BeginningSyllable) {\r\n              lyricText = ctxt.syllableConnector;\r\n              lyricType = LyricType.SingleSyllable;\r\n            } else\r\n              lyricText = lyricText.substring(1);\r\n          }\r\n\r\n          // add the lyrics to the first notation that makes sense...\r\n          var notationWithLyrics = null;\r\n          for (var k = 0; k < items.length; k++) {\r\n            var cne = items[k];\r\n            if (cne.constructor.name === \"Accidental\")\r\n              continue;\r\n\r\n            notationWithLyrics = cne;\r\n            break;\r\n          }\r\n\r\n          // if it's not a neume then make the lyric a directive\r\n          if (typeof notationWithLyrics.notes === 'undefined')\r\n            lyricType = LyricType.Directive;\r\n\r\n          var lyric = this.makeLyric(ctxt, lyricText, lyricType);\r\n\r\n          // also, new words reset the accidentals, per the Solesmes style (see LU xviij)\r\n          if (lyric.lyricType === LyricType.BeginningSyllable ||\r\n            lyric.lyricType === LyricType.SingleSyllable)\r\n            passByRef.activeClef.resetAccidentals();\r\n\r\n          notationWithLyrics.lyric = lyric;\r\n        }\r\n\r\n        score.notations = score.notations.concat(items);\r\n\r\n        currSyllable++;\r\n      }\r\n    }\r\n  },\r\n\r\n  makeLyric: function (ctxt, text, lyricType) {\r\n\r\n    if (text.length > 1 && text[text.length - 1] === '-') {\r\n      if (lyricType === LyricType.EndingSyllable)\r\n        lyricType = LyricType.MiddleSyllable;\r\n      else if (lyricType === LyricType.SingleSyllable)\r\n        lyricType = LyricType.BeginningSyllable;\r\n\r\n      text = text.substring(0, text.length - 1);\r\n    }\r\n\r\n    var elides = false;\r\n    if (text.length > 1 && text[text.length - 1] === '_') {\r\n      // must be an elision\r\n      elides = true;\r\n      text = text.substring(0, text.length - 1);\r\n    }\r\n\r\n    if (text === \"*\" || text === \"\")\r\n      lyricType = LyricType.Directive;\r\n\r\n    var s = new Lyric(ctxt, text, lyricType);\r\n    s.elidesToNext = elides;\r\n\r\n    return s;\r\n  },\r\n\r\n  createNotations: function (ctxt, score, data, passByRef) {\r\n\r\n    var notations = [];\r\n\r\n    // if there is no data, then this must be a text only object\r\n    if (data === undefined || data === null || data === \"\") {\r\n      notations.push(new Neumes.TextOnly());\r\n      return notations;\r\n    }\r\n\r\n    var notes = [];\r\n    var out = { trailingSpace: -1 };\r\n\r\n    var that = this;\r\n    var addNotation = function(notation) {\r\n\r\n      // first, if we have any notes left over, we create a neume out of them\r\n      if (notes.length > 0) {\r\n        // create neume(s)\r\n\r\n        var neumes = that.createNeumesFromNotes(ctxt, score, notes, out.trailingSpace);\r\n        for (var i = 0; i < neumes.length; i++)\r\n          notations.push(neumes[i]);\r\n\r\n        // reset the trailing space\r\n        out.trailingSpace = -1;\r\n\r\n        notes = [];\r\n      }\r\n\r\n      // then, if we're passed a notation, let's add it\r\n      // also, perform chant logic here\r\n      if (notation !== null) {\r\n\r\n        if (notation.isClef) {\r\n          if (score.startingClef === null) {\r\n            score.startingClef = notation;\r\n            return;\r\n          }\r\n        } else if (notation.isAccidental)\r\n          passByRef.activeClef.activeAccidental = notation;\r\n        else if (notation.resetsAccidentals)\r\n          passByRef.activeClef.resetAccidentals();\r\n\r\n          notations.push(notation);\r\n      }\r\n    };\r\n\r\n    var atoms = data.match(__notationsRegex);\r\n\r\n    for (var i = 0; i < atoms.length; i++) {\r\n\r\n      var atom = atoms[i], lineBreak = null;\r\n\r\n      // handle the clefs and dividers here\r\n      switch (atom) {\r\n        case \",\":\r\n          addNotation(new Signs.QuarterBar());\r\n          break;\r\n        case \"`\":\r\n          addNotation(new Signs.Virgula());\r\n          break;\r\n        case \";\":\r\n          addNotation(new Signs.HalfBar());\r\n          break;\r\n        case \":\":\r\n          addNotation(new Signs.FullBar());\r\n          break;\r\n        case \"::\":\r\n          addNotation(new Signs.DoubleBar());\r\n          break;\r\n          // other gregorio dividers are not supported\r\n\r\n        case \"c1\":\r\n          passByRef.activeClef = new DoClef(-3, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"c2\":\r\n          passByRef.activeClef = new DoClef(-1, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"c3\":\r\n          passByRef.activeClef = new DoClef(1, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"c4\":\r\n          passByRef.activeClef = new DoClef(3, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"f3\":\r\n          passByRef.activeClef = new FaClef(1, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"f4\":\r\n          passByRef.activeClef = new FaClef(3, 2);\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"cb3\":\r\n          passByRef.activeClef = new DoClef(1, 2, new Signs.Accidental(0, Signs.AccidentalType.Flat));\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n        case \"cb4\":\r\n          passByRef.activeClef = new DoClef(3, 2, new Signs.Accidental(2, Signs.AccidentalType.Flat));\r\n          addNotation(passByRef.activeClef);\r\n          break;\r\n\r\n          case \"z\":\r\n            lineBreak = new ChantLineBreak(true);\r\n            addNotation(lineBreak);\r\n            break;\r\n          case \"Z\":\r\n            lineBreak = new ChantLineBreak(false);\r\n            addNotation(lineBreak);\r\n            break;\r\n          case \"z0\":\r\n            // unsupported for now...\r\n            break;\r\n\r\n          // spacing indicators\r\n          case \"!\":\r\n            out.trailingSpace = 0;\r\n            addNotation(null);\r\n            break;\r\n          case \"/\":\r\n            out.trailingSpace = ctxt.intraNeumeSpacing;\r\n            addNotation(null);\r\n            break;\r\n          case \"//\":\r\n            out.trailingSpace = ctxt.intraNeumeSpacing * 2;\r\n            addNotation(null);\r\n            break;\r\n\r\n\r\n          default:\r\n            // might be a custod, might be an accidental, or might be a note\r\n            if (atom.length > 1 && atom[1] === '+') {\r\n              // custod\r\n              var custod = new Custod();\r\n\r\n              custod.note = new Note(this.convertGabcStaffPositionToScribamPitch(passByRef.activeClef, data[0]));\r\n\r\n              addNotation(custod);\r\n\r\n            } else if (atom.length > 1 && (atom[1] === 'x' || atom[1] === 'y' || atom[1] === '#')) {\r\n\r\n              var accidentalType;\r\n\r\n              switch (atom[1]) {\r\n                case 'y':\r\n                  accidentalType = Signs.AccidentalType.Natural;\r\n                  break;\r\n                case '#':\r\n                  accidentalType = Signs.AccidentalType.Sharp;\r\n                  break;\r\n                default:\r\n                  accidentalType = Signs.AccidentalType.Flat;\r\n                  break;\r\n              }\r\n\r\n              var note = this.createNoteFromData(ctxt, passByRef.activeClef, atom);\r\n              var accidental = new Signs.Accidental(note.staffPosition, accidentalType);\r\n              accidental.trailingSpace = ctxt.intraNeumeSpacing * 2;\r\n\r\n              passByRef.activeClef.activeAccidental = accidental;\r\n              \r\n              addNotation(accidental);\r\n            } else {\r\n\r\n              // to make our interpreter more robust, make sure we have a clef to work with\r\n              if (passByRef.activeClef === null)\r\n                passByRef.activeClef = new DoClef(1, 2);\r\n\r\n              // looks like it's a note\r\n              notes.push(this.createNoteFromData(ctxt, passByRef.activeClef, atom));\r\n            }\r\n            break;\r\n      }\r\n    }\r\n\r\n    // finish up any remaining notes we have left\r\n    addNotation(null);\r\n\r\n    return notations;\r\n  },\r\n\r\n  createNeumesFromNotes: function (ctxt, score, notes, finalTrailingSpace) {\r\n    \r\n    var neumes = [];\r\n    var intraNeumeSpacing = ctxt.intraNeumeSpacing;\r\n\r\n    var prevNote = null, currNote = null;\r\n    var firstNoteIndex = 0;\r\n    var currNoteIndex = 0;\r\n\r\n    // here we use a simple finite state machine to create the neumes from the notes\r\n    // createNeume is helper function which returns the next state after a neume is created\r\n    // (unknownState). Each state object has a neume() function and a handle() function.\r\n    // neume() allows us to create the neume of the state in the event that we run out\r\n    // of notes. handle() gives the state an opportunity to examine the currNote and\r\n    // determine what to do...either transition to a different neume/state, or\r\n    // continue building the neume of that state. handle() returns the next state\r\n\r\n    var createNeume = function (neume, includeCurrNote) {\r\n\r\n      // add the notes to the neume\r\n      var lastNoteIndex = includeCurrNote ? currNoteIndex : currNoteIndex - 1;\r\n      while (firstNoteIndex <= lastNoteIndex)\r\n        neume.notes.push(notes[firstNoteIndex++]);\r\n\r\n      neumes.push(neume);\r\n\r\n      if (includeCurrNote === false) {\r\n        currNoteIndex--;\r\n        neume.keepWithNext = true;\r\n        neume.trailingSpace = intraNeumeSpacing;\r\n      }\r\n\r\n      return unknownState;\r\n    };\r\n\r\n    var unknownState = {\r\n      neume: function() {\r\n        return new Neumes.Punctum();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.shape === NoteShape.Virga)\r\n          return virgaState;\r\n        else if (currNote.shape === NoteShape.Stropha)\r\n          return apostrophaState;\r\n        else if (currNote.shape === NoteShape.Oriscus)\r\n          return oriscusState;\r\n        else if (currNote.shapeModifiers & NoteShapeModifiers.Cavum)\r\n          return createNeume(new Neumes.Punctum(), true);\r\n        else\r\n          return punctumState;\r\n      }\r\n    };\r\n\r\n    var punctumState = {\r\n      neume: function() {\r\n        return new Neumes.Punctum();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        \r\n        if (currNote.staffPosition > prevNote.staffPosition)\r\n          return podatusState;\r\n        else if (currNote.staffPosition < prevNote.staffPosition) {\r\n          if (currNote.shape === NoteShape.Inclinatum)\r\n            return climacusState;\r\n          else\r\n            return clivisState;\r\n        } else\r\n          return distrophaState;\r\n      }\r\n    };\r\n\r\n    var oriscusState = {\r\n      neume: function() {\r\n        return new Neumes.Oriscus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        \r\n        if (currNote.shape === NoteShape.Default) {\r\n\r\n          if (currNote.staffPosition > prevNote.staffPosition) {\r\n            prevNote.shapeModifiers |= NoteShapeModifiers.Ascending;\r\n            return createNeume(new Neumes.PesQuassus(), true);\r\n          } else if (currNote.staffPosition < prevNote.staffPosition) {\r\n            prevNote.shapeModifiers |= NoteShapeModifiers.Descending;\r\n            return createNeume(new Neumes.Clivis(), true);\r\n          }\r\n        } else\r\n          // stand alone oriscus\r\n          return createNeume(new Neumes.Oriscus(), true);\r\n      }\r\n    };\r\n\r\n    var podatusState = {\r\n      neume: function() {\r\n        return new Neumes.Podatus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.staffPosition > prevNote.staffPosition) {\r\n\r\n          if (prevNote.shape === NoteShape.Oriscus)\r\n            return salicusState;\r\n          else\r\n            return scandicusState;\r\n\r\n        } else if (currNote.staffPosition < prevNote.staffPosition) {\r\n          if (currNote.shape === NoteShape.Inclinatum)\r\n            return pesSubpunctisState;\r\n          else\r\n            return torculusState;\r\n        } else\r\n          return createNeume(new Neumes.Podatus(), false);\r\n      }\r\n    };\r\n\r\n    var clivisState = {\r\n      neume: function() {\r\n        return new Neumes.Clivis();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.shape === NoteShape.Default && currNote.staffPosition > prevNote.staffPosition)\r\n          return porrectusState;\r\n        else\r\n          return createNeume(new Neumes.Clivis(), false);\r\n      }\r\n    };\r\n\r\n    var climacusState = {\r\n      neume: function() {\r\n        return new Neumes.Climacus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        if (currNote.shape !== NoteShape.Inclinatum)\r\n          return createNeume(new Neumes.Climacus(), false);\r\n        else\r\n          return state;\r\n      }\r\n    };\r\n\r\n    var porrectusState = {\r\n      neume: function() {\r\n        return new Neumes.Porrectus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.shape === NoteShape.Default && currNote.staffPosition < prevNote.staffPosition)\r\n          return createNeume(new Neumes.PorrectusFlexus(), true);\r\n        else\r\n          return createNeume(new Neumes.Porrectus(), false);\r\n      }\r\n    };\r\n\r\n    var pesSubpunctisState = {\r\n      neume: function() {\r\n        return new Neumes.PesSubpunctis();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n    \r\n        if (currNote.shape !== NoteShape.Inclinatum)\r\n          return createNeume(new Neumes.PesSubpunctis(), false);\r\n        else\r\n          return state;\r\n      }\r\n    };\r\n\r\n    var salicusState = {\r\n      neume: function() {\r\n        return new Neumes.Salicus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.staffPosition < prevNote.staffPosition)\r\n          return salicusFlexusState;\r\n        else\r\n          return createNeume(new Neumes.Salicus(), false);\r\n      }\r\n    };\r\n\r\n    var salicusFlexusState = {\r\n      neume: function() {\r\n        return new Neumes.SalicusFlexus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        return createNeume(new Neumes.SalicusFlexus(), false);\r\n      }\r\n    };\r\n\r\n    var scandicusState = {\r\n      neume: function() {\r\n        return new Neumes.Scandicus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n\r\n        if (currNote.shape === NoteShape.Default && currNote.staffPosition < prevNote.staffPosition)\r\n          return scandicusFlexusState;\r\n        else\r\n          return createNeume(new Neumes.Scandicus(), false);\r\n      }\r\n    };\r\n\r\n    var scandicusFlexusState = {\r\n      neume: function() {\r\n        return new Neumes.ScandicusFlexus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        return createNeume(new Neumes.ScandicusFlexus(), false);\r\n      }\r\n    };\r\n\r\n    var virgaState = {\r\n      neume: function() {\r\n        return new Neumes.Virga();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n    \r\n        if (currNote.shape === NoteShape.Inclinatum && currNote.staffPosition < prevNote.staffPosition)\r\n          return climacusState;\r\n        else if (currNote.shape === NoteShape.Virga && currNote.staffPosition === prevNote.staffPosition)\r\n          return bivirgaState;\r\n        else\r\n          return createNeume(new Neumes.Virga(), false);\r\n      }\r\n    };\r\n\r\n    var bivirgaState = {\r\n      neume: function() {\r\n        return new Neumes.Bivirga();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n    \r\n        if (currNote.shape === NoteShape.Virga && currNote.staffPosition === prevNote.staffPosition)\r\n          return createNeume(new Neumes.Trivirga(), false);\r\n        else\r\n          return createNeume(new Neumes.Bivirga(), false);\r\n      }\r\n    };\r\n\r\n    var apostrophaState = {\r\n      neume: function() {\r\n        return new Neumes.Apostropha();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        if (currNote.staffPosition === prevNote.staffPosition && currNote.shape === NoteShape.Stropha)\r\n          return distrophaState;\r\n        else\r\n          return createNeume(new Neumes.Apostropha(), false);\r\n      }\r\n    };\r\n\r\n    var distrophaState = {\r\n      neume: function() {\r\n        return new Neumes.Distropha();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        if (currNote.staffPosition === prevNote.staffPosition && currNote.shape === NoteShape.Stropha)\r\n          return createNeume(new Neumes.Tristropha(), true);\r\n        else\r\n          return createNeume(new Neumes.Distropha(), false);\r\n      }\r\n    };\r\n\r\n    var torculusState = {\r\n      neume: function() {\r\n        return new Neumes.Torculus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        if (currNote.shape === NoteShape.Default && currNote.staffPosition > prevNote.staffPosition)\r\n          return torculusResupinusState;\r\n        else\r\n          return createNeume(new Neumes.Torculus(), false);\r\n      }\r\n    };\r\n\r\n    var torculusResupinusState = {\r\n      neume: function() {\r\n        return new Neumes.TorculusResupinus();\r\n      },\r\n      handle: function(currNote, prevNote) {\r\n        if (currNote.shape === NoteShape.Default && currNote.staffPosition < prevNote.staffPosition)\r\n          return createNeume(new Neumes.TorculusResupinusFlexus(), true);\r\n        else\r\n          return createNeume(new Neumes.TorculusResupinus(), false);\r\n      }\r\n    };\r\n\r\n    var state = unknownState;\r\n\r\n    while (currNoteIndex < notes.length) {\r\n\r\n      prevNote = currNote;\r\n      currNote = notes[currNoteIndex];\r\n\r\n      state = state.handle(currNote, prevNote);\r\n\r\n      // if we are on the last note, then try to create a neume if we need to.\r\n      if (currNoteIndex === notes.length - 1 && state !== unknownState)\r\n        createNeume(state.neume(), true);\r\n\r\n      currNoteIndex++;\r\n    }\r\n\r\n    if (neumes.length > 0) {\r\n      if (finalTrailingSpace >= 0) {\r\n        neumes[neumes.length - 1].keepWithNext = true;\r\n        neumes[neumes.length - 1].trailingSpace = finalTrailingSpace;\r\n      }\r\n    }\r\n\r\n    return neumes;\r\n  },\r\n\r\n  createNoteFromData: function (ctxt, clef, data) {\r\n\r\n    var note = new Note();\r\n\r\n    if (data.length < 1)\r\n      throw 'Invalid note data: ' + data;\r\n\r\n    if (data[0] === '-') { // liquescent initio debilis\r\n      note.liquescent = LiquescentType.InitioDebilis;\r\n      data = data.substring(1);\r\n    }\r\n\r\n    if (data.length < 1)\r\n      throw 'Invalid note data: ' + data;\r\n\r\n    // the next char is always the pitch\r\n    var pitch = this.convertGabcStaffPositionToScribamPitch(clef, data[0]);\r\n\r\n    if (data[0] === data[0].toUpperCase())\r\n      note.shape = NoteShape.Inclinatum;\r\n\r\n    note.staffPosition = this.convertGabcStaffPositionToScribamStaffPosition(clef, data[0]);\r\n    note.pitch = pitch;\r\n\r\n    var mark;\r\n\r\n    // process the modifiers\r\n    for (var i = 1; i < data.length; i++) {\r\n\r\n      var c = data[i];\r\n      var lookahead = '\\0';\r\n\r\n      var haveLookahead = i + 1 < data.length;\r\n      if (haveLookahead)\r\n        lookahead = data[i + 1];\r\n\r\n      switch (c) {\r\n\r\n        // rhythmic markings\r\n        case '.':\r\n          mark = new Markings.Mora(note, ctxt.staffInterval / 4.0);\r\n          if (haveLookahead && lookahead === '1')\r\n            mark.positionHint = MarkingPositionHint.Above;\r\n          else if (haveLookahead && lookahead === '0')\r\n            mark.positionHint = MarkingPositionHint.Below;\r\n          \r\n          note.markings.push(mark);\r\n          break;\r\n\r\n        case '_':\r\n          mark = new Markings.HorizontalEpisema(note);\r\n          if (haveLookahead) {\r\n            if (lookahead === '0')\r\n              mark.positionHint = MarkingPositionHint.Below;\r\n            else if (lookahead === '1')\r\n              mark.positionHint = MarkingPositionHint.Above;\r\n            else if (lookahead === '2')\r\n              mark.terminating = true;\r\n\r\n            // check for another lookahead...\r\n            if (++i + 1 < data.length && data[i + 1] === '2') {\r\n              mark.terminating = true;\r\n              i++;\r\n            }\r\n          }\r\n          note.markings.push(mark);\r\n          break;\r\n\r\n        case '\\'':\r\n          mark = new Markings.Ictus(note);\r\n          if (haveLookahead && lookahead === '1')\r\n            mark.positionHint = MarkingPositionHint.Above;\r\n          else if (haveLookahead && lookahead === '0')\r\n            mark.positionHint = MarkingPositionHint.Below;\r\n\r\n          note.markings.push(mark);\r\n          break;\r\n\r\n        //note shapes\r\n        case 'r':\r\n          if (haveLookahead && lookahead === '1') {\r\n            note.markings.push(new Markings.AcuteAccent(note));\r\n            i++;\r\n          } else\r\n            note.shapeModifiers |= NoteShapeModifiers.Cavum;\r\n          break;\r\n\r\n        case 's':\r\n          note.shape = NoteShape.Stropha;\r\n          break;\r\n\r\n        case 'v':\r\n          note.shape = NoteShape.Virga;\r\n          break;\r\n\r\n        case 'w':\r\n          note.shape = NoteShape.Quilisma;\r\n          break;\r\n\r\n        case 'o':\r\n          note.shape = NoteShape.Oriscus;\r\n          if (haveLookahead && lookahead === '<') {\r\n            note.shapeModifiers |= NoteShapeModifiers.Ascending;\r\n            i++;\r\n          } else if (haveLookahead && lookahead === '>') {\r\n            note.shapeModifiers |= NoteShapeModifiers.Descending;\r\n            i++;\r\n          } else\r\n            note.shapeModifiers |= NoteShapeModifiers.Ascending;\r\n          break;\r\n\r\n        case 'O':\r\n          note.shape = NoteShape.Oriscus;\r\n          if (haveLookahead && lookahead === '<') {\r\n            note.shapeModifiers |= NoteShapeModifiers.Ascending | NoteShapeModifiers.Stemmed;\r\n            i++;\r\n          } else if (haveLookahead && lookahead === '>') {\r\n            note.shapeModifiers |= NoteShapeModifiers.Descending | NoteShapeModifiers.Stemmed;\r\n            i++;\r\n          } else\r\n            note.shapeModifiers |= NoteShapeModifiers.Ascending | NoteShapeModifiers.Stemmed;\r\n          break;\r\n\r\n        // liquescents\r\n        case '~':\r\n          if (note.shape === NoteShape.Inclinatum)\r\n            note.liquescent |= LiquescentType.Small;\r\n          else if (note.shape === NoteShape.Oriscus)\r\n            note.liquescent |= LiquescentType.Large;\r\n          else\r\n            note.liquescent |= LiquescentType.Small;\r\n          break;\r\n        case '<':\r\n          note.liquescent |= LiquescentType.Ascending;\r\n          break;\r\n        case '>':\r\n          note.liquescent |= LiquescentType.Descending;\r\n          break;\r\n\r\n        // accidentals\r\n        case 'x':\r\n          if (note.pitch.step === Step.Mi)\r\n            note.pitch.step = Step.Me;\r\n          else if (note.pitch.step === Step.Ti)\r\n            note.pitch.step = Step.Te;\r\n          break;\r\n        case 'y':\r\n          if (note.pitch.step === Step.Te)\r\n            note.pitch.step = Step.Ti;\r\n          else if (note.pitch.step === Step.Me)\r\n            note.pitch.step = Step.Mi;\r\n          else if (note.pitch.step === Step.Du)\r\n            note.pitch.step = Step.Do;\r\n          else if (note.pitch.step === Step.Fu)\r\n            note.pitch.step = Step.Fa;\r\n          break;\r\n        case '#':\r\n          if (note.pitch.step === Step.Do)\r\n            note.pitch.step = Step.Du;\r\n          else if (note.pitch.step === Step.Fa)\r\n            note.pitch.step = Step.Fu;\r\n          break;\r\n      }\r\n    }\r\n\r\n    return note;\r\n  },\r\n\r\n  // returns pitch\r\n  convertGabcStaffPositionToScribamStaffPosition: function (clef, gabcStaffPos) {\r\n    return gabcStaffPos.toLowerCase().charCodeAt(0) - 'a'.charCodeAt(0) - 6;\r\n  },\r\n\r\n  // returns pitch\r\n  convertGabcStaffPositionToScribamPitch: function (clef, gabcStaffPos) {\r\n    var scribamStaffPosition = this.convertGabcStaffPositionToScribamStaffPosition(clef, gabcStaffPos)\r\n\r\n    var pitch = clef.staffPositionToPitch(scribamStaffPosition);\r\n\r\n    if (clef.activeAccidental !== null)\r\n      clef.activeAccidental.applyToPitch(pitch);\r\n\r\n    return pitch;\r\n  }\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Gabc.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport * as Exsurge from './Exsurge.Core'\r\nimport { ctxt, QuickSvg, ChantLayoutElement, GlyphCode, GlyphVisualizer, HorizontalEpisemaVisualizer } from './Exsurge.Drawing'\r\nimport { Note, NoteShape } from './Exsurge.Chant'\r\n\r\nexport class Marking extends ChantLayoutElement {\r\n\r\n  constructor(note) {\r\n    super();\r\n\r\n    this.note = note;\r\n    this.horizontalOffset = 0;\r\n    this.verticalOffset = 0;\r\n    this.positionHint = Exsurge.MarkingPositionHint.Default;\r\n\r\n    // each marking has its own visualizer\r\n    this.visualizer = null;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n  }\r\n}\r\n\r\nexport class AcuteAccent extends Marking {\r\n\r\n  constructor(note) {\r\n    super(note);\r\n\r\n    this.positionHint = Exsurge.MarkingPositionHint.Above;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n    this.visualizer = new GlyphVisualizer(ctxt, GlyphCode.AcuteAccent);\r\n\r\n    // fixme: acute markings might need to be positioned vertically over\r\n    // the notation bounds of the chantline after everything has already\r\n    // been laid out on the line...for now we just place them a\r\n    // reasonable height above the staff line.\r\n    this.verticalOffset = -ctxt.staffInterval * 5;\r\n    this.horizontalOffset = -this.visualizer.bounds.x; // center on the note itself\r\n\r\n    this.bounds = this.visualizer.bounds.clone();\r\n    this.bounds.x += this.horizontalOffset;\r\n    this.bounds.y += this.verticalOffset;\r\n\r\n    // position the visualizer too...\r\n    this.visualizer.bounds.x = this.bounds.x;\r\n    this.visualizer.bounds.y = this.bounds.y;\r\n\r\n    super.performLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * HorizontalEpisema\r\n */\r\nexport class HorizontalEpisema extends Marking {\r\n\r\n  constructor(note) {\r\n    super(note);\r\n  }\r\n\r\n  updateY(y) {\r\n    this.bounds.y = y;\r\n    this.visualizer.bounds.y = y;\r\n    this.terminating = false; // indicates if this episema should terminate itself or not\r\n  }\r\n\r\n  updateWidth(width) {\r\n    this.bounds.width = width;\r\n    this.visualizer.bounds.width = width;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // following logic helps to keep the episemae away from staff lines if they get too close\r\n    // The idea is this: since the staff lines are odd numbered multiples of ctxt.staffInterval,\r\n    // Math.round(y / ctxt.staffInterval) % 2 tells us if we're closer to a space or a line.\r\n    // If it's an odd number then we shift away from line by adding .5 to the step, which puts\r\n    // us the closest we want to be to a line.\r\n\r\n    var y = 0, step;\r\n    var minDistanceAway = ctxt.staffInterval * 0.4; // min distance from neume\r\n\r\n    if (this.positionHint === Exsurge.MarkingPositionHint.Below) {\r\n      y = this.note.bounds.bottom() + minDistanceAway; // the highest the line could be at\r\n      step = Math.round(y / ctxt.staffInterval);\r\n\r\n      // if it's an odd step, that means we're near a line, and therefore\r\n      // need to shift down\r\n      if (Math.abs(step % 2) === 1)\r\n        y = (step + 0.5) * ctxt.staffInterval;\r\n    } else {\r\n      y = this.note.bounds.y - minDistanceAway; // the lowest the line could be at\r\n      step = Math.round(y / ctxt.staffInterval);\r\n\r\n      // if it's an odd step, that means we're near a line, and therefore\r\n      // need to shift up\r\n      if (Math.abs(step % 2) === 1)\r\n        y = (step - 0.5) * ctxt.staffInterval;\r\n    }\r\n\r\n    var glyphCode = this.note.glyphVisualizer.glyphCode;\r\n    var width;\r\n\r\n    // The porrectus requires special handling of the note width,\r\n    // otherwise the width is just that of the note itself\r\n    if (glyphCode === GlyphCode.Porrectus1 ||\r\n        glyphCode === GlyphCode.Porrectus2 ||\r\n        glyphCode === GlyphCode.Porrectus3 ||\r\n        glyphCode === GlyphCode.Porrectus4)\r\n      width = ctxt.staffInterval;\r\n    else\r\n      width = this.note.bounds.width;\r\n\r\n    this.bounds.x = this.note.bounds.x;\r\n    this.bounds.y = y;\r\n    this.bounds.width = width;\r\n    this.bounds.height = ctxt.episemaLineWeight;\r\n\r\n    this.origin.x = 0;\r\n    this.origin.y = 0;\r\n\r\n    this.visualizer = new HorizontalEpisemaVisualizer(ctxt, this.note.bounds.x, y, width);\r\n  }\r\n}\r\n\r\n/*\r\n * Ictus\r\n */\r\nexport class Ictus extends Marking {\r\n\r\n  constructor(note) {\r\n    super(note);\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n    var glyphCode;\r\n\r\n    // fixme: this positioning logic doesn't work for the ictus on a virga apparently...?\r\n\r\n    if (this.positionHint === Exsurge.MarkingPositionHint.Above) {\r\n      glyphCode = GlyphCode.VerticalEpisemaAbove;\r\n    } else {\r\n      glyphCode = GlyphCode.VerticalEpisemaBelow;\r\n    }\r\n\r\n    var staffPosition = this.note.staffPosition;\r\n    \r\n    this.horizontalOffset = this.note.bounds.width / 2;\r\n    this.verticalOffset = 0;\r\n\r\n    switch (glyphCode) {\r\n      case GlyphCode.VerticalEpisemaAbove:\r\n        if (staffPosition % 2 === 0)\r\n          this.verticalOffset -= ctxt.staffInterval * 1.5;\r\n        else\r\n          this.verticalOffset -= ctxt.staffInterval * .9;\r\n        break;\r\n\r\n      case GlyphCode.VerticalEpisemaBelow:\r\n      default:\r\n        if (staffPosition % 2 === 0)\r\n          this.verticalOffset += ctxt.staffInterval * 1.5;\r\n        else\r\n          this.verticalOffset += ctxt.staffInterval * .8;\r\n        break;\r\n    }\r\n\r\n    this.visualizer = new GlyphVisualizer(ctxt, glyphCode);\r\n    this.visualizer.setStaffPosition(ctxt, staffPosition);\r\n\r\n    this.bounds = this.visualizer.bounds.clone();\r\n    this.bounds.x = this.note.bounds.x + this.horizontalOffset - this.visualizer.origin.x;\r\n    this.bounds.y += this.verticalOffset;\r\n\r\n    this.visualizer.bounds.x = this.bounds.x;\r\n    this.visualizer.bounds.y = this.bounds.y;\r\n\r\n    super.performLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Mora\r\n */\r\nexport class Mora extends Marking {\r\n\r\n  constructor(note, horizontalOffset) {\r\n    super(note);\r\n\r\n    this.horizontalOffset = horizontalOffset;\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n\r\n    var staffPosition = this.note.staffPosition;\r\n\r\n    this.visualizer = new GlyphVisualizer(ctxt, GlyphCode.Mora);\r\n    this.visualizer.setStaffPosition(ctxt, staffPosition);\r\n\r\n    this.verticalOffset = 0;\r\n    switch (this.positionHint) {\r\n      case Exsurge.MarkingPositionHint.Below:\r\n        if (staffPosition % 2 === 0)\r\n          this.verticalOffset += ctxt.staffInterval / 3.0;\r\n        else\r\n          this.verticalOffset += (ctxt.staffInterval * 2) / 3.0;\r\n        break;\r\n\r\n      case Exsurge.MarkingPositionHint.Default:\r\n      case Exsurge.MarkingPositionHint.Above:\r\n      default:\r\n        if (staffPosition % 2 === 0)\r\n          this.verticalOffset -= ctxt.staffInterval / 3.0;\r\n        else\r\n          this.verticalOffset -= (ctxt.staffInterval * 2) / 3.0;\r\n        break;\r\n    }\r\n\r\n    this.bounds = this.visualizer.bounds.clone();\r\n    this.bounds.x += this.note.bounds.right() + this.horizontalOffset;\r\n    this.bounds.y += this.verticalOffset;\r\n\r\n    this.visualizer.bounds.x = this.bounds.x;\r\n    this.visualizer.bounds.y = this.bounds.y;\r\n\r\n    super.performLayout(ctxt);\r\n  }\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Chant.Markings.js\n **/","//\r\n// Author(s):\r\n// Fr. Matthew Spencer, OSJ <mspencer@osjusa.org>\r\n//\r\n// Copyright (c) 2008-2016 Fr. Matthew Spencer, OSJ\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining a copy\r\n// of this software and associated documentation files (the \"Software\"), to deal\r\n// in the Software without restriction, including without limitation the rights\r\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n// copies of the Software, and to permit persons to whom the Software is\r\n// furnished to do so, subject to the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n// THE SOFTWARE.\r\n//\r\n\r\nimport * as Exsurge from 'Exsurge.Core'\r\nimport { Step, Pitch, Rect, Point, Margins } from 'Exsurge.Core'\r\nimport { ctxt, QuickSvg, ChantLayoutElement, ChantNotationElement, GlyphCode, GlyphVisualizer, NeumeLineVisualizer, HorizontalEpisemaLineVisualizer } from 'Exsurge.Drawing'\r\nimport { Note, LiquescentType, NoteShape, NoteShapeModifiers } from 'Exsurge.Chant'\r\nimport { Glyphs } from 'Exsurge.Glyphs'\r\n\r\n/*\r\n * Neumes base class\r\n */\r\nexport class Neume extends ChantNotationElement {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    this.notes = [];\r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n  }\r\n\r\n  finishLayout(ctxt) {\r\n\r\n    // allow subclasses an opportunity position their own markings...\r\n    this.positionMarkings();\r\n\r\n    // layout the markings of the notes\r\n    for (var i = 0; i < this.notes.length; i++) {\r\n      var note = this.notes[i];\r\n\r\n      for (var j = 0; j < note.markings.length; j++) {\r\n        var marking = note.markings[j];\r\n\r\n        marking.performLayout(ctxt);\r\n        this.addVisualizer(marking.visualizer);\r\n      }\r\n    }\r\n\r\n    super.finishLayout(ctxt);\r\n  }\r\n\r\n  // subclasses can override this in order to correctly place markings in a neume specific way\r\n  positionMarkings() {\r\n\r\n  }\r\n\r\n  layoutNotesAsPodatus(ctxt, lowerNote, upperNote, startingX) {\r\n\r\n    startingX = startingX || 0;\r\n\r\n    var overhangUpperNote = true;\r\n\r\n    if (lowerNote.liquescent === LiquescentType.InitioDebilis) {\r\n\r\n      // liquescent upper note or not?\r\n      if (upperNote.liquescent === LiquescentType.None)\r\n        upperNote.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n      else\r\n        upperNote.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n\r\n      lowerNote.setGlyph(ctxt, GlyphCode.TerminatingDesLiquescent);\r\n      overhangUpperNote = false;\r\n    } else if (upperNote.liquescent === LiquescentType.LargeAscending) {\r\n      lowerNote.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n      upperNote.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n      overhangUpperNote = false;\r\n    } else if (upperNote.liquescent === LiquescentType.LargeDescending) {\r\n      lowerNote.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n      upperNote.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n      overhangUpperNote = false;\r\n    } else if (upperNote.liquescent === LiquescentType.SmallAscending) {\r\n      lowerNote.setGlyph(ctxt, GlyphCode.BeginningAscLiquescent);\r\n      upperNote.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n    } else {\r\n      // standard shape\r\n      lowerNote.setGlyph(ctxt, GlyphCode.PodatusLower);\r\n      upperNote.setGlyph(ctxt, GlyphCode.PodatusUpper);\r\n    }\r\n\r\n    // allow a quilisma pes\r\n    if (lowerNote.shape === NoteShape.Quilisma)\r\n      lowerNote.setGlyph(ctxt, GlyphCode.Quilisma);\r\n\r\n    lowerNote.bounds.x = startingX;\r\n\r\n    var line = new NeumeLineVisualizer(ctxt, lowerNote, upperNote, false);\r\n    line.bounds.x = lowerNote.bounds.right() - line.bounds.width;\r\n    this.addVisualizer(line);\r\n\r\n    // if it's overhanging, then right align the glyph\r\n    if (overhangUpperNote === true)\r\n      upperNote.bounds.x += line.bounds.right() - upperNote.bounds.width;\r\n    else\r\n      upperNote.bounds.x += line.bounds.x;\r\n\r\n    // add the elements\r\n    this.addVisualizer(lowerNote);\r\n    this.addVisualizer(upperNote);\r\n  }\r\n\r\n  // lays out a sequence of notes that are inclinati (e.g., climacus, pes subpunctis)\r\n  layoutNotesAsInclinati(ctxt, notes, startingX) {\r\n\r\n    var staffPosition = notes[0].staffPosition, prevStaffPosition = notes[0].staffPosition;\r\n\r\n    // it is important to advance by the width of the inclinatum glyph itself\r\n    // rather than by individual note widths, so that any liquescents are spaced\r\n    // the same as non-liquscents\r\n    var advanceWidth = Glyphs.PunctumInclinatum.bounds.width * ctxt.glyphScaling;\r\n\r\n    // now add all the punctum inclinati\r\n    for (var i = 0; i < notes.length; i++, prevStaffPosition = staffPosition) {\r\n      var note = notes[i];\r\n\r\n      if (note.liquescent === LiquescentType.LargeAscending ||\r\n        note.liquescent === LiquescentType.LargeDescending)\r\n        // fixme: is the large inclinatum liquescent the same as the apostropha?\r\n        note.setGlyph(ctxt, GlyphCode.Apostropha);\r\n      else if (note.liquescent === LiquescentType.SmallAscending ||\r\n        note.liquescent === LiquescentType.SmallDescending)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumInclinatumLiquescent);\r\n      else\r\n        // fixme: some climaci in the new chant books end with a punctum cuadratum\r\n        // (see, for example, the antiphon \"Sancta Maria\" for October 7).\r\n        note.setGlyph(ctxt, GlyphCode.PunctumInclinatum);\r\n\r\n      staffPosition = note.staffPosition;\r\n\r\n      // fixme: how do these calculations look for puncti inclinati based on staff position offsets?\r\n      var multiple;\r\n      switch (Math.abs(prevStaffPosition - staffPosition)) {\r\n        case 0:\r\n          multiple = 0;\r\n          break;\r\n        case 1:\r\n          multiple = 0.8;\r\n          break;\r\n        default:\r\n          multiple = 1.2;\r\n          break;\r\n      }\r\n\r\n      startingX += advanceWidth * multiple;\r\n      note.bounds.x += startingX;\r\n\r\n      this.addVisualizer(note);\r\n    }\r\n  }\r\n}\r\n\r\n/*\r\n * Apostropha\r\n */\r\nexport class Apostropha extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // determine the glyph to use\r\n    var note = this.notes[0];\r\n\r\n    if (note.liquescent !== LiquescentType.None)\r\n      note.setGlyph(ctxt, GlyphCode.StrophaLiquescent);\r\n    else\r\n      note.setGlyph(ctxt, GlyphCode.Stropha);\r\n\r\n    this.addVisualizer(note);\r\n\r\n    this.origin.x = note.origin.x;\r\n    this.origin.y = note.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  static determineNoteGlyphCode(note) {\r\n\r\n    if (note.shape === NoteShape.Stropha)\r\n      return GlyphCode.Stropha;\r\n\r\n    if (note.shapeModifiers & NoteShapeModifiers.Cavum)\r\n      return GlyphCode.PunctumCavum;\r\n\r\n    return GlyphCode.PunctumCuadratum;\r\n  }\r\n}\r\n\r\n/*\r\n * Bivirga\r\n *\r\n * For simplicity in implementation, Bivirga's have two notes in the object\r\n * structure. These technically must be the same pitch though.\r\n */\r\nexport class Bivirga extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note1 = this.notes[0];\r\n    var note2 = this.notes[1];\r\n\r\n    note1.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\r\n    note2.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\r\n\r\n    note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\r\n\r\n    this.addVisualizer(note1);\r\n    this.addVisualizer(note2);\r\n\r\n    this.origin.x = note1.origin.x;\r\n    this.origin.y = note1.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Trivirga\r\n *\r\n * For simplicity in implementation, Trivirga's have three notes in the object\r\n * structure. These technically must be the same pitch though.\r\n */\r\nexport class Trivirga extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note1 = this.notes[0];\r\n    var note2 = this.notes[1];\r\n    var note3 = this.notes[2];\r\n\r\n    note1.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\r\n    note2.setGlyph(ctxt, Virga.getGlyphCode(note1.staffPosition));\r\n    note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\r\n\r\n    note3.setGlyph(ctxt, Virga.getGlyphCode(staffPosition));\r\n    note3.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing + note2.bounds.width + ctxt.intraNeumeSpacing;\r\n\r\n    this.addVisualizer(note1);\r\n    this.addVisualizer(note2);\r\n    this.addVisualizer(note3);\r\n\r\n    this.origin.x = note1.origin.x;\r\n    this.origin.y = note1.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Climacus\r\n */\r\nexport class Climacus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // the first note is always a virga...\r\n    var virga = this.notes[0];\r\n    virga.setGlyph(ctxt, Virga.getGlyphCode(virga.staffPosition));\r\n\r\n    this.addVisualizer(virga);\r\n\r\n    this.layoutNotesAsInclinati(ctxt, this.notes.slice(1), virga.bounds.right() + ctxt.intraNeumeSpacing / 2);\r\n\r\n    this.origin.x = virga.origin.x;\r\n    this.origin.y = virga.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Clivis\r\n */\r\nexport class Clivis extends Neume {\r\n\r\n  positionMarkings() {\r\n\r\n    var hasLowerMora = false;\r\n    var marking, i;\r\n\r\n    // 1. morae need to be lined up if both notes have morae\r\n    // 2. like the podatus, mora on lower note needs to below\r\n    //    under certain circumstances\r\n    for (i = 0; i < this.notes[1].markings.length; i++) {\r\n      marking = this.notes[1].markings[i];\r\n\r\n      if (marking.constructor.name === 'Mora') {\r\n\r\n        hasLowerMora = true;\r\n\r\n        if (this.notes[0].staffPosition - this.notes[1].staffPosition === 1 &&\r\n            Math.abs(this.notes[1].staffPosition % 2) === 1)\r\n          marking.positionHint = Exsurge.MarkingPositionHint.Below;\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < this.notes[0].markings.length; i++) {\r\n      marking = this.notes[0].markings[i];\r\n\r\n      if (marking.constructor.name === 'Mora' && hasLowerMora) {\r\n        marking.positionHint = Exsurge.MarkingPositionHint.Above;\r\n        marking.horizontalOffset += this.notes[1].bounds.right() - this.notes[0].bounds.right();\r\n      }\r\n    }    \r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line;\r\n\r\n    var upper = this.notes[0];\r\n    var lower = this.notes[1];\r\n\r\n    if (upper.shape === NoteShape.Oriscus)\r\n      upper.setGlyph(ctxt, GlyphCode.OriscusDes);\r\n    else {\r\n      upper.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n      // add an ascending line\r\n      line = new NeumeLineVisualizer(ctxt, lower, upper, true);\r\n      line.bounds.x = upper.bounds.x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    if (lower.liquescent & LiquescentType.Small) {\r\n      lower.setGlyph(ctxt, GlyphCode.TerminatingDesLiquescent);\r\n      lower.bounds.x -= lower.bounds.width; // right aligned\r\n    } else if (lower.liquescent === LiquescentType.Ascending)\r\n      lower.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n    else if (lower.liquescent === LiquescentType.Descending)\r\n      lower.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else\r\n      lower.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    var x = upper.bounds.right();\r\n\r\n    // do we need to draw a descending line?\r\n    if (upper.staffPosition - lower.staffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, upper, lower, false);\r\n      line.bounds.x = x - line.bounds.width;\r\n      this.addVisualizer(line);\r\n\r\n      if (!(lower.liquescent & LiquescentType.Small))\r\n        x -= line.bounds.width;\r\n    }\r\n\r\n    lower.bounds.x += x;\r\n\r\n    this.addVisualizer(upper);\r\n    this.addVisualizer(lower);\r\n\r\n    this.origin.x = upper.origin.x;\r\n    this.origin.y = upper.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n\r\n\r\n/*\r\n * Distropha\r\n *\r\n * For simplicity in implementation, Distropha's have two notes in the object\r\n * structure. These technically must be the same pitch though (like Bivirga).\r\n */\r\nexport class Distropha extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note1 = this.notes[0];\r\n    var note2 = this.notes[1];\r\n\r\n    note1.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note1));\r\n    note2.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note2));\r\n    note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\r\n\r\n    this.addVisualizer(note1);\r\n    this.addVisualizer(note2);\r\n\r\n    this.origin.x = note1.origin.x;\r\n    this.origin.y = note1.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Oriscus\r\n */\r\nexport class Oriscus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // determine the glyph to use\r\n    var note = this.notes[0];\r\n\r\n    if (note.liquescent !== LiquescentType.None) {\r\n      note.setGlyph(ctxt, GlyphCode.OriscusLiquescent);\r\n    } else {\r\n      if (note.shapeModifiers & NoteShapeModifiers.Ascending)\r\n        note.setGlyph(ctxt, GlyphCode.OriscusAsc);\r\n      else\r\n        note.setGlyph(ctxt, GlyphCode.OriscusDes);\r\n    }\r\n\r\n    this.addVisualizer(note);\r\n\r\n    this.origin.x = note.origin.x;\r\n    this.origin.y = note.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * PesQuassus\r\n */\r\nexport class PesQuassus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var x = 0;\r\n\r\n    var lower = this.notes[0];\r\n    var upper = this.notes[1];\r\n    var line;\r\n\r\n    var lowerStaffPos = lower.staffPosition;\r\n    var upperStaffPos = upper.staffPosition;\r\n\r\n    if (lower.shape === NoteShape.Oriscus)\r\n      lower.setGlyph(ctxt, GlyphCode.OriscusAsc);\r\n    else\r\n      lower.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    if (upper.liquescent === LiquescentType.LargeDescending)\r\n      upper.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else\r\n      upper.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    lower.bounds.x = x;\r\n    this.addVisualizer(lower);\r\n\r\n    x += lower.bounds.right();\r\n\r\n    var needsLines = upperStaffPos - lowerStaffPos > 1;\r\n    if (needsLines) {\r\n      line = new NeumeLineVisualizer(ctxt, lower, upper, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    upper.bounds.x = x;\r\n\r\n    upper.bounds.x = x;\r\n    this.addVisualizer(upper);\r\n\r\n    x += upper.bounds.width;\r\n\r\n    // add a hanging line if we need it\r\n    if (needsLines) {\r\n      line = new NeumeLineVisualizer(ctxt, upper, lower, true);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    this.origin.x = lower.origin.x;\r\n    this.origin.y = lower.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * PesSubpunctis\r\n */\r\nexport class PesSubpunctis extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // layout is a podatus followed by inclinati\r\n    this.layoutNotesAsPodatus(ctxt, this.notes[0], this.notes[1]);\r\n    this.layoutNotesAsInclinati(ctxt, this.notes.slice(2), this.notes[0].bounds.right() + ctxt.intraNeumeSpacing / 2);\r\n\r\n    this.origin.x = this.notes[0].origin.x;\r\n    this.origin.y = this.notes[0].origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Podatus\r\n *\r\n * This podatus class handles a few neume types actually, depending on the note\r\n * data: Podatus (including various liquescent types on the upper note),\r\n * Podatus initio debilis, and Quilisma-Pes\r\n */\r\nexport class Podatus extends Neume {\r\n\r\n  positionMarkings() {\r\n    var marking, i;\r\n\r\n    // 1. episema on lower note should always be below, upper note above\r\n    // 2. morae: \r\n    //   a. if podatus difference is 1 and lower note is on a line,\r\n    //      the lower mora should be below\r\n    for (i = 0; i < this.notes[0].markings.length; i++) {\r\n      marking = this.notes[0].markings[i];\r\n\r\n      if (marking.constructor.name === 'HorizontalEpisema')\r\n        marking.positionHint = Exsurge.MarkingPositionHint.Below;\r\n      else if (marking.constructor.name === 'Mora' &&\r\n          (this.notes[1].staffPosition - this.notes[0].staffPosition) === 1 &&\r\n          Math.abs(this.notes[0].staffPosition % 2) === 1)\r\n        marking.positionHint = Exsurge.MarkingPositionHint.Below;\r\n    }\r\n\r\n    for (i = 0; i < this.notes[1].markings.length; i++) {\r\n      marking = this.notes[1].markings[i];\r\n\r\n      if (marking.constructor.name === 'HorizontalEpisema')\r\n        marking.positionHint = Exsurge.MarkingPositionHint.Above;\r\n    }    \r\n  }\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    this.layoutNotesAsPodatus(ctxt, this.notes[0], this.notes[1]);\r\n\r\n    this.origin.x = this.notes[0].origin.x;\r\n    this.origin.y = this.notes[0].origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Porrectus\r\n */\r\nexport class Porrectus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line;\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var x = 0.0;\r\n\r\n    var firstStaffPosition = first.staffPosition;\r\n    var secondStaffPosition = second.staffPosition;\r\n    var thirdStaffPosition = third.staffPosition;\r\n\r\n    switch (firstStaffPosition - secondStaffPosition) {\r\n      case 1:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus1);\r\n        break;\r\n      case 2:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus2);\r\n        break;\r\n      case 3:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus3);\r\n        break;\r\n      case 4:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus4);\r\n        break;\r\n      default:\r\n        // fixme: should we generate an error here?\r\n        first.setGlyph(ctxt, GlyphCode.None);\r\n        break;\r\n    }\r\n\r\n\r\n    // the second glyph does not draw anything, but it still has logical importance for the editing\r\n    // environment...it can respond to changes which will then change the swash glyph of the first.\r\n    second.setGlyph(ctxt, GlyphCode.None);\r\n\r\n    // add the first line and the swash\r\n    line = new NeumeLineVisualizer(ctxt, first, second, true);\r\n\r\n    line.bounds.x = first.bounds.x;\r\n    x = first.bounds.right();\r\n    second.bounds.x = x - second.bounds.width;\r\n    x = second.bounds.right();\r\n\r\n    this.addVisualizer(line);\r\n    this.addVisualizer(first);\r\n    this.addVisualizer(second);\r\n\r\n    // add the connecting line\r\n    if (thirdStaffPosition - secondStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    var overhangThirdNote = true;\r\n\r\n    if (third.liquescent === LiquescentType.SmallAscending)\r\n      third.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n    else if (third.liquescent === LiquescentType.LargeDescending) {\r\n      third.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n      overhangThirdNote = false;\r\n    } else\r\n      third.setGlyph(ctxt, GlyphCode.PodatusUpper);\r\n\r\n    if (overhangThirdNote)\r\n      third.bounds.x = second.bounds.right() - third.bounds.width;\r\n    else\r\n      third.bounds.x = x;\r\n\r\n    this.addVisualizer(third);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * PorrectusFlexus\r\n */\r\nexport class PorrectusFlexus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line;\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var fourth = this.notes[3];\r\n    var x = 0;\r\n\r\n    var firstStaffPosition = first.staffPosition;\r\n    var secondStaffPosition = second.staffPosition;\r\n    var thirdStaffPosition = third.staffPosition;\r\n    var fourthStaffPosition = fourth.staffPosition;\r\n\r\n    switch (firstStaffPosition - secondStaffPosition) {\r\n      case 1:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus1);\r\n        break;\r\n      case 2:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus2);\r\n        break;\r\n      case 3:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus3);\r\n        break;\r\n      case 4:\r\n        first.setGlyph(ctxt, GlyphCode.Porrectus4);\r\n        break;\r\n      default:\r\n        // fixme: should we generate an error here?\r\n        first.setGlyph(ctxt, GlyphCode.None);\r\n        break;\r\n    }\r\n\r\n    // add the first line and the swash\r\n    line = new NeumeLineVisualizer(ctxt, first, second, true);\r\n\r\n    x = line.bounds.x = first.bounds.x;\r\n    x = first.bounds.right();\r\n    this.addVisualizer(line);\r\n    this.addVisualizer(first);\r\n\r\n\r\n    // the second glyph does not draw anything, but it still has logical importance for the editing\r\n    // environment...it can respond to changes which will then change the swash glyph of the first.\r\n    second.setGlyph(ctxt, GlyphCode.None);\r\n    second.bounds.x = x;\r\n    x = second.bounds.right();\r\n    this.addVisualizer(second);\r\n\r\n\r\n    // add a connecting line\r\n    if (thirdStaffPosition - secondStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x += x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    third.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    third.bounds.x = x;\r\n    x = third.bounds.right();\r\n    this.addVisualizer(third);\r\n\r\n    // add a connecting line\r\n    if (thirdStaffPosition - fourthStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, third, fourth, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x += x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    fourth.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    fourth.bounds.x = x;\r\n    this.addVisualizer(fourth);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Punctum\r\n */\r\nexport class Punctum extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // determine the glyph to use\r\n\r\n    var note = this.notes[0];\r\n\r\n    if (note.liquescent !== LiquescentType.None) {\r\n      if (note.shape === NoteShape.Inclinatum)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumInclinatumLiquescent);\r\n      else if (note.shape === NoteShape.Oriscus)\r\n        note.setGlyph(ctxt, GlyphCode.OriscusLiquescent);\r\n      else if (note.liquescent === LiquescentType.LargeAscending)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n      else if (note.liquescent === LiquescentType.LargeDescending)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n\r\n    } else {\r\n\r\n      if (note.shapeModifiers & NoteShapeModifiers.Cavum)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumCavum);\r\n      else if (note.shape === NoteShape.Inclinatum)\r\n        note.setGlyph(ctxt, GlyphCode.PunctumInclinatum);\r\n      else if (note.shape === NoteShape.Quilisma)\r\n        note.setGlyph(ctxt, GlyphCode.Quilisma);\r\n      else\r\n        note.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    }\r\n\r\n    this.addVisualizer(note);\r\n\r\n    this.origin.x = note.origin.x;\r\n    this.origin.y = note.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Scandicus\r\n */\r\nexport class Salicus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n\r\n    var x = 0;\r\n\r\n    // first note of a salicus is always a punctum cuadratum\r\n    first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    x += first.bounds.width;\r\n\r\n    // if the next note doesn't require a stem connector, then add a tad bit\r\n    // of spacing here\r\n    if (!(second.shapeModifiers & NoteShapeModifiers.Stemmed))\r\n      x += ctxt.intraNeumeSpacing;\r\n\r\n    // second note is always an oriscus, which may or may not be stemmed\r\n    // to the first\r\n    second.setGlyph(ctxt, GlyphCode.OriscusAsc);\r\n\r\n    // do we need a line between first and second notes?\r\n    if (second.shapeModifiers & NoteShapeModifiers.Stemmed &&\r\n      second.staffPosition - first.staffPosition > 1) { // need stem when notes are greater than 1 space apart\r\n\r\n      var line = new NeumeLineVisualizer(ctxt, first, second, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    second.bounds.x = x;\r\n    x += second.bounds.width;\r\n\r\n    // third note can be a punctum cuadratum or various liquescent forms\r\n    if (third.liquescent === LiquescentType.LargeAscending)\r\n      third.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n    else if (third.liquescent === LiquescentType.LargeDescending)\r\n      third.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else if (third.liquescent & LiquescentType.Small) {\r\n      third.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n      third.bounds.x -= third.bounds.width; // right aligned\r\n    } else {\r\n      // virga terminator\r\n      third.setGlyph(ctxt, Virga.getGlyphCode(third.staffPosition));\r\n    }\r\n\r\n    // do we need a line between second and third notes?\r\n    if (third.staffPosition - second.staffPosition > 1) {\r\n      \r\n      line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n      line.bounds.x = second.bounds.right() - line.bounds.width;\r\n      this.addVisualizer(line);\r\n\r\n      if (!(third.liquescent & LiquescentType.Small))\r\n        x -= line.bounds.width;\r\n    }\r\n\r\n    third.bounds.x += x;\r\n\r\n    // add the note elements\r\n    this.addVisualizer(first);\r\n    this.addVisualizer(second);\r\n    this.addVisualizer(third);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Scandicus\r\n */\r\nexport class SalicusFlexus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var fourth = this.notes[3];\r\n\r\n    var x = 0;\r\n\r\n    // first note of a salicus is always a punctum cuadratum\r\n    first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    x += first.bounds.width;\r\n\r\n    // if the next note doesn't require a stem connector, then add a tad bit\r\n    // of spacing here\r\n    if (!(second.shapeModifiers & NoteShapeModifiers.Stemmed))\r\n      x += ctxt.intraNeumeSpacing;\r\n\r\n    // second note is always an oriscus, which may or may not be stemmed\r\n    // to the first\r\n    second.setGlyph(ctxt, GlyphCode.OriscusAsc);\r\n\r\n    // do we need a line between first and second notes?\r\n    if (second.shapeModifiers & NoteShapeModifiers.Stemmed &&\r\n      second.staffPosition - first.staffPosition > 1) { // need stem when notes are greater than 1 space apart\r\n\r\n      var line = new NeumeLineVisualizer(ctxt, first, second, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    second.bounds.x = x;\r\n    x += second.bounds.width;\r\n\r\n    // third note can be a punctum cuadratum or various liquescent forms,\r\n    // ...based on note four though!\r\n    if (fourth.liquescent & LiquescentType.Small)\r\n      third.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else\r\n      third.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    // do we need a line between second and third notes?\r\n    if (third.staffPosition - second.staffPosition > 1) {\r\n      \r\n      line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n      line.bounds.x = second.bounds.right() - line.bounds.width;\r\n      this.addVisualizer(line);\r\n\r\n      x -= line.bounds.width;\r\n    }\r\n\r\n    third.bounds.x += x;\r\n    x += third.bounds.width;\r\n\r\n    // finally, do the fourth note\r\n    if (fourth.liquescent === LiquescentType.LargeAscending)\r\n      fourth.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n    else if (fourth.liquescent === LiquescentType.LargeDescending)\r\n      fourth.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else if (fourth.liquescent & LiquescentType.Small) {\r\n      fourth.setGlyph(ctxt, GlyphCode.TerminatingDesLiquescent);\r\n      fourth.bounds.x -= fourth.bounds.width; // right-aligned\r\n    } else\r\n      fourth.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    // do we need a line between second and third notes?\r\n    if (third.staffPosition - fourth.staffPosition > 1) {\r\n      \r\n      line = new NeumeLineVisualizer(ctxt, third, fourth, false);\r\n      line.bounds.x = third.bounds.right() - line.bounds.width;\r\n      this.addVisualizer(line);\r\n\r\n      if (!(fourth.liquescent & LiquescentType.Small))\r\n        x -= line.bounds.width;\r\n    }\r\n\r\n    fourth.bounds.x += x;\r\n\r\n    // add the note elements\r\n    this.addVisualizer(first);\r\n    this.addVisualizer(second);\r\n    this.addVisualizer(third);\r\n    this.addVisualizer(fourth);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Scandicus\r\n */\r\nexport class Scandicus extends Neume {\r\n\r\n  // fixme: for now, we render the scandicus as a punctum followed by a podatus. however,\r\n  // it could also be a podatus followed by a virga...see LU, \"Preface,\" xj.\r\n  //\r\n  // perhaps the best way to indicate the virga form is to check if the note shape of\r\n  // the third note is a virga!\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n\r\n    first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    if (second.isLiquescent || third.isLiquescent) {\r\n      second.setGlyph(ctxt, GlyphCode.BeginningAscLiquescent);\r\n      third.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n    } else {\r\n      second.setGlyph(ctxt, GlyphCode.PodatusLower);\r\n      third.setGlyph(ctxt, GlyphCode.PodatusUpper);\r\n    }\r\n\r\n    // fixme: can a scandicus have a quilisma like this?\r\n    if (second.shape === NoteShape.Quilisma)\r\n      second.setGlyph(ctxt, GlyphCode.Quilisma);\r\n\r\n    var line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n\r\n    second.bounds.x = first.bounds.right();\r\n    line.bounds.x = second.bounds.right() - line.bounds.width;\r\n    third.bounds.x = second.bounds.right() - third.bounds.width;\r\n\r\n    // add the elements\r\n    this.addVisualizer(first);\r\n    this.addVisualizer(second);\r\n    this.addVisualizer(line);\r\n    this.addVisualizer(third);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n\r\n/*\r\n * Scandicus Flexus\r\n */\r\nexport class ScandicusFlexus extends Neume {\r\n\r\n  // see notes in Scandicus about determining the first three notes.\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var fourth = this.notes[3];\r\n\r\n    first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    if (second.isLiquescent || third.isLiquescent) {\r\n      second.setGlyph(ctxt, GlyphCode.BeginningAscLiquescent);\r\n      third.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n    } else {\r\n      second.setGlyph(ctxt, GlyphCode.PodatusLower);\r\n      third.setGlyph(ctxt, GlyphCode.PodatusUpper);\r\n    }\r\n\r\n    // fixme: can a scandicus have a quilisma like this?\r\n    if (second.shape === NoteShape.Quilisma)\r\n      second.setGlyph(ctxt, GlyphCode.Quilisma);\r\n\r\n    var line = new NeumeLineVisualizer(ctxt, second, third, false);\r\n\r\n    second.bounds.x = first.bounds.right();\r\n    line.bounds.x = second.bounds.right() - line.bounds.width;\r\n    third.bounds.x = second.bounds.right() - third.bounds.width;\r\n    fourth.bounds.x = third.bounds.right();\r\n\r\n    // do we need to draw a descending line?\r\n    var staffPos3 = third.staffPosition;\r\n    var staffPos4 = fourth.staffPosition;\r\n    if (staffPos3 - staffPos4 > 1) {\r\n      var extraLine = new NeumeLineVisualizer(ctxt, third, fourth, false);\r\n      fourth.bounds.x -= extraLine.bounds.width;\r\n      extraLine.bounds.x -= extraLine.bounds.width;\r\n      this.addVisualizer(extraLine);\r\n    }\r\n\r\n    // add the elements\r\n    this.addVisualizer(first);\r\n    this.addVisualizer(second);\r\n    this.addVisualizer(line);\r\n    this.addVisualizer(third);\r\n    this.addVisualizer(fourth);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * TextOnly\r\n */\r\nexport class TextOnly extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    // add an empty glyph as a placeholder\r\n    this.addVisualizer(new GlyphVisualizer(ctxt, GlyphCode.None));\r\n\r\n    this.origin.x = 0;\r\n    this.origin.y = 0;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Torculus\r\n */\r\nexport class Torculus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note1 = this.notes[0];\r\n    var note2 = this.notes[1];\r\n    var note3 = this.notes[2];\r\n    var drawFirstLine = note2.staffPosition - note1.staffPosition > 1;\r\n    var line;\r\n\r\n    if (note1.liquescent === LiquescentType.InitioDebilis) {\r\n      note1.setGlyph(ctxt, GlyphCode.TerminatingDesLiquescent);\r\n      drawFirstLine = true; // always draw first line with an initio debilis\r\n    } else\r\n      note1.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    note2.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    if (note3.liquescent & LiquescentType.Small) {\r\n      note3.setGlyph(ctxt, GlyphCode.TerminatingDesLiquescent);\r\n      note3.bounds.x -= note3.bounds.width; // right aligned\r\n    } else if (note3.liquescent & LiquescentType.Ascending)\r\n      note3.setGlyph(ctxt, GlyphCode.PunctumCuadratumAscLiquescent);\r\n    else if (note3.liquescent & LiquescentType.Descending)\r\n      note3.setGlyph(ctxt, GlyphCode.PunctumCuadratumDesLiquescent);\r\n    else \r\n      note3.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n\r\n    var x = note1.bounds.right();\r\n\r\n    // do we need to draw the first (ascending) line?\r\n    if (drawFirstLine) {\r\n      line = new NeumeLineVisualizer(ctxt, note1, note2, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    note2.bounds.x += x;\r\n    x += note2.bounds.width;\r\n\r\n    // do we need to draw a descending line?\r\n    if (note2.staffPosition - note3.staffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, note2, note3, false);\r\n      line.bounds.x = x - line.bounds.width;\r\n      this.addVisualizer(line);\r\n\r\n      if (!(note3.liquescent & LiquescentType.Small))\r\n        x -= line.bounds.width;\r\n    }\r\n\r\n    note3.bounds.x += x;\r\n\r\n    this.addVisualizer(note1);\r\n    this.addVisualizer(note2);\r\n    this.addVisualizer(note3);\r\n\r\n    this.origin.x = note1.origin.x;\r\n    this.origin.y = note1.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * TorculusResupinus\r\n */\r\nexport class TorculusResupinus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line;\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var fourth = this.notes[3];\r\n    var x = 0;\r\n\r\n    // first, figure out the porrectus swash\r\n    var firstStaffPosition = first.staffPosition;\r\n    var secondStaffPosition = second.staffPosition;\r\n    var thirdStaffPosition = third.staffPosition;\r\n    var fourthStaffPosition = fourth.staffPosition;\r\n\r\n    switch (first.shape) {\r\n      case NoteShape.Quilisma:\r\n        first.setGlyph(ctxt, GlyphCode.Quilisma);\r\n        break;\r\n\r\n      default:\r\n        first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n        break;\r\n    }\r\n\r\n    x = first.bounds.right();\r\n    this.addVisualizer(first);\r\n\r\n    // if we need a line between the first punctum and the porrectus swash, add it now\r\n    if (secondStaffPosition - firstStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, first, second, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n\r\n    switch (Math.abs(secondStaffPosition - thirdStaffPosition)) {\r\n      case 1:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus1);\r\n        break;\r\n      case 2:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus2);\r\n        break;\r\n      case 3:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus3);\r\n        break;\r\n      case 4:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus4);\r\n        break;\r\n      default:\r\n        // fixme: this should be an error!\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus1);\r\n        break;\r\n    }\r\n\r\n    second.bounds.x = x;\r\n    x = second.bounds.right();\r\n    this.addVisualizer(second);\r\n\r\n    // the third glyph does not draw anything, but it still has logical importance for the editing\r\n    // environment...it can respond to changes which will then change the swash glyph of the first.\r\n    third.setGlyph(ctxt, GlyphCode.None);\r\n\r\n    // do we need an ascending line after the porrectus swash?\r\n    if (fourthStaffPosition - thirdStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, third, fourth, false);\r\n      line.bounds.x = x - line.bounds.width;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    if (fourth.isLiquescent)\r\n      fourth.setGlyph(ctxt, GlyphCode.TerminatingAscLiquescent);\r\n    else\r\n      fourth.setGlyph(ctxt, GlyphCode.PodatusUpper);\r\n\r\n    fourth.bounds.x += x;\r\n    this.addVisualizer(fourth);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * TorculusResupinusFlexus\r\n */\r\nexport class TorculusResupinusFlexus extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var line;\r\n    var first = this.notes[0];\r\n    var second = this.notes[1];\r\n    var third = this.notes[2];\r\n    var fourth = this.notes[3];\r\n    var fifth = this.notes[4];\r\n    var x = 0;\r\n\r\n    var firstStaffPosition = first.staffPosition;\r\n    var secondStaffPosition = second.staffPosition;\r\n    var thirdStaffPosition = third.staffPosition;\r\n    var fourthStaffPosition = fourth.staffPosition;\r\n    var fifthStaffPosition = fifth.staffPosition;\r\n\r\n    switch (first.shape) {\r\n      case NoteShape.Quilisma:\r\n        first.setGlyph(ctxt, GlyphCode.Quilisma);\r\n        break;\r\n\r\n      default:\r\n        first.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n        break;\r\n    }\r\n\r\n    x = first.bounds.right();\r\n    this.addVisualizer(first);\r\n\r\n    // if we need a line between the first punctum and the porrectus swash, add it now\r\n    if (secondStaffPosition - firstStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, first, second, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x = x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n\r\n    switch (secondStaffPosition - thirdStaffPosition) {\r\n      case 1:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus1);\r\n        break;\r\n      case 2:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus2);\r\n        break;\r\n      case 3:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus3);\r\n        break;\r\n      case 4:\r\n        second.setGlyph(ctxt, GlyphCode.Porrectus4);\r\n        break;\r\n      default:\r\n        // fixme: should we generate an error here?\r\n        second.setGlyph(ctxt, GlyphCode.None);\r\n        break;\r\n    }\r\n\r\n    second.bounds.x = x;\r\n    x = second.bounds.right();\r\n    this.addVisualizer(second);\r\n\r\n    // the second glyph does not draw anything, but it still has logical importance for the editing\r\n    // environment...it can respond to changes which will then change the swash glyph of the first.\r\n    third.setGlyph(ctxt, GlyphCode.None);\r\n    third.bounds.x = x;\r\n    x = third.bounds.right();\r\n    this.addVisualizer(third);\r\n\r\n    // add a connecting line\r\n    if (fourthStaffPosition - thirdStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, third, fourth, false);\r\n      x -= line.bounds.width;\r\n      line.bounds.x += x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    fourth.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    fourth.bounds.x = x;\r\n    x = fourth.bounds.right();\r\n    this.addVisualizer(fourth);\r\n\r\n    // add a connecting line\r\n    if (fourthStaffPosition - fifthStaffPosition > 1) {\r\n      line = new NeumeLineVisualizer(ctxt, fourth, fifth, false);\r\n      x -= line.bounds.width * 1.5;\r\n      line.bounds.x += x;\r\n      this.addVisualizer(line);\r\n    }\r\n\r\n    fifth.setGlyph(ctxt, GlyphCode.PunctumCuadratum);\r\n    fifth.bounds.x = x;\r\n    this.addVisualizer(fifth);\r\n\r\n    this.origin.x = first.origin.x;\r\n    this.origin.y = first.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Tristropha\r\n *\r\n * For simplicity in implementation, Tristropha's have three notes in the object\r\n * structure. These technically must be the same pitch though (like the\r\n * Distropha and Bivirga).\r\n */\r\nexport class Tristropha extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note1 = this.notes[0];\r\n    var note2 = this.notes[1];\r\n    var note3 = this.notes[2];\r\n\r\n    var staffPosition = note1.staffPosition;\r\n\r\n    note1.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note1));\r\n\r\n    note2.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note2));\r\n    note2.bounds.x += note1.bounds.width + ctxt.intraNeumeSpacing;\r\n\r\n    note3.setGlyph(ctxt, Apostropha.determineNoteGlyphCode(note3));\r\n    note3.bounds.x += note1.bounds.width + note2.bounds.width + ctxt.intraNeumeSpacing * 2;\r\n\r\n    this.addVisualizer(note1);\r\n    this.addVisualizer(note2);\r\n    this.addVisualizer(note3);\r\n\r\n    this.origin.x = note1.origin.x;\r\n    this.origin.y = note1.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n}\r\n\r\n/*\r\n * Virga\r\n */\r\nexport class Virga extends Neume {\r\n\r\n  performLayout(ctxt) {\r\n    super.performLayout(ctxt);\r\n\r\n    var note = this.notes[0];\r\n\r\n    var staffPosition = note.staffPosition;\r\n\r\n    var glyphCode = Virga.getGlyphCode(staffPosition);\r\n    note.setGlyph(ctxt, glyphCode);\r\n\r\n    this.addVisualizer(note);\r\n\r\n    this.origin.x = note.origin.x;\r\n    this.origin.y = note.origin.y;\r\n\r\n    this.finishLayout(ctxt);\r\n  }\r\n\r\n  // The virga's glyph depends on its staff position. This is a helper function\r\n  // that can be used by other neumes that use the virga glyphs...\r\n  static getGlyphCode(staffPosition) {\r\n    if (Math.abs(staffPosition) % 2 === 1)\r\n      return GlyphCode.VirgaLong;\r\n    else\r\n      return GlyphCode.VirgaShort;\r\n\r\n    // fixme: add logic for virgas low on the staff that are probably short also...\r\n  }\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/Exsurge.Chant.Neumes.js\n **/"],"sourceRoot":""}